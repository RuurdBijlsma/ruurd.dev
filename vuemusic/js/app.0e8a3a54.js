(function(e){function t(t){for(var r,i,o=t[0],u=t[1],c=t[2],h=0,p=[];h<o.length;h++)i=o[h],a[i]&&p.push(a[i][0]),a[i]=0;for(r in u)Object.prototype.hasOwnProperty.call(u,r)&&(e[r]=u[r]);l&&l(t);while(p.length)p.shift()();return s.push.apply(s,c||[]),n()}function n(){for(var e,t=0;t<s.length;t++){for(var n=s[t],r=!0,o=1;o<n.length;o++){var u=n[o];0!==a[u]&&(r=!1)}r&&(s.splice(t--,1),e=i(i.s=n[0]))}return e}var r={},a={app:0},s=[];function i(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=r,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/vuemusic/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],u=o.push.bind(o);o.push=t,o=o.slice();for(var c=0;c<o.length;c++)t(o[c]);var l=u;s.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"034f":function(e,t,n){"use strict";var r=n("64a9"),a=n.n(r);a.a},"0b64":function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("cadf"),n("551c"),n("f751"),n("097d");var r=n("2b0e"),a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("md-content",{staticClass:"top-toolbar md-primary"},[n("div",{staticClass:"search-bar "},[n("md-button",{staticClass:"md-icon-button search-back",on:{click:function(t){e.$router.push("/"),e.searchQuery=""}}},[["search","artist"].includes(e.$route.name)?n("md-icon",{staticClass:"search-icon"},[e._v("arrow_back")]):n("md-icon",{staticClass:"search-icon"},[e._v("search")])],1),n("input",{directives:[{name:"model",rawName:"v-model",value:e.searchQuery,expression:"searchQuery"}],staticClass:"search-input",attrs:{type:"text",placeholder:"Search"},domProps:{value:e.searchQuery},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.performSearch(t)},input:function(t){t.target.composing||(e.searchQuery=t.target.value)}}}),n("md-button",{staticClass:"md-icon-button search-cancel",style:{opacity:""===e.searchQuery?0:1},on:{click:function(t){return e.clearSearch()}}},[n("md-icon",[e._v("cancel")])],1)],1),n("md-menu",{attrs:{"md-direction":"bottom-end","md-close-on-click":""}},[n("md-button",{staticClass:"md-icon-button md-primary login-avatar",attrs:{"md-menu-trigger":""}},[n("md-avatar",{staticClass:"md-avatar-icon"},[e._v(e._s(e.firstLetter))])],1),n("md-menu-content",[n("md-menu-item",{on:{click:function(t){return e.logout()}}},[e._v("Log out")]),n("md-menu-item",{on:{click:function(t){return e.cacheAllOnline()}}},[e._v("Cache all songs offline")])],1)],1)],1),n("md-content",{staticClass:"main-content"},[n("router-view",{attrs:{"current-song":e.currentSong,"favorites-id":e.favoritesId},on:{play:e.playSong,add:e.showPlaylistDialog,remove:e.removeFromPlaylist,recache:e.recache}}),n("md-button",{staticClass:"md-fab shuffle-fab",class:e.shuffleEnabled?"md-accent":"md-primary",on:{click:function(t){return e.toggleShuffle()}}},[n("md-icon",[e._v("shuffle")])],1)],1),n("md-content",{staticClass:"bottom-player md-elevation-2"},[n("div",{staticClass:"player-container"},[n("div",{staticClass:"player-thumbnail",style:{backgroundImage:"url("+e.currentSong.thumbnail+")"}}),n("div",{staticClass:"player-info"},[n("div",{staticClass:"player-title"},[e._v(e._s(e.currentSong.title))]),n("div",{staticClass:"player-artist"},[e._v(e._s(e.currentSong.artist))])]),n("div",{staticClass:"player-controls"},[n("md-button",{on:{click:function(t){return e.skip(-1)}}},[n("md-icon",[e._v("skip_previous")])],1),n("div",{staticClass:"center-play-icon"},[e.loading?n("md-progress-spinner",{staticClass:"md-accent spinner",attrs:{"md-mode":"indeterminate","md-stroke":2,"md-diameter":30}}):n("md-button",{staticClass:"player-play",on:{click:function(t){return e.togglePlayPause()}}},[e.playing?n("md-icon",[e._v("pause")]):n("md-icon",[e._v("play_arrow")])],1)],1),n("md-button",{on:{click:function(t){return e.skip(1)}}},[n("md-icon",[e._v("skip_next")])],1)],1)]),n("audio",{staticClass:"audio-player"}),n("div",{staticClass:"seek-information"},[n("span",[e._v(e._s(e.secondsToHms(e.progress/100*e.currentSong.duration)))]),n("div",{staticClass:"seek-bar",on:{mousedown:function(t){return e.startSeeking(t)},touchstart:function(t){return e.startSeeking(t.touches[0])}}},[n("div",{staticClass:"seek-background",style:{backgroundColor:e.currentSong.color}}),n("div",{staticClass:"seek-progress",style:{backgroundColor:e.currentSong.color,width:e.progress+"%"}}),n("div",{staticClass:"seek-thumb",style:{backgroundColor:e.currentSong.color,left:"calc("+e.progress+"% - 4.5px)"}})]),n("span",{style:{opacity:e.currentSong.duration>=0?1:0}},[e._v(e._s(e.secondsToHms(e.currentSong.duration)))])])]),n("md-dialog",{attrs:{"md-active":e.showDialog,"md-fullscreen":!1},on:{"update:mdActive":function(t){e.showDialog=t},"update:md-active":function(t){e.showDialog=t}}},[n("md-dialog-title",[e._v("Add to playlist")]),n("md-list",[n("md-subheader",[e._v(e._s(e.songToAdd.artist)+" - "+e._s(e.songToAdd.title))]),e._l(e.playlists,function(t){return n("md-list-item",{staticClass:"md-list-item-button"},[n("md-button",{staticClass:"md-ripple add-button",on:{click:function(n){return e.addToPlaylist(e.songToAdd,t.playlistid)}}},[e._v("\n                    "+e._s(t.name)+"\n                ")])],1)})],2),n("md-dialog-actions",[n("md-button",{staticClass:"md-accent",on:{click:function(t){e.showDialog=!1}}},[e._v("Cancel")])],1)],1)],1)},s=[],i=n("f499"),o=n.n(i),u=(n("20d6"),n("795b")),c=n.n(u),l=(n("ac6a"),n("5df3"),n("7514"),n("7f7f"),n("96cf"),n("3b8d")),h=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"song-tab"},[n("song-list",{attrs:{songs:e.songs,currentSong:e.currentSong},on:{play:e.playSong,add:e.add,remove:e.remove,recache:e.recache}})],1)},p=[],d=(n("c5f6"),n("d225")),f=n("b0b4"),m=n("308d"),g=n("6bb5"),v=n("2a88"),y=n("4e2b"),w=function(){function e(t){Object(d["a"])(this,e),this.baseUrl=t}return Object(f["a"])(e,[{key:"request",value:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(t,n,r){var a,s;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,fetch(this.baseUrl+"/"+n.join("/"),{method:t,headers:{"Content-Type":"application/json"},body:o()(r)});case 2:return a=e.sent,e.next=5,a.text();case 5:return s=e.sent,e.prev=6,e.abrupt("return",JSON.parse(s));case 10:e.prev=10,e.t0=e["catch"](6),console.log("Error parsing json response:",s);case 13:case"end":return e.stop()}},e,this,[[6,10]])}));function t(t,n,r){return e.apply(this,arguments)}return t}()},{key:"get",value:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(){var t,n,r,a=arguments;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:for(t=a.length,n=new Array(t),r=0;r<t;r++)n[r]=a[r];return e.next=3,this.request("get",n,{});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"post",value:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(t){var n,r,a,s=arguments;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:for(n=s.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=s[a];return console.info("[POST]",r,t),e.next=4,this.request("post",r,t);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}()}]),e}(),b=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:-1,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"grey";Object(d["a"])(this,e),this.id=t,this.title=n,this.artist=r,this.thumbnail=a,this.duration=s,this.color=i,this.isCaching=!1,this.isCached=!0,this.scrollIntoView=!1}return Object(f["a"])(e,null,[{key:"fromObject",value:function(t){return new e(t.id,t.title,t.artist,t.thumbnail,t.duration,t.color)}}]),e}(),k=function(e){function t(){var e;return Object(d["a"])(this,t),e=Object(m["a"])(this,Object(g["a"])(t).call(this,"")),null!==localStorage.getItem("user")?e.user=JSON.parse(localStorage.user):e.user={user:"",password:""},e}return Object(y["a"])(t,e),Object(f["a"])(t,[{key:"post",value:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(n){var r,a,s,i,o,u=arguments;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:for(this.hasUser||console.warn("Client intercept: not logged in"),a=u.length,s=new Array(a>1?a-1:0),i=1;i<a;i++)s[i-1]=u[i];return e.next=4,(r=Object(v["a"])(Object(g["a"])(t.prototype),"post",this)).call.apply(r,[this,n].concat(s));case 4:return o=e.sent,o.hasOwnProperty("status")&&"not logged in"===o.status&&console.warn("SERVER: ",o),e.abrupt("return",o);case 7:case"end":return e.stop()}},e,this)}));function n(t){return e.apply(this,arguments)}return n}()},{key:"setServer",value:function(e){this.baseUrl=e}},{key:"login",value:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.post({user:t,password:n},"login");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"register",value:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.post({user:t,password:n},"register");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"artists",value:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.post(this.user,"artists",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}()},{key:"artistSongs",value:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.post(this.user,"artistSongs",t);case 2:return n=e.sent,e.abrupt("return",n.map(function(e){return b.fromObject(e)}));case 4:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}()},{key:"search",value:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.post(this.user,"search",t);case 2:return n=e.sent,e.abrupt("return",n.map(function(e){return b.fromObject(e)}));case 4:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}()},{key:"playlists",value:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.post(this.user,"playlists");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"createPlaylist",value:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.post(this.user,"createPlaylist",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}()},{key:"deletePlaylist",value:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.post(this.user,"deletePlaylist",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}()},{key:"songs",value:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.post(this.user,"songs",t);case 2:return n=e.sent,e.abrupt("return",n.map(function(e){return b.fromObject(e)}));case 4:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}()},{key:"favorites",value:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.post(this.user,"favorites");case 2:return t=e.sent,e.abrupt("return",t.map(function(e){return b.fromObject(e)}));case 4:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"save",value:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.post(this.user,"save",t,n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"remove",value:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.post(this.user,"remove",t,n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"info",value:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.post(this.user,"info",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}()},{key:"getStreamUrl",value:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.info(t);case 2:return n=e.sent.url,e.abrupt("return",this.baseUrl+"/pipe/"+encodeURIComponent(n));case 4:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}()},{key:"hasUser",get:function(){return this.user.hasOwnProperty("user")&&""!==this.user.user}}]),t}(w),S=new k,x=n("5d73"),R=n.n(x),O=function(){function e(){var t=this;Object(d["a"])(this,e),this.isReady=!1,this.requestSize=Math.pow(1024,3),this.events={},console.log("Instanced"),this.getFileSystem().then(function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(n){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t.fileSystem=n,e.next=3,t.requestMoreQuota(t.requestSize);case 3:t.isReady=!0,t.fire("ready");case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}())}return Object(f["a"])(e,[{key:"awaitReady",value:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",new c.a(function(e){t.isReady&&e(),t.on("ready",function(){console.log("resolving ready here"),e()})}));case 1:case"end":return e.stop()}},e)}));function t(){return e.apply(this,arguments)}return t}()},{key:"exists",value:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(t){var n,r=arguments;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return n=r.length>1&&void 0!==r[1]?r[1]:this.root,e.next=3,this.getFileByName(t,n);case 3:return e.t0=e.sent,e.t1=void 0,e.abrupt("return",e.t0!==e.t1);case 6:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}()},{key:"getFileByName",value:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(t){var n,r,a=arguments;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return n=a.length>1&&void 0!==a[1]?a[1]:this.root,e.next=3,this.getDirectoryFiles(n);case 3:return r=e.sent,e.abrupt("return",r.find(function(e){return e.name===t}));case 5:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}()},{key:"remove",value:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(t){var n,r,a=arguments;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return n=a.length>1&&void 0!==a[1]?a[1]:this.root,e.next=3,this.getFileByName(t,n);case 3:return r=e.sent,e.abrupt("return",new c.a(function(e,t){r.remove(function(t){return e(t)},function(e){return t(e)})}));case 5:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}()},{key:"getDirectoryFiles",value:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(){var t,n=arguments;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:this.root,e.abrupt("return",new c.a(function(e,n){var r=t.createReader();r.readEntries(function(t){return e(t)},function(e){return n(e)})}));case 2:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"getFileSystem",value:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",new c.a(function(e,t){window.webkitRequestFileSystem(window.PERSISTENT,0,function(t){return e(t)},function(e){return t(e)})}));case 1:case"end":return e.stop()}},e)}));function t(){return e.apply(this,arguments)}return t}()},{key:"requestMoreQuota",value:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",new c.a(function(e,n){navigator.webkitPersistentStorage.requestQuota(t,function(t){return e(t)},function(e){return n(e)})}));case 1:case"end":return e.stop()}},e)}));function t(t){return e.apply(this,arguments)}return t}()},{key:"getCurrentQuota",value:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",new c.a(function(e,t){navigator.webkitTemporaryStorage.queryUsageAndQuota(function(t,n){return e({usedBytes:t,grantedBytes:n})},function(e){return t(e)})}));case 1:case"end":return e.stop()}},e)}));function t(){return e.apply(this,arguments)}return t}()},{key:"createFileFromBlob",value:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(t,n){var r,a,s=arguments;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return r=s.length>2&&void 0!==s[2]?s[2]:this.root,e.next=3,this.createFile(t,r);case 3:return a=e.sent,e.next=6,this.writeToFile(n,a);case 6:return e.abrupt("return",a);case 7:case"end":return e.stop()}},e,this)}));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"createFile",value:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(t){var n,r=arguments;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return n=r.length>1&&void 0!==r[1]?r[1]:this.root,e.abrupt("return",new c.a(function(e,r){n.getFile(t,{create:!0},function(t){return e(t)},function(e){return r(e)})}));case 2:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}()},{key:"writeToFile",value:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",new c.a(function(e,r){n.createWriter(function(n){n.onwriteend=function(t){return e(t)},n.onerror=function(e){return r(e)},n.write(t)})}));case 1:case"end":return e.stop()}},e)}));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"on",value:function(e,t){this.events[e]||(this.events[e]=[]),this.events[e].push(t)}},{key:"off",value:function(e,t){this.events[e]&&this.events[e].splice(this.events.indexOf(t),1)}},{key:"fire",value:function(e){if(this.events[e]){var t=!0,n=!1,r=void 0;try{for(var a,s=R()(this.events[e]);!(t=(a=s.next()).done);t=!0){var i=a.value;i()}}catch(o){n=!0,r=o}finally{try{t||null==s.return||s.return()}finally{if(n)throw r}}}}},{key:"root",get:function(){return this.fileSystem.root}}]),e}(),j=new O,C=function(){function e(){Object(d["a"])(this,e),this.songStatuses=[]}return Object(f["a"])(e,[{key:"setCachingStatus",value:function(e,t){e.isCaching=t,this.songStatuses.hasOwnProperty(e.id)||(this.songStatuses[e.id]={isCaching:!1,isCached:!0}),this.songStatuses[e.id].isCaching=t}},{key:"setCachedStatus",value:function(e,t){e.isCached=t,this.songStatuses.hasOwnProperty(e.id)||(this.songStatuses[e.id]={isCaching:!1,isCached:!0}),this.songStatuses[e.id].isCached=t}},{key:"getAudioSource",value:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(t){var n,r,a,s,i,o=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return n=t.id,r=n,e.next=4,j.awaitReady();case 4:return e.next=6,j.exists(r);case 6:if(s=e.sent,!s){e.next=13;break}return e.next=10,j.getFileByName(r);case 10:a=e.sent.toURL(),e.next=19;break;case 13:return i=!this.isSongCaching(t),i&&this.setCachingStatus(t,!0),e.next=17,S.getStreamUrl(n);case 17:a=e.sent,i?setTimeout(function(){return o.cacheSongLocally(t,a)},500):console.log("Not caching",t.title,"already in progress",this.isSongCaching(t));case 19:return console.log(a),e.abrupt("return",a);case 21:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}()},{key:"isSongCaching",value:function(e){return!!this.songStatuses.hasOwnProperty(e.id)&&this.songStatuses[e.id].isCaching}},{key:"cacheSongLocallyIfNeeded",value:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(n=t.id,e.t0=!this.isSongCaching(t),!e.t0){e.next=6;break}return e.next=5,j.exists(n);case 5:e.t0=!e.sent;case 6:if(!e.t0){e.next=13;break}return this.setCachingStatus(t,!0),e.next=10,S.getStreamUrl(n);case 10:return r=e.sent,e.next=13,this.cacheSongLocally(t,r);case 13:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}()},{key:"cacheSongLocally",value:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(t,n){var r,a,s,i;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return r=t.id,console.log("Caching song",t.title,n),e.prev=2,e.next=5,fetch(n);case 5:return s=e.sent,e.next=8,s.blob();case 8:a=e.sent,console.log("song cache blob",a),e.next=15;break;case 12:e.prev=12,e.t0=e["catch"](2),console.warn("Could not fetch",n,e.t0);case 15:if(!a){e.next=23;break}return e.next=18,j.createFileFromBlob(r,a);case 18:i=e.sent,console.log("Cache complete",t.title,i),this.setCachedStatus(t,!0),e.next=24;break;case 23:this.setCachedStatus(t,!1);case 24:this.setCachingStatus(t,!1);case 25:case"end":return e.stop()}},e,this,[[2,12]])}));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"checkSongsCacheStatus",value:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(t){var n,r,a,s,i,o,u,l,h;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,j.awaitReady();case 2:return n=t.map(function(e){return j.exists(e.id)}),e.next=5,c.a.all(n);case 5:for(r=e.sent,a=0;a<r.length;a++)t[a].isCached=r[a];for(s=!0,i=!1,o=void 0,e.prev=10,u=R()(t);!(s=(l=u.next()).done);s=!0)h=l.value,this.songStatuses.hasOwnProperty(h.id)&&(h.isCaching=this.songStatuses[h.id].isCaching);e.next=18;break;case 14:e.prev=14,e.t0=e["catch"](10),i=!0,o=e.t0;case 18:e.prev=18,e.prev=19,s||null==u.return||u.return();case 21:if(e.prev=21,!i){e.next=24;break}throw o;case 24:return e.finish(21);case 25:return e.finish(18);case 26:case"end":return e.stop()}},e,this,[[10,14,18,26],[19,,21,25]])}));function t(t){return e.apply(this,arguments)}return t}()}]),e}(),_=new C,q=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"song-tab"},[0===e.songs.length?n("h3",[e._v("No songs found")]):e._e(),n("md-list",[e.title?n("md-subheader",[e._v(e._s(e.title))]):e._e(),e._l(e.songs,function(t){return n("md-list-item",{staticClass:"md-list-item-button",style:{backgroundColor:e.currentSong.id===t.id?"rgba(0,0,0,0.15)":"transparent"}},[n("song-item",{attrs:{song:t},on:{play:function(n){return e.$emit("play",t)},remove:function(n){return e.$emit("remove",t)},add:function(n){return e.$emit("add",t)},recache:function(n){return e.$emit("recache",t)}}})],1)})],2)],1)},$=[],I=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"song-item",on:{click:function(t){return e.$emit("play")}}},[n("div",{staticClass:"thumbnail-square"},[n("div",{staticClass:"song-thumbnail",style:{backgroundImage:"url("+e.song.thumbnail+")"}}),e.song.isCaching?n("div",{staticClass:"thumbnail-overlay"},[e.song.isCaching?n("md-progress-spinner",{staticClass:"md-accent",attrs:{"md-mode":"indeterminate","md-stroke":3,"md-diameter":40}}):e._e()],1):e._e()]),n("div",{staticClass:"song-info"},[n("div",{staticClass:"song-title"},[e._v(e._s(e.song.title))]),n("div",{staticClass:"song-bottom-info  md-caption"},[n("span",{staticClass:"song-cached"},[e.song.isCached?e._e():n("md-icon",[e._v("cloud")])],1),n("span",{staticClass:"song-artist"},[e._v(e._s(e.song.artist))]),e.song.duration>=0?n("span",{staticClass:"song-duration"},[e._v(" • "+e._s(e.secondsToHms(e.song.duration)))]):e._e()])]),n("md-menu",{attrs:{"md-direction":"bottom-end","md-close-on-click":""},on:{click:function(e){return e.stopPropagation()}}},[n("md-button",{attrs:{"md-menu-trigger":""}},[n("md-icon",[e._v("more_vert")])],1),n("md-menu-content",[n("md-menu-item",{on:{click:function(t){return e.$emit("remove")}}},[e._v("Remove")]),n("md-menu-item",{on:{click:function(t){return e.$emit("add")}}},[e._v("Add to playlist")]),e.song.isCached?n("md-menu-item",{on:{click:function(t){return e.$emit("recache")}}},[e._v("Reload cache")]):e._e()],1)],1)],1)},P=[],E=(n("6b54"),n("f576"),function(){function e(){Object(d["a"])(this,e)}return Object(f["a"])(e,[{key:"secondsToHms",value:function(e){if(e=Math.round(e),e<60)return"0:"+e.toString().padStart(2,"0");if(e<3600)return Math.floor(e/60)+":"+(e%60).toString().padStart(2,"0");var t=Math.floor(e/60/60),n=Math.floor(e%60/60).toString().padStart(2,"0"),r=Math.floor(e%3600).toString().padStart(2,"0");return"".concat(t,":").concat(n,":").concat(r)}},{key:"shuffle",value:function(e){var t,n,r=e.length;while(r)n=Math.floor(Math.random()*r--),t=e[r],e[r]=e[n],e[n]=t;return e}}]),e}()),T=new E,Q={name:"SongItem",props:{song:{type:b,required:!0}},methods:{secondsToHms:T.secondsToHms},watch:{song:{handler:function(){this.song.scrollIntoView&&(this.song.scrollIntoView=!1,this.$el.scrollIntoView({behavior:"smooth",block:"nearest"}))},deep:!0}}},N=Q,A=(n("f13b"),n("2877")),L=Object(A["a"])(N,I,P,!1,null,"6dfb081a",null),F=L.exports,M={name:"song-list",components:{SongItem:F},data:function(){return{cachingStatusChecker:-1,cachedStatusChecker:-1}},props:{currentSong:{type:b,required:!0},songs:{type:Array,required:!0},title:{type:String,required:!1}},methods:{},mounted:function(){var e=this;_.checkSongsCacheStatus(this.songs),this.cachedStatusChecker=setInterval(function(){_.checkSongsCacheStatus(e.songs)},5e3)},watch:{songs:function(){_.checkSongsCacheStatus(this.songs)}}},B=M,U=(n("f7d1"),Object(A["a"])(B,q,$,!1,null,"dd99657e",null)),D=U.exports,H=n("75fc"),V=function(){function e(){Object(d["a"])(this,e),this.playlistQueues={favorites:{update:function(){},songs:[],shuffledSongs:[]},search:{update:function(){},songs:[],shuffledSongs:[]}},this.queueName=null===localStorage.getItem("lastQueue")?"favorites":localStorage.lastQueue}return Object(f["a"])(e,[{key:"setQueue",value:function(e,t,n){void 0===this.playlistQueues[e]&&(this.playlistQueues[e]={}),this.playlistQueues[e].songs=t,this.playlistQueues[e].update=n,this.playlistQueues[e].shuffledSongs=T.shuffle(Object(H["a"])(t)),console.log(this.playlistQueues[e])}},{key:"reshuffle",value:function(e){this.playlistQueues[e].shuffledSongs=T.shuffle(Object(H["a"])(this.playlistQueues[e].songs))}},{key:"queue",get:function(){return this.playlistQueues[this.queueName]}},{key:"queueName",set:function(e){console.log("Queue name is now",e),this._queueName=e,localStorage.lastQueue=e},get:function(){return this._queueName}}]),e}(),J=new V,W={name:"song-tab",components:{SongList:D},data:function(){return{loaded:!1,songs:[]}},props:{currentSong:{type:b,required:!0},playlistId:{type:Number,required:!0}},methods:{add:function(e){this.$emit("add",e)},remove:function(e){this.$emit("remove",e,this.playlistId)},playSong:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:this.$emit("play",t,"favorites");case 1:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}(),recache:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:this.$emit("recache",t);case 1:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}(),setSongs:function(e){var t=this;this.songs=e,J.setQueue("favorites",e,function(){return t.updateSongs()})},updateSongs:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return null!==localStorage.getItem("songs")&&this.setSongs(JSON.parse(localStorage.songs).map(b.fromObject)),e.prev=1,e.t0=this,e.next=5,S.favorites();case 5:e.t1=b.fromObject,e.t2=e.sent.map(e.t1),e.t0.setSongs.call(e.t0,e.t2),localStorage.songs=o()(this.songs),_.checkSongsCacheStatus(this.songs),e.next=14;break;case 12:e.prev=12,e.t3=e["catch"](1);case 14:case"end":return e.stop()}},e,this,[[1,12]])}));function t(){return e.apply(this,arguments)}return t}()},mounted:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.updateSongs();case 2:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},Y=W,z=Object(A["a"])(Y,h,p,!1,null,"4325d00e",null),X=z.exports,G=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"artist-tab"},[0===e.artists.length?n("h3",[e._v("No artists found")]):e._e(),n("md-list",e._l(e.artists,function(t){return n("md-list-item",{staticClass:"md-list-item-button",on:{click:function(n){return e.openArtistPage(t)}}},[e._v("\n            "+e._s(t)+"\n        ")])}),1)],1)},K=[],Z={name:"ArtistTab",data:function(){return{artists:[]}},props:{currentSong:{type:b,required:!0},playlistId:{type:Number,required:!0}},methods:{openArtistPage:function(e){console.log(e),this.$router.push("/artist/".concat(e))}},mounted:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(void 0===this.playlistId){e.next=4;break}return e.next=3,S.artists(this.playlistId);case 3:this.artists=e.sent;case 4:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),watch:{playlistId:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,S.artists(this.playlistId);case 2:this.artists=e.sent;case 3:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()}},ee=Z,te=(n("5adf"),Object(A["a"])(ee,G,K,!1,null,"3ae19749",null)),ne=te.exports,re=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},ae=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"playlist-tab"},[n("h1",[e._v("plal;sit tab")])])}],se={name:"PlaylistTab"},ie=se,oe=Object(A["a"])(ie,re,ae,!1,null,"aa9f09f6",null),ue=oe.exports,ce=(n("34ef"),function(){function e(){Object(d["a"])(this,e)}return Object(f["a"])(e,[{key:"login",value:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(t,n){var r,a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.hash(n);case 2:return r=e.sent,e.next=5,S.login(t,r);case 5:return a=e.sent,!0===a.success&&(localStorage.user=o()({user:t,password:r})),S.user={user:t,password:r},e.abrupt("return",a);case 9:case"end":return e.stop()}},e,this)}));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"logout",value:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:S.user={user:"",password:""},localStorage.clear();case 2:case"end":return e.stop()}},e)}));function t(){return e.apply(this,arguments)}return t}()},{key:"register",value:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(t,n){var r,a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.hash(n);case 2:return r=e.sent,e.next=5,S.register(t,r);case 5:return a=e.sent,console.log("register result: ",a),S.user={user:t,password:r},e.abrupt("return",a);case 9:case"end":return e.stop()}},e,this)}));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"hash",value:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(t){var n,r,a=arguments;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return n=a.length>1&&void 0!==a[1]?a[1]:"SHA-256",t+="xxTsC/JoZp0oo3dTaXrWswe3cOIi4GBsRPh0F6SVKww8q2I01uQI3gmYVq6RU9A4l9YkQ8W",e.next=4,crypto.subtle.digest(n,(new TextEncoder).encode(t));case 4:return r=e.sent,e.abrupt("return",btoa(new Uint8Array(r).reduce(function(e,t){return e+String.fromCharCode(t)},"")));case 6:case"end":return e.stop()}},e)}));function t(t){return e.apply(this,arguments)}return t}()},{key:"isLoggedIn",get:function(){return S.hasUser}}]),e}()),le=new ce,he=n("3d20"),pe=n.n(he),de=!1,fe=de?"http://localhost:3000":"https://ruurd.dev:3000";S.setServer(fe);var me={name:"App",data:function(){return{currentSong:new b,searchQuery:"",progress:0,playing:!1,loading:!1,updatingInterval:!1,currentPlaylist:[],playlists:[],favoritesId:-1,showDialog:!1,songToAdd:new b,firstLetter:"A",shuffleEnabled:!1}},components:{SongTab:X,ArtistTab:ne,PlaylistTab:ue},mounted:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return le.isLoggedIn||"login"===this.$route.name||this.$router.push("/login?redirect="+encodeURIComponent(location.href)),this.firstLetter=S.user.user.substr(0,1).toUpperCase(),console.log(J),this.searchQuery=this.$route.params.query||"",e.prev=4,e.next=7,S.playlists();case 7:this.playlists=e.sent,this.favoritesId=this.playlists.find(function(e){return"favorites"===e.name}).playlistid,e.next=13;break;case 11:e.prev=11,e.t0=e["catch"](4);case 13:document.addEventListener("mouseup",function(e){return t.endSeeking(e)}),document.addEventListener("touchend",function(e){return t.endSeeking(e.changedTouches[0])}),document.addEventListener("mousemove",function(e){return t.seek(e)}),document.addEventListener("touchmove",function(e){return t.seek(e.touches[0])}),this.updatingInterval=setInterval(function(){var e=document.querySelector(".audio-player");if(!e.duration||!e.currentTime)return 0;var n=e.currentTime/e.duration;t.progress=Math.round(1e4*n)/100},10),this.loadInitialSong();case 19:case"end":return e.stop()}},e,this,[[4,11]])}));function t(){return e.apply(this,arguments)}return t}(),methods:{recache:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(t){var n=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return console.log("recache",t),this.currentSong.id===t.id&&(J.queue.songs.length>1?this.skip(1).then(function(){return n.togglePlayPause(!1)}):this.currentSong=new b),e.next=4,j.remove(t.id);case 4:return e.next=6,_.cacheSongLocallyIfNeeded(t);case 6:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}(),cacheAllOnline:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=J.queue.songs.map(function(e){return _.cacheSongLocallyIfNeeded(e)}),e.next=3,c.a.all(t);case 3:case"end":return e.stop()}},e)}));function t(){return e.apply(this,arguments)}return t}(),toggleShuffle:function(){this.shuffleEnabled=!this.shuffleEnabled,this.shuffleEnabled&&J.reshuffle(J.queueName)},logout:function(){pe.a.fire({title:"Are you sure you want to log out?",type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, logout"}).then(function(e){e.value&&(le.logout(),location.reload())})},clearSearch:function(){this.searchQuery="",document.querySelector(".search-input").focus()},performSearch:function(e){e.target.blur(),this.$router.push("/search/"+this.searchQuery),console.log(this.searchQuery)},removeFromPlaylist:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,S.remove(t.id,n);case 2:n===this.favoritesId?J.playlistQueues.favorites.update():J.playlistQueues[n].update();case 3:case"end":return e.stop()}},e,this)}));function t(t,n){return e.apply(this,arguments)}return t}(),addToPlaylist:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(this.showDialog=!1,""!==t.id){e.next=3;break}return e.abrupt("return");case 3:return e.prev=3,e.next=6,S.save(t.id,n);case 6:n===this.favoritesId?J.playlistQueues.favorites.update():J.playlistQueues[n].update(),e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](3),alert("Can't reach server, song has not been added to playlist");case 12:case"end":return e.stop()}},e,this,[[3,9]])}));function t(t,n){return e.apply(this,arguments)}return t}(),showPlaylistDialog:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:this.showDialog=!0,this.songToAdd=t;case 2:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}(),loadInitialSong:function(){var e;e=localStorage.getItem("lastPlayedSong")?b.fromObject(JSON.parse(localStorage.lastPlayedSong)):J.queue.songs[0],e&&this.loadSong(e)},skip:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(t){var n,r,a,s,i=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(-1!==t){e.next=5;break}if(n=document.querySelector(".audio-player"),!(n.currentTime>5)){e.next=5;break}return n.currentTime=0,e.abrupt("return");case 5:r=this.shuffleEnabled?J.queue.shuffledSongs:J.queue.songs,a=r.findIndex(function(e){return e.id===i.currentSong.id}),s=(a+t)%r.length;while(s<0)s+=r.length;return r[s].scrollIntoView=!0,e.next=12,this.playSong(r[s],J.queueName);case 12:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}(),playSong:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(t){var n,r=arguments;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return n=r.length>1&&void 0!==r[1]?r[1]:"favorites",J.queueName=n,e.next=4,this.loadSong(t);case 4:this.togglePlayPause(!0);case 5:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}(),loadSong:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(t){var n,r=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(n=document.querySelector(".audio-player"),t.id!==this.currentSong.id||!n.currentTime||n.duration===1/0){e.next=6;break}return n.currentTime=0,e.next=5,n.play();case 5:return e.abrupt("return");case 6:return e.abrupt("return",new c.a(function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(a){var s;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return r.loading=!0,r.currentSong=t,r.setSongMetaData(t),localStorage.lastPlayedSong=o()(t),n.pause(),e.next=7,_.getAudioSource(t);case 7:if(s=e.sent,r.currentSong.id===t.id){e.next=10;break}return e.abrupt("return");case 10:n.src=s,n.load(),n.onended=function(){r.skip(1)},n.oncanplay=Object(l["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:n.duration&&(t.duration=n.duration),r.loading=!1,a(),n.oncanplay=function(){};case 4:case"end":return e.stop()}},e)}));case 14:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()));case 7:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}(),togglePlayPause:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(n=document.querySelector(".audio-player"),void 0===t&&(t=n.paused),!t){e.next=9;break}return navigator.mediaSession.playbackState="playing",this.playing=!0,e.next=7,n.play();case 7:e.next=12;break;case 9:navigator.mediaSession.playbackState="paused",this.playing=!1,n.pause();case 12:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}(),setSongMetaData:function(e){var t=this;document.title=e.artist+" - "+e.title,"mediaSession"in navigator&&(navigator.mediaSession.metadata=new MediaMetadata({title:e.title,artist:e.artist,artwork:[{src:e.thumbnail,type:"image/png"}]}),navigator.mediaSession.setActionHandler("play",Object(l["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.togglePlayPause(!0);case 2:case"end":return e.stop()}},e)}))),navigator.mediaSession.setActionHandler("pause",Object(l["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.togglePlayPause(!1);case 2:case"end":return e.stop()}},e)}))),navigator.mediaSession.setActionHandler("previoustrack",function(){t.skip(-1)}),navigator.mediaSession.setActionHandler("nexttrack",function(){t.skip(1)}))},startSeeking:function(e){this.seeking=!0,this.seekByEvent(e)},endSeeking:function(e){this.seeking=!1},seek:function(e){this.seeking&&this.seekByEvent(e)},seekByEvent:function(e){var t=document.querySelector(".seek-bar"),n=(e.pageX-t.offsetLeft)/t.offsetWidth;n=Math.max(0,n),this.seekByValue(n)},seekByValue:function(e){var t=document.querySelector(".audio-player"),n=0;t.duration&&(n=t.duration*e),t.currentTime=n},secondsToHms:T.secondsToHms},watch:{}},ge=me,ve=(n("034f"),Object(A["a"])(ge,a,s,!1,null,null,null)),ye=ve.exports,we=n("8c4f"),be=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"home"},[n("md-tabs",{staticClass:"md-primary",attrs:{"md-sync-route":""}},[n("md-tab",{attrs:{id:"tab-songs","md-label":"Songs",to:"/"}},[n("song-tab",{attrs:{"current-song":e.currentSong,"playlist-id":e.favoritesId},on:{play:e.playSong,add:e.add,remove:e.remove,recache:e.recache}})],1),n("md-tab",{attrs:{id:"tab-artists","md-label":"Artists",to:"/home/artists"}},[n("artist-tab",{attrs:{"current-song":e.currentSong,"playlist-id":e.favoritesId},on:{play:e.playSong,add:e.add,remove:e.remove,recache:e.recache}})],1),n("md-tab",{attrs:{id:"tab-playlists","md-label":"Playlists",to:"/home/playlists"}},[e._v("\n            Posts tab\n            "),n("p",[e._v("Qui, voluptas repellat impedit ducimus earum at ad architecto consectetur perferendis aspernatur\n                iste amet ex tempora animi, illum tenetur quae assumenda iusto.")])])],1)],1)},ke=[],Se={name:"home",components:{ArtistTab:ne,SongTab:X},props:{currentSong:{type:b,required:!0},favoritesId:{type:Number,required:!0}},mounted:function(){},methods:{add:function(e){this.$emit("add",e)},remove:function(e){this.$emit("remove",e,this.favoritesId)},playSong:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:this.$emit("play",t,n);case 1:case"end":return e.stop()}},e,this)}));function t(t,n){return e.apply(this,arguments)}return t}(),recache:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:this.$emit("recache",t);case 1:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}()}},xe=Se,Re=(n("7a15"),Object(A["a"])(xe,be,ke,!1,null,"3f94dfdf",null)),Oe=Re.exports,je=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"search"},[e.loading?n("div",{staticClass:"center-x"},[n("div",{staticClass:"center-y"},[n("md-progress-spinner",{staticClass:"md-accent spinner",attrs:{"md-mode":"indeterminate","md-stroke":3,"md-diameter":60}})],1)]):n("song-list",{attrs:{title:"Search results for "+e.$route.params.query,"current-song":e.currentSong,songs:e.songs},on:{play:e.playSong,add:e.add,remove:e.remove,recache:e.recache}})],1)},Ce=[],_e=(n("386d"),{name:"search",components:{SongList:D},props:{currentSong:{type:b,required:!0},favoritesId:{type:Number,required:!0}},data:function(){return{songs:[],loading:!1}},methods:{add:function(e){this.$emit("add",e)},remove:function(e){this.$emit("remove",e,this.favoritesId)},playSong:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:this.$emit("play",t,"search");case 1:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}(),recache:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:this.$emit("recache",t);case 1:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}(),search:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(t){var n=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.loading=!0,e.next=3,S.search(t);case 3:this.songs=e.sent,this.loading=!1,J.setQueue("search",this.songs,function(){return n.search(t)});case 6:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}()},mounted:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:this.search(this.$route.params.query);case 1:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),watch:{$route:function(e){this.search(e.params.query)}}}),qe=_e,$e=(n("b731"),Object(A["a"])(qe,je,Ce,!1,null,"46500a2a",null)),Ie=$e.exports,Pe=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},Ee=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"playlist"},[r("img",{attrs:{alt:"Vue logo",src:n("cf05")}}),e._v("\n  playlist\n")])}],Te={name:"playlist",components:{}},Qe=Te,Ne=Object(A["a"])(Qe,Pe,Ee,!1,null,null,null),Ae=Ne.exports,Le=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"login"},[n("h2",[e._v("Login")]),n("md-field",{class:e.userError?"md-invalid":""},[n("label",[e._v("Username")]),n("md-input",{attrs:{name:"username"},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.login()}},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}}),n("span",{staticClass:"md-error"},[e._v(e._s(e.userError)+"}")])],1),n("md-field",{class:e.passError?"md-invalid":""},[n("label",[e._v("Password")]),n("md-input",{attrs:{name:"password",type:"password"},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.login()}},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}}),n("span",{staticClass:"md-error"},[e._v(e._s(e.passError))])],1),n("md-button",{staticClass:"md-accent md-raised",on:{click:function(t){return e.login()}}},[e._v("Login")]),n("md-button",{on:{click:function(t){return e.register()}}},[e._v("Register")])],1)},Fe=[],Me=(n("a481"),{name:"home",data:function(){return{username:"",password:"",userError:!1,passError:!1}},components:{},props:{},mounted:function(){},methods:{login:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,le.login(this.username,this.password);case 2:t=e.sent,!0===t.success?this.redirect():this.userError="Login failed: incorrect username/password combination";case 4:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),register:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,le.register(this.username,this.password);case 2:t=e.sent,!0===t.success?this.redirect():this.userError="Register failed: username already in use";case 4:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),redirect:function(){var e=this.$route.query.redirect;e?(location.href=e,location.reload()):(location.href=location.href.replace(location.hash,""),location.reload())}}}),Be=Me,Ue=(n("b2b4"),Object(A["a"])(Be,Le,Fe,!1,null,"15482ed5",null)),De=Ue.exports,He=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"artist"},[n("song-list",{attrs:{"current-song":e.currentSong,songs:e.songs,title:"Songs by "+e.$route.params.artistName},on:{play:e.playSong,add:e.add,remove:e.remove,recache:e.recache}})],1)},Ve=[],Je={name:"artist",components:{SongList:D},props:{currentSong:{type:b,required:!0},favoritesId:{type:Number,required:!0}},data:function(){return{songs:[]}},mounted:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:this.getSongs();case 1:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),methods:{add:function(e){this.$emit("add",e)},remove:function(e){this.$emit("remove",e,this.favoritesId)},playSong:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:this.$emit("play",t,"artist_"+this.$route.params.artistName);case 1:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}(),recache:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:this.$emit("recache",t);case 1:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}(),getSongs:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(){var t,n=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,S.artistSongs(this.$route.params.artistName);case 2:t=e.sent,console.log(t),J.setQueue("artist_"+this.$route.params.artistName,t,function(){return n.getSongs()}),this.songs=t;case 6:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()}},We=Je,Ye=Object(A["a"])(We,He,Ve,!1,null,null,null),ze=Ye.exports;r["default"].use(we["a"]);var Xe=new we["a"]({routes:[{path:"/",name:"root",component:Oe,props:!0},{path:"/home/:tab?",name:"home",component:Oe,props:!0},{path:"/search/:query?",name:"search",component:Ie},{path:"/playlist/:userName/:playlistName",name:"playlist",component:Ae},{path:"/artist/:artistName",name:"artist",component:ze},{path:"/login",name:"login",component:De}]}),Ge=n("9483");Object(Ge["a"])("".concat("/vuemusic/","service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered:function(){console.log("Service worker has been registered.")},cached:function(){console.log("Content has been cached for offline use.")},updatefound:function(){console.log("New content is downloading.")},updated:function(){console.log("New content is available; please refresh.")},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(e){console.error("Error during service worker registration:",e)}});var Ke=n("43f9"),Ze=n.n(Ke);n("51de"),n("e094");r["default"].config.productionTip=!1,r["default"].use(Ze.a),r["default"].component("router-link",r["default"].options.components.RouterLink),r["default"].component("router-view",r["default"].options.components.RouterView),new r["default"]({router:Xe,render:function(e){return e(ye)}}).$mount("#app")},"5adf":function(e,t,n){"use strict";var r=n("df41"),a=n.n(r);a.a},6073:function(e,t,n){},"64a9":function(e,t,n){},7261:function(e,t,n){},"7a15":function(e,t,n){"use strict";var r=n("7261"),a=n.n(r);a.a},a78e:function(e,t,n){},b25a:function(e,t,n){},b2b4:function(e,t,n){"use strict";var r=n("0b64"),a=n.n(r);a.a},b731:function(e,t,n){"use strict";var r=n("6073"),a=n.n(r);a.a},cf05:function(e,t,n){e.exports=n.p+"img/logo.82b9c7a5.png"},df41:function(e,t,n){},f13b:function(e,t,n){"use strict";var r=n("b25a"),a=n.n(r);a.a},f7d1:function(e,t,n){"use strict";var r=n("a78e"),a=n.n(r);a.a}});
//# sourceMappingURL=app.0e8a3a54.js.map