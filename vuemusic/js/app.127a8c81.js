(function(t){function e(e){for(var i,s,n=e[0],l=e[1],c=e[2],d=0,u=[];d<n.length;d++)s=n[d],Object.prototype.hasOwnProperty.call(r,s)&&r[s]&&u.push(r[s][0]),r[s]=0;for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(t[i]=l[i]);m&&m(e);while(u.length)u.shift()();return o.push.apply(o,c||[]),a()}function a(){for(var t,e=0;e<o.length;e++){for(var a=o[e],i=!0,s=1;s<a.length;s++){var n=a[s];0!==r[n]&&(i=!1)}i&&(o.splice(e--,1),t=l(l.s=a[0]))}return t}var i={},s={app:0},r={app:0},o=[];function n(t){return l.p+"js/"+({}[t]||t)+"."+{"chunk-052550ba":"0c0829b8","chunk-06dc3485":"4491b221","chunk-2b10b9fa":"fdeda581","chunk-2d0c8407":"85f87e53","chunk-314eefa8":"6d4743dc","chunk-33d769f7":"3640cff9","chunk-434081dc":"03e8dead","chunk-47ded2ce":"6fe57ae0","chunk-48812fbb":"9566dcee","chunk-5490ef49":"fc5c1f20","chunk-636f1403":"20d90922","chunk-6ee204f4":"66680261","chunk-7971da4c":"eea849b4","chunk-850b013e":"e344b1d2","chunk-a8214eee":"3dc8b772","chunk-d3bfad98":"56164e25","chunk-d70e2628":"518275d6","chunk-e72801d6":"3468d1a8"}[t]+".js"}function l(e){if(i[e])return i[e].exports;var a=i[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,l),a.l=!0,a.exports}l.e=function(t){var e=[],a={"chunk-052550ba":1,"chunk-06dc3485":1,"chunk-2b10b9fa":1,"chunk-314eefa8":1,"chunk-33d769f7":1,"chunk-434081dc":1,"chunk-47ded2ce":1,"chunk-48812fbb":1,"chunk-5490ef49":1,"chunk-636f1403":1,"chunk-6ee204f4":1,"chunk-7971da4c":1,"chunk-850b013e":1,"chunk-a8214eee":1,"chunk-d3bfad98":1,"chunk-d70e2628":1,"chunk-e72801d6":1};s[t]?e.push(s[t]):0!==s[t]&&a[t]&&e.push(s[t]=new Promise((function(e,a){for(var i="css/"+({}[t]||t)+"."+{"chunk-052550ba":"33a47b5a","chunk-06dc3485":"2ce46cd1","chunk-2b10b9fa":"50866f30","chunk-2d0c8407":"31d6cfe0","chunk-314eefa8":"2a76af22","chunk-33d769f7":"010020c0","chunk-434081dc":"2c47cabc","chunk-47ded2ce":"9874d078","chunk-48812fbb":"f3c9fad7","chunk-5490ef49":"911807b8","chunk-636f1403":"b6595e8e","chunk-6ee204f4":"9580c93b","chunk-7971da4c":"36521ffa","chunk-850b013e":"8c8668da","chunk-a8214eee":"b3eadc6c","chunk-d3bfad98":"92a746ee","chunk-d70e2628":"a5b34b12","chunk-e72801d6":"50866f30"}[t]+".css",r=l.p+i,o=document.getElementsByTagName("link"),n=0;n<o.length;n++){var c=o[n],d=c.getAttribute("data-href")||c.getAttribute("href");if("stylesheet"===c.rel&&(d===i||d===r))return e()}var u=document.getElementsByTagName("style");for(n=0;n<u.length;n++){c=u[n],d=c.getAttribute("data-href");if(d===i||d===r)return e()}var m=document.createElement("link");m.rel="stylesheet",m.type="text/css",m.onload=e,m.onerror=function(e){var i=e&&e.target&&e.target.src||r,o=new Error("Loading CSS chunk "+t+" failed.\n("+i+")");o.code="CSS_CHUNK_LOAD_FAILED",o.request=i,delete s[t],m.parentNode.removeChild(m),a(o)},m.href=r;var h=document.getElementsByTagName("head")[0];h.appendChild(m)})).then((function(){s[t]=0})));var i=r[t];if(0!==i)if(i)e.push(i[2]);else{var o=new Promise((function(e,a){i=r[t]=[e,a]}));e.push(i[2]=o);var c,d=document.createElement("script");d.charset="utf-8",d.timeout=120,l.nc&&d.setAttribute("nonce",l.nc),d.src=n(t);var u=new Error;c=function(e){d.onerror=d.onload=null,clearTimeout(m);var a=r[t];if(0!==a){if(a){var i=e&&("load"===e.type?"missing":e.type),s=e&&e.target&&e.target.src;u.message="Loading chunk "+t+" failed.\n("+i+": "+s+")",u.name="ChunkLoadError",u.type=i,u.request=s,a[1](u)}r[t]=void 0}};var m=setTimeout((function(){c({type:"timeout",target:d})}),12e4);d.onerror=d.onload=c,document.head.appendChild(d)}return Promise.all(e)},l.m=t,l.c=i,l.d=function(t,e,a){l.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},l.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},l.t=function(t,e){if(1&e&&(t=l(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(l.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)l.d(a,i,function(e){return t[e]}.bind(null,i));return a},l.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return l.d(e,"a",e),e},l.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},l.p="/vuemusic/",l.oe=function(t){throw console.error(t),t};var c=window["webpackJsonp"]=window["webpackJsonp"]||[],d=c.push.bind(c);c.push=e,c=c.slice();for(var u=0;u<c.length;u++)e(c[u]);var m=d;o.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"034f":function(t,e,a){"use strict";a("85ec")},"0781":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-form",{on:{submit:function(e){return e.preventDefault(),t.pushSearchTerm.apply(null,arguments)}}},[a("v-text-field",{attrs:{clearable:"",outlined:"",label:"Search","prepend-inner-icon":"mdi-magnify",dense:""},on:{"click:clear":function(e){t.$store.state.search.liveTerm=""},click:t.goSearch},model:{value:t.$store.state.search.liveTerm,callback:function(e){t.$set(t.$store.state.search,"liveTerm",e)},expression:"$store.state.search.liveTerm"}})],1)},s=[],r=(a("caad"),{name:"SearchInput",methods:{async goSearch(){"Search"!==this.$route.name&&await this.pushSearchTerm()},async pushSearchTerm(){let t="";null!==this.term&&""!==this.term&&(t="?term="+encodeURIComponent(this.term)),await this.$router.push("/search"+t)}},watch:{async term(){if(this.term&&this.term.includes("open.spotify.com/")){let t=this.term.split("spotify.com/")[1].split("?")[0],[e,a]=t.split("/");await this.$router.push(this.$store.getters.relativeItemUrl({type:e,id:a,name:e[0]})),this.$store.dispatch("addSnack",{text:"Navigated to Spotify™ link"}).then(),this.$store.commit("liveTerm","")}}},computed:{term(){return this.$store.state.search.liveTerm}}}),o=r,n=a("2877"),l=a("6544"),c=a.n(l),d=a("4bd4"),u=a("8654"),m=Object(n["a"])(o,i,s,!1,null,"0795f20a",null);e["a"]=m.exports;c()(m,{VForm:d["a"],VTextField:u["a"]})},"091d":function(t,e,a){},1:function(t,e){},10:function(t,e){},11:function(t,e){},12:function(t,e){},13:function(t,e){},1344:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return null!==t.track?a("v-sheet",{ref:"trackRow",staticClass:"track-row",class:t.rowClass,attrs:{color:t.activeTrack?"primary darken-1":"transparent",dark:t.activeTrack&&(!t.$vuetify.theme.dark||t.$store.state.theme.fgLegible),light:t.activeTrack&&!(!t.$vuetify.theme.dark||t.$store.state.theme.fgLegible),rounded:""},on:{dblclick:t.play}},[a("track-item",{ref:"trackItem",staticClass:"track-left",attrs:{"context-item":t.contextItem,track:t.track,"album-list":t.albumList}}),t.albumList?t._e():a("div",{staticClass:"track-middle",attrs:{title:t.track.album.name}},[a("router-link",{staticClass:"album-link",attrs:{tag:"span",to:t.$store.getters.relativeItemUrl(t.track.album)}},[t._v(" "+t._s(t.track.album.name)+" ")])],1),a("div",{staticClass:"track-right"},[a("div",{staticClass:"track-duration"},[t._v(t._s(t.duration))]),a("item-menu",{attrs:{"queue-track":t.queueTrack,"context-item":t.contextItem,item:t.track}})],1)],1):t._e()},s=[],r=a("7628"),o=a("a123"),n=a("1f42"),l=a("e292"),c=a("5dd2"),d=a("190f"),u=a("9bcd"),m={name:"TrackRow",components:{ItemMenu:u["a"],FollowMenuItem:d["a"],ShareMenuItem:c["a"],FollowButton:l["a"],TrackItem:n["a"],ArtistsSpan:r["a"]},props:{track:{type:Object,default:null},albumList:{type:Boolean,default:!1},contextItem:{type:Object,default:null,required:!0},queueTrack:{type:Boolean,default:!1}},data:()=>({rowWidth:0}),mounted(){this.windowResize(),window.addEventListener("resize",this.windowResize)},beforeDestroy(){window.removeEventListener("resize",this.windowResize)},methods:{windowResize(){this.rowWidth=this.$refs.trackRow.$el.getBoundingClientRect().width},play(){this.$refs.trackItem.play()}},computed:{rowClass(){return this.rowWidth>623?"big":"small"},duration(){return o["a"].secondsToHms(this.track.duration_ms/1e3)},activeTrack(){return!!this.$store.getters.isTrackSet&&this.$store.state.media.track.id===this.track.id}}},h=m,p=(a("2177"),a("2877")),f=a("6544"),y=a.n(f),g=a("8dd9"),v=Object(p["a"])(h,i,s,!1,null,"61538a80",null);e["a"]=v.exports;y()(v,{VSheet:g["a"]})},14:function(t,e){},15:function(t,e){},"15a8":function(t,e,a){},"190f":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.isFollowed?a("v-list-item",{on:{click:t.unfollow}},[a("v-list-item-icon",[t.loading?a("v-progress-circular",{attrs:{size:"20",indeterminate:"",width:"1"}}):a("v-icon",{attrs:{color:"primary"}},[t._v("mdi-heart")])],1),a("v-list-item-title",[t._v("Remove from library")])],1):a("v-list-item",{attrs:{dense:""},on:{click:t.follow}},[a("v-list-item-icon",[t.loading?a("v-progress-circular",{attrs:{size:"20",indeterminate:"",width:"1"}}):a("v-icon",[t._v("mdi-heart-outline")])],1),a("v-list-item-title",[t._v("Add to library")])],1)},s=[],r={name:"FollowMenuItem",props:{item:{type:Object,default:null}},data:()=>({loading:!1}),methods:{async follow(){this.loading=!0,await this.$store.dispatch("follow"+this.typeCapitalized,this.item),this.loading=!1},async unfollow(){this.loading=!0,await this.$store.dispatch("unfollow"+this.typeCapitalized,this.item),this.loading=!1}},computed:{typeCapitalized(){return this.item.type.substring(0,1).toUpperCase()+this.item.type.substring(1)},isFollowed(){return this.$store.getters[`is${this.typeCapitalized}Followed`](this.item)}}},o=r,n=a("2877"),l=a("6544"),c=a.n(l),d=a("132d"),u=a("da13"),m=a("34c3"),h=a("5d23"),p=a("490a"),f=Object(n["a"])(o,i,s,!1,null,"795ad918",null);e["a"]=f.exports;c()(f,{VIcon:d["a"],VListItem:u["a"],VListItemIcon:m["a"],VListItemTitle:h["c"],VProgressCircular:p["a"]})},"1ed8":function(t,e,a){"use strict";a("aa56")},"1f42":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return null!==t.track?a("div",{staticClass:"track-item"},[a("div",{staticClass:"track-content"},[a("div",{staticClass:"left-square"},[t.albumList?a("div",{staticClass:"album-number"},[t._v(t._s(t.track.track_number))]):a("div",{staticClass:"album-art",style:{backgroundImage:"url("+t.$store.getters.itemImage(t.track)+")"}}),t.albumList?a("v-card",{staticClass:"play-button",style:{opacity:t.trackIsLoaded?"1":"0"},attrs:{flat:""}},[t.trackIsPlaying?a("v-btn",{attrs:{icon:""},on:{click:t.pause}},[a("v-icon",[t._v("mdi-pause")])],1):a("v-btn",{attrs:{icon:""},on:{click:t.play}},[a("v-icon",[t._v("mdi-play")])],1)],1):a("div",{staticClass:"play-button art-button",style:{opacity:t.trackIsLoaded?"1":"0"}},[t.trackIsPlaying?a("v-btn",{attrs:{icon:"",color:"white"},on:{click:t.pause}},[a("v-icon",[t._v("mdi-pause")])],1):a("v-btn",{attrs:{icon:"",color:"white"},on:{click:t.play}},[a("v-icon",[t._v("mdi-play")])],1)],1)],1),a("div",{staticClass:"track-info"},[a("div",{staticClass:"track-title",attrs:{title:t.track.name}},[t._v(" "+t._s(t.track.name)+" ")]),a("div",{staticClass:"track-artist"},[a("artists-span",{staticClass:"artists-span",attrs:{grey:"",artists:t.track.artists}})],1)])]),t.menu?a("div",{staticClass:"icons"},[a("follow-button",{attrs:{item:t.track}}),a("item-menu",{attrs:{"context-item":t.contextItem,item:t.track}})],1):t._e()]):t._e()},s=[],r=a("7628"),o=a("5dd2"),n=a("190f"),l=a("e292"),c=a("9bcd"),d={name:"TrackItem",components:{ItemMenu:c["a"],FollowButton:l["a"],FollowMenuItem:n["a"],ShareMenuItem:o["a"],ArtistsSpan:r["a"]},props:{track:{type:Object,default:null},albumList:{type:Boolean,default:!1},menu:{type:Boolean,default:!1},contextItem:{type:Object,default:null}},methods:{async play(){if(this.trackIsLoaded)return this.$store.dispatch("play");console.log("contextitem",this.contextItem),this.$store.commit("playAfterLoad",!0),this.$store.commit("track",{track:this.track,contextItem:this.contextItem})},async pause(){await this.$store.dispatch("pause")}},computed:{trackIsLoaded(){return!!this.$store.getters.isTrackSet&&this.$store.state.media.track.id===this.track.id},trackIsPlaying(){return this.trackIsLoaded&&this.$store.state.media.playing}}},u=d,m=(a("beca"),a("2877")),h=a("6544"),p=a.n(h),f=a("8336"),y=a("b0af"),g=a("132d"),v=Object(m["a"])(u,i,s,!1,null,"4eda178f",null);e["a"]=v.exports;p()(v,{VBtn:f["a"],VCard:y["a"],VIcon:g["a"]})},2:function(t,e){},2177:function(t,e,a){"use strict";a("7d25")},2703:function(t,e,a){"use strict";a("a7fc")},3:function(t,e){},"33b3":function(t,e,a){"use strict";a.d(e,"a",(function(){return c}));var i=a("faa1"),s=a.n(i),r=a("949d"),o=a.n(r),n=a("fa1c"),l=a.n(n);class c extends s.a{constructor(){super(),this.apiKey=null,this.searchCache=null===localStorage.getItem("searchCache")?{cacheAge:+new Date}:JSON.parse(localStorage.searchCache)}waitForApiKey(){return new Promise(t=>{if(null!==this.apiKey)return t();let e;e=setInterval(()=>{null!==this.apiKey&&(clearInterval(e),t())},100)})}getSearchString(t){return`${t.name} - ${t.artists.map(t=>t.name).join(", ")}`}async cachedSearch(t,e=3){let a=t+"|"+e.toString();if(this.searchCache[a])return this.searchCache[a];null===this.apiKey&&await this.waitForApiKey();let{results:i}=await l()(t,{maxResults:e,key:this.apiKey});return this.searchCache[a]=i,localStorage.searchCache=JSON.stringify(this.searchCache),i}async getYtdlInfo(t){return await o.a.getInfo(t,{quality:"highestaudio",filter:"audioonly"})}async*getTrackUrls(t){let e=await this.isTrackOffline(t);e&&(yield{local:!0,url:e});let a=this.getSearchString(t),i=await this.cachedSearch(a),s=i.map(t=>t.id);for(let r of s){let t=await this.getYtdlInfo(r),e=t.formats,a=["AUDIO_QUALITY_LOW","AUDIO_QUALITY_MEDIUM","AUDIO_QUALITY_HIGH"];e=e.sort((t,e)=>e.averageBitrate-t.averageBitrate).sort((t,e)=>e.audioBitrate-t.audioBitrate).sort((t,e)=>e.mimeType.startsWith("audio")-t.mimeType.startsWith("audio")).sort((t,e)=>a.indexOf(e.audioQuality)-a.indexOf(t.audioQuality));for(let i of e.slice(0,2))yield{local:!1,url:i.url}}}async isTrackOffline(t){throw"Not implemented"}async removeCached(t){throw"Not implemented"}async downloadTrack(t,e,a=(()=>0),i=null){throw"Not implemented"}}},"3bfc":function(t,e,a){},4:function(t,e){},"4c27":function(t,e,a){},5:function(t,e){},"50c0":function(t,e,a){"use strict";a("63da")},5119:function(t,e,a){},"56d7":function(t,e,a){"use strict";a.r(e);var i=a("2b0e"),s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-app",{staticClass:"app"},[t.$store.state.windowWidth>680?a("v-navigation-drawer",{staticClass:"navBar",attrs:{color:"navBackground",permanent:!0,app:"",absolute:""},model:{value:t.drawer,callback:function(e){t.drawer=e},expression:"drawer"}},[a("nav-content")],1):t._e(),a("v-app-bar",{staticClass:"toolbar",attrs:{app:"",elevation:"1"}},[a("tool-bar",{staticClass:"toolbar-content",attrs:{compact:t.$store.state.windowWidth<=1e3,mobile:t.$store.state.windowWidth<=680}})],1),a("v-main",[a("div",{staticClass:"perfect-scroller"},[a("router-view",{staticClass:"router-view"})],1)]),t._l(t.$store.state.snackbars,(function(e){return a("v-snackbar",{attrs:{app:"",timeout:e.timeout,outlined:!t.$vuetify.theme.dark,color:"primary"},scopedSlots:t._u([{key:"action",fn:function(i){var s=i.attrs;return[a("v-btn",t._b({attrs:{text:"",color:t.$vuetify.theme.dark?"default":"primary"},on:{click:function(t){e.open=!1}}},"v-btn",s,!1),[t._v(" Dismiss ")])]}}],null,!0),model:{value:e.open,callback:function(a){t.$set(e,"open",a)},expression:"snack.open"}},[t._v(" "+t._s(e.text)+" ")])})),t.$store.state.windowWidth<=1e3&&t.$store.getters.isTrackSet?a("v-card",{staticClass:"bottom-media-control",class:{"medium-width":t.$store.state.windowWidth<=1e3},attrs:{flat:"",color:"primaryLight"}},[a("div",{staticClass:"info-pane"},[a("media-info",{staticClass:"media-info"}),a("follow-button",{staticClass:"button",attrs:{item:t.$store.state.media.track}}),a("queue-button",{staticClass:"button"})],1),"NowPlaying"!==t.$route.name?a("div",{staticClass:"full-controls"},[a("media-controls",{attrs:{full:t.$store.state.windowWidth>430}}),a("media-seek",{staticClass:"seeker"})],1):t._e()]):t._e(),t.$store.state.windowWidth<=680?a("v-bottom-navigation",{attrs:{color:"primary",grow:"",shift:t.$store.state.windowWidth<=430,app:""}},[a("v-btn",{attrs:{value:"now",to:"/",exact:""}},[a("span",[t._v("Listen Now")]),a("v-icon",[t._v("mdi-play-circle-outline")])],1),a("v-btn",{attrs:{value:"browse",to:"/browse",exact:""}},[a("span",[t._v("Browse")]),a("v-icon",[t._v("mdi-grid-large")])],1),a("v-btn",{attrs:{value:"library",to:"/library"}},[a("span",[t._v("Library")]),a("v-icon",[t._v("mdi-record-circle-outline")])],1),a("v-btn",{attrs:{value:"search",to:"/search"}},[a("span",[t._v("Search")]),a("v-icon",[t._v("mdi-magnify")])],1)],1):t._e(),a("music-player")],2)},r=[],o=(a("caad"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"toolbar"},[t.mobile?a("logo",{staticClass:"logo"}):t._e(),t.mobile||t.compact?t._e():a("media-controls",{staticClass:"controls",attrs:{full:""}}),t.compact||t.mobile||!t.$store.getters.isTrackSet?t._e():a("div",{staticClass:"media-container"},[a("div",{staticClass:"media-info"},[a("media-seek",{staticClass:"top-seeker",attrs:{"no-background":"","small-time":""}}),a("media-info",{staticClass:"top-info",attrs:{"small-artists":"",drag:""}})],1),a("follow-button",{staticClass:"favorite-button",attrs:{"hide-tooltip":"",item:t.$store.state.media.track}}),a("queue-button",{staticClass:"queue-button"})],1),t.mobile?t._e():a("div",{staticClass:"volume"},[a("v-slider",{ref:"volume",attrs:{min:0,max:1,step:.01,"prepend-icon":t.volumeIcon},on:{"click:prepend":t.toggleMute},model:{value:t.volume,callback:function(e){t.volume=e},expression:"volume"}})],1),a("div",{staticClass:"buttons"},[a("v-menu",{attrs:{"offset-y":"","close-on-content-click":!0},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on,s=e.attrs;return[a("v-btn",t._g(t._b({attrs:{color:"primary",icon:""}},"v-btn",s,!1),i),[a("v-icon",[t._v("mdi-account-circle")])],1)]}}])},[a("v-list",[t.$store.getters.isLoggedIn?a("v-list-item",{attrs:{"two-line":""}},[a("router-link",{staticClass:"list-link",attrs:{tag:"div",to:"/user/"+t.$store.getters.urlName(t.$store.state.userInfo.name)+"/"+t.$store.state.userInfo.id}},[a("v-list-item-avatar",[a("img",{attrs:{src:t.$store.state.userInfo.avatar,alt:"User Avatar"}})]),a("v-list-item-content",[a("v-list-item-title",[t._v(t._s(t.$store.state.userInfo.name))]),a("v-list-item-subtitle",[t._v(t._s(t.$store.state.userInfo.mail))])],1)],1)],1):t._e(),a("v-list-item",{attrs:{to:"/downloads"}},[a("v-list-item-icon",[a("v-icon",[t._v("mdi-download")])],1),a("v-list-item-content",[a("v-list-item-title",[t._v("Downloads")])],1)],1),a("v-list-item",{attrs:{to:"/settings"}},[a("v-list-item-icon",[a("v-icon",[t._v("mdi-cog-outline")])],1),a("v-list-item-content",[a("v-list-item-title",[t._v("Settings")])],1)],1),t.$store.getters.isLoggedIn?a("v-list-item",{attrs:{color:"primary"},on:{click:function(e){return t.$store.dispatch("spotifyLogout")}}},[a("v-list-item-icon",[a("v-icon",[t._v("mdi-logout")])],1),a("v-list-item-content",[a("v-list-item-title",[t._v("Logout")])],1)],1):t.$store.getters.isKeySet?a("v-list-item",{attrs:{color:"primary"},on:{click:function(e){return t.$store.dispatch("spotifyLogin")}}},[a("v-list-item-icon",[a("v-icon",[t._v("mdi-login")])],1),a("v-list-item-content",[a("v-list-item-title",[t._v("Login")])],1)],1):t._e(),a("v-list-item",{attrs:{color:"primary"}},[a("v-list-item-icon",[a("v-icon",[t._v("mdi-brightness-6")])],1),a("v-list-item-content",[a("v-list-item-title",{staticClass:"theme-switch"},[a("span",[t._v("Dark theme")])])],1),a("v-list-item-action",[a("v-switch",{attrs:{dense:"",inset:""},model:{value:t.$vuetify.theme.dark,callback:function(e){t.$set(t.$vuetify.theme,"dark",e)},expression:"$vuetify.theme.dark"}})],1)],1)],1)],1),"electron"===t.$store.state.platform.type?a("v-btn",{staticClass:"minimize-button",attrs:{icon:""},on:{click:function(e){return t.$store.dispatch("minimizeWindow")}}},[a("v-icon",[t._v("mdi-minus")])],1):t._e(),"electron"===t.$store.state.platform.type?a("v-btn",{attrs:{icon:""},on:{click:function(e){return t.$store.dispatch("closeWindow")}}},[a("v-icon",[t._v("mdi-close")])],1):t._e()],1)],1)}),n=[],l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.$store.state.media.track?a("div",{staticClass:"media-info"},[a("v-card",{staticClass:"media-card",attrs:{outlined:""}},[a("div",{directives:[{name:"ripple",rawName:"v-ripple"}],staticClass:"media-album",style:{backgroundImage:"url("+t.$store.getters.itemImage(t.$store.state.media.track)+")"},on:{click:function(e){return t.$router.push("/nowplaying")}}}),a("div",{staticClass:"white-part"},[a("div",{staticClass:"media-text-info"},[a("div",{staticClass:"media-title-artists"},[a("span",{staticClass:"track-title",attrs:{title:t.$store.state.media.track.name}},[t._v(" "+t._s(t.$store.state.media.track.name)+" ")]),a("artists-span",{staticClass:"track-artists",style:{maxWidth:t.smallArtists?"calc(100% - 56px)":""},attrs:{grey:"",artists:t.$store.state.media.track.artists}})],1)]),a("div",{staticClass:"local-icon"},[t.$store.state.media.local?a("v-icon",{attrs:{small:t.$store.state.windowWidth>=1e3}},[t._v(" mdi-cloud-download-outline ")]):a("v-icon",{attrs:{small:t.$store.state.windowWidth>=1e3}},[t._v("mdi-radio-tower")])],1)])])],1):t._e()},c=[],d=a("6e9c"),u=a("7628"),m={name:"MediaInfo",components:{ArtistsSpan:u["a"],MediaControls:d["a"]},props:{drag:{type:Boolean,default:!1},smallArtists:{type:Boolean,default:!1}}},h=m,p=(a("644f"),a("2877")),f=a("6544"),y=a.n(f),g=a("b0af"),v=a("132d"),w=a("269a"),b=a.n(w),k=a("5607"),_=Object(p["a"])(h,l,c,!1,null,"0dc848f8",null),$=_.exports;y()(_,{VCard:g["a"],VIcon:v["a"]}),b()(_,{Ripple:k["a"]});var I=a("d498"),S=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"logo"},[a("img",{staticClass:"logo-image",attrs:{src:t.$vuetify.theme.dark?"img/full-white-medium.png":"img/full-black-medium.png",alt:"logo image"}}),a("span",[t._v(" Vue Music ")])])},T=[],C={name:"Logo"},x=C,L=(a("2703"),Object(p["a"])(x,S,T,!1,null,"16b6a68a",null)),P=L.exports,A=a("e292"),M=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.$store.getters.isTrackSet?a("div",{staticClass:"queue-button"},[a("v-menu",{attrs:{"offset-y":"","close-on-content-click":!1,"close-on-click":!0},on:{input:t.scrollToItem},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on,s=e.attrs;return[a("v-btn",t._g(t._b({attrs:{icon:""}},"v-btn",s,!1),i),[a("v-icon",[t._v("mdi-playlist-play")])],1)]}}],null,!1,2887210282)},[a("queue-list",{ref:"list",staticClass:"track-list"})],1)],1):t._e()},F=[],O=a("1344"),V=a("f966"),B={name:"QueueButton",components:{QueueList:V["a"],TrackRow:O["a"]},data:()=>({intervals:[]}),beforeDestroy(){this.clearIntervals()},methods:{clearIntervals(){let t=this.intervals;this.intervals=[];for(let e of t)clearInterval(e)},scrollToItem(){this.intervals.push(setInterval(()=>{this.$refs.list&&(this.$refs.list.scrollToItem(),this.clearIntervals())},50))}},computed:{},watch:{}},U=B,D=(a("8201"),a("8336")),E=a("e449"),j=Object(p["a"])(U,M,F,!1,null,"59edc3a6",null),R=j.exports;y()(j,{VBtn:D["a"],VIcon:v["a"],VMenu:E["a"]});var q={name:"ToolBar",components:{QueueButton:R,FollowButton:A["a"],Logo:P,MediaSeek:I["a"],MediaControls:d["a"],MediaInfo:$},data:()=>({volume:1,prevVolume:1}),props:{mobile:{type:Boolean,default:!1},compact:{type:Boolean,default:!1}},mounted(){this.mountVolumeListener(),this.volume=this.$store.state.media.volume**.5},beforeDestroy(){this.removeVolumeListener()},methods:{mountVolumeListener(){this.$refs.volume&&this.$refs.volume.$el.addEventListener("wheel",this.volumeScroll,!0)},removeVolumeListener(){this.$refs.volume&&this.$refs.volume.$el.removeEventListener("wheel",this.volumeScroll)},toggleMute(){this.volume>0?(this.prevVolume=this.volume,this.volume=0):this.volume=this.prevVolume},volumeScroll(t){let e=-25e-5*t.deltaY;this.volume=Math.min(1,Math.max(0,this.volume+e))}},watch:{"$vuetify.theme.dark"(){localStorage.darkTheme=this.$vuetify.theme.dark},"$store.state.media.volume"(){this.volume=this.$store.state.media.volume**.5},mobile(){this.mobile?this.removeVolumeListener():setTimeout(()=>{this.mountVolumeListener()},100)},volume(){this.$store.commit("volume",this.volume**2)}},computed:{volumeIcon(){return 0===this.volume?"mdi-volume-mute":this.volume<.5?"mdi-volume-medium":"mdi-volume-high"}}},N=q,z=(a("c0f2"),a("8860")),W=a("da13"),H=a("1800"),Q=a("8270"),K=a("5d23"),Y=a("34c3"),G=a("ba0d"),J=a("b73d"),X=Object(p["a"])(N,o,n,!1,null,"3401c773",null),Z=X.exports;y()(X,{VBtn:D["a"],VIcon:v["a"],VList:z["a"],VListItem:W["a"],VListItemAction:H["a"],VListItemAvatar:Q["a"],VListItemContent:K["a"],VListItemIcon:Y["a"],VListItemSubtitle:K["b"],VListItemTitle:K["c"],VMenu:E["a"],VSlider:G["a"],VSwitch:J["a"]});var tt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("perfect-scrollbar",{staticClass:"nav-bar"},[a("div",{staticClass:"nav-top"},[a("logo"),a("search-input",{staticClass:"search-input"})],1),a("v-list",{staticClass:"py-0",attrs:{dense:"",nav:""}},[a("v-list-item",{attrs:{to:"/",exact:""}},[a("v-list-item-icon",[a("v-icon",{attrs:{color:"primary"}},[t._v("mdi-play-circle-outline")])],1),a("v-list-item-content",[a("v-list-item-title",[t._v("Listen Now")])],1)],1),a("v-list-item",{attrs:{to:"/browse",exact:""}},[a("v-list-item-icon",[a("v-icon",{attrs:{color:"primary"}},[t._v("mdi-grid-large")])],1),a("v-list-item-content",[a("v-list-item-title",[t._v("Browse")])],1)],1),a("v-subheader",[t._v("Library")]),a("v-list-item",{attrs:{to:"/library/artists"}},[a("v-list-item-icon",[a("v-icon",{attrs:{color:"primary"}},[t._v("mdi-microphone-variant")])],1),a("v-list-item-content",[a("v-list-item-title",[t._v("Artists")])],1)],1),a("v-list-item",{attrs:{to:"/library/albums"}},[a("v-list-item-icon",[a("v-icon",{attrs:{color:"primary"}},[t._v("mdi-record-circle-outline")])],1),a("v-list-item-content",[a("v-list-item-title",[t._v("Albums")])],1)],1),a("v-list-item",{attrs:{to:"/library/tracks"}},[a("v-list-item-icon",[a("v-icon",{attrs:{color:"primary"}},[t._v("mdi-music-note")])],1),a("v-list-item-content",[a("v-list-item-title",[t._v("Tracks")])],1)],1),a("div",{staticClass:"playlist-header"},[t.$store.state.library.playlists.length>0?a("v-subheader",[t._v("Playlists")]):a("v-subheader",[t._v("Create playlist")]),t.showPlaylistInput?a("v-btn",{attrs:{small:"",text:""},on:{click:function(e){t.showPlaylistInput=!1}}},[t._v("Cancel")]):a("v-btn",{staticClass:"add-playlist",attrs:{icon:"",small:"",title:"Create new playlist"},on:{click:function(e){t.showPlaylistInput=!0}}},[a("v-icon",{attrs:{"x-small":""}},[t._v("mdi-plus")])],1)],1),t.showPlaylistInput?a("v-form",{staticClass:"create-playlist",on:{submit:function(e){return e.preventDefault(),t.createPlaylist.apply(null,arguments)}}},[a("v-text-field",{attrs:{autofocus:"",rules:t.playlistRules,label:"Playlist name",outlined:"",dense:""},model:{value:t.playlistName,callback:function(e){t.playlistName=e},expression:"playlistName"}}),a("v-btn",{attrs:{icon:"",type:"submit",loading:t.createLoading}},[a("v-icon",[t._v("mdi-plus")])],1)],1):t._e(),t._l(t.$store.state.library.playlists,(function(e){return a("v-list-item",{key:e.id,attrs:{to:t.$store.getters.relativeItemUrl(e),exact:""}},[a("v-list-item-icon",[a("v-icon",[t._v("mdi-playlist-music")])],1),a("v-list-item-content",[a("v-list-item-title",[t._v(t._s(e.name))])],1)],1)}))],2)],1)},et=[],at=a("0781"),it={name:"NavContent",components:{SearchInput:at["a"],Logo:P},data:()=>({showPlaylistInput:!1,playlistRules:[t=>t.length>0||"Name can't be empty"],playlistName:"",createLoading:!1}),mounted(){},methods:{async createPlaylist(){this.createLoading=!0;let t=await this.$store.dispatch("createPlaylist",this.playlistName);this.createLoading=!1,this.showPlaylistInput=!1,this.playlistName="",await this.$router.push($store.getters.relativeItemUrl(t))}},watch:{}},st=it,rt=(a("50c0"),a("4bd4")),ot=a("e0c7"),nt=a("8654"),lt=Object(p["a"])(st,tt,et,!1,null,"ccbadd1e",null),ct=lt.exports;y()(lt,{VBtn:D["a"],VForm:rt["a"],VIcon:v["a"],VList:z["a"],VListItem:W["a"],VListItemContent:K["a"],VListItemIcon:Y["a"],VListItemTitle:K["c"],VSubheader:ot["a"],VTextField:nt["a"]});var dt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div")},ut=[],mt={name:"MusicPlayer",data:()=>({timeInterval:-1}),async mounted(){this.timeInterval=setInterval(()=>{let t=this.$store.state.media.audio;this.$store.state.media.trackLoading||this.$store.commit("currentTime",t.currentTime),t.duration&&navigator&&navigator.mediaSession&&navigator.mediaSession.setPositionState&&navigator.mediaSession.setPositionState({duration:t.duration,playbackRate:1,position:t.currentTime})},1e3/30),this.handleVolume(),this.$store.getters.isTrackSet&&await this.$store.dispatch("setTrack",this.$store.state.media.track)},beforeDestroy(){clearInterval(this.timeInterval)},methods:{handleVolume(){let t=this.$store.state.media.audio,e=this.$store.state.media.backupAudio;t.volume=this.$store.state.media.volume,e.volume=this.$store.state.media.volume}},watch:{async"$store.state.media.track"(){await this.$store.dispatch("setTrack",this.$store.state.media.track)},"$store.state.media.volume"(){this.handleVolume()}}},ht=mt,pt=Object(p["a"])(ht,dt,ut,!1,null,"16984c14",null),ft=pt.exports,yt={name:"App",components:{MusicPlayer:ft,QueueButton:R,FollowButton:A["a"],NavContent:ct,MediaSeek:I["a"],MediaControls:d["a"],MediaInfo:$,ToolBar:Z},data:()=>({drawer:!0,cacheInterval:-1}),async mounted(){await this.$store.dispatch("initialize"),document.addEventListener("keypress",this.devListener),window.addEventListener("resize",this.resizeListener);let t=!1;if(window.onbeforeunload=e=>{this.$store.state.dontCache||t||(t=!0,this.$store.dispatch("cacheAll").then(()=>t=!1)),delete e["returnValue"]},"electron"===this.$store.state.platform.type){let e=window.require("electron");e.ipcRenderer.on("before-close",async()=>{t||(t=!0,await this.$store.dispatch("cacheAll"),t=!1),e.remote.app.quit()})}this.cacheInterval=setInterval(async()=>{await this.$store.dispatch("cacheAll")},12e4),console.log(this.$store),this.$store.getters.isKeySet?this.$store.getters.isLoggedIn||"Settings"===this.$route.name||await this.$router.push("/settings"):"Settings"!==this.$route.name&&await this.$router.push("/settings"),"web"===this.$store.state.platform.type&&this.handleCode()},beforeDestroy(){clearInterval(this.cacheInterval),document.removeEventListener("keypress",this.devListener),window.removeEventListener("resize",this.resizeListener)},methods:{handleCode(){if(location.search.includes("?code=")){let t=location.search.split("?code=")[1].split("&")[0],e=new BroadcastChannel("loginCode");e.postMessage(t),e.close(),window.close()}},resizeListener(){this.$store.commit("windowWidth",window.innerWidth)},devListener(t){"`"===t.key&&this.$store.dispatch("openDevTools"),"r"===t.key&&t.ctrlKey&&location.reload()}},watch:{"$vuetify.theme.dark"(){this.$store.dispatch("applyThemeColor",this.$store.state.theme.color)}}},gt=yt,vt=(a("034f"),a("7496")),wt=a("40dc"),bt=a("b81c"),kt=a("f6c4"),_t=a("f774"),$t=a("2db4"),It=Object(p["a"])(gt,s,r,!1,null,null,null),St=It.exports;y()(It,{VApp:vt["a"],VAppBar:wt["a"],VBottomNavigation:bt["a"],VBtn:D["a"],VCard:g["a"],VIcon:v["a"],VMain:kt["a"],VNavigationDrawer:_t["a"],VSnackbar:$t["a"]});var Tt=a("9483");Object(Tt["a"])("/vuemusic/service-worker.js",{ready(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered(){console.log("Service worker has been registered.")},cached(){console.log("Content has been cached for offline use.")},updatefound(){console.log("New content is downloading.")},updated(){console.log("New content is available; please refresh.")},offline(){console.log("No internet connection found. App is running in offline mode.")},error(t){console.error("Error during service worker registration:",t)}});var Ct=a("8c4f"),xt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"listen-now"},[a("div",{staticClass:"padded"},[a("h2",[t._v(t._s(t.$store.state.homePage.featured.title.replace(/\\/gi,"")))])]),a("item-row",{staticClass:"item-row",attrs:{items:t.$store.state.homePage.featured.playlists,big:""}}),t.$store.state.media.recentlyPlayed.length>0?a("h2",{staticClass:"padded"},[t._v("Recently played")]):t._e(),t.$store.state.media.recentlyPlayed.length>0?a("item-row",{staticClass:"item-row",attrs:{items:t.$store.state.media.recentlyPlayed}}):t._e(),a("h2",{staticClass:"padded"},[t._v("Made for you")]),a("item-row",{staticClass:"item-row",attrs:{items:t.$store.state.homePage.personalized,type:"playlist"}}),a("h2",{staticClass:"padded"},[t._v("New releases")]),a("item-row",{staticClass:"item-row",attrs:{items:t.$store.state.homePage.newReleases,type:"album",rows:2,big:""}})],1)},Lt=[],Pt=a("5c2f"),At=a("a892"),Mt={name:"ListenNow",components:{ItemRow:At["a"],ItemSquare:Pt["a"]},mounted(){this.$store.dispatch("refreshHomePage")}},Ft=Mt,Ot=(a("d24b"),Object(p["a"])(Ft,xt,Lt,!1,null,"277d7cd1",null)),Vt=Ot.exports;i["a"].use(Ct["a"]);const Bt=[{path:"/",name:"Home",component:Vt},{path:"/settings",name:"Settings",component:()=>a.e("chunk-7971da4c").then(a.bind(null,"26d3"))},{path:"/downloads",name:"Downloads",component:()=>a.e("chunk-33d769f7").then(a.bind(null,"9d26e"))},{path:"/browse",name:"Browse",component:()=>a.e("chunk-052550ba").then(a.bind(null,"b210"))},{path:"/album/:name/:id/:trackId?",name:"Album",component:()=>a.e("chunk-2b10b9fa").then(a.bind(null,"ee18"))},{path:"/playlist/:name/:id",name:"Playlist",component:()=>a.e("chunk-e72801d6").then(a.bind(null,"2059"))},{path:"/artist/:name/:id",name:"Artist",component:()=>a.e("chunk-d3bfad98").then(a.bind(null,"6b01"))},{path:"/user/:name/:id",name:"User",component:()=>a.e("chunk-47ded2ce").then(a.bind(null,"1511"))},{path:"/track/:name/:id",name:"Track",component:()=>a.e("chunk-2d0c8407").then(a.bind(null,"53a4"))},{path:"/category/:id",name:"Category",component:()=>a.e("chunk-6ee204f4").then(a.bind(null,"4886"))},{path:"/library",name:"Library",component:()=>a.e("chunk-5490ef49").then(a.bind(null,"55a5"))},{path:"/library/artists",name:"Artists",component:()=>a.e("chunk-434081dc").then(a.bind(null,"b7e4"))},{path:"/library/albums",name:"Albums",component:()=>a.e("chunk-a8214eee").then(a.bind(null,"be55"))},{path:"/library/playlists",name:"Playlists",component:()=>a.e("chunk-06dc3485").then(a.bind(null,"ea2f"))},{path:"/library/tracks",name:"Tracks",component:()=>a.e("chunk-314eefa8").then(a.bind(null,"ac6c"))},{path:"/search",name:"Search",component:()=>a.e("chunk-636f1403").then(a.bind(null,"2d3b"))},{path:"/tune",name:"Tune",component:()=>a.e("chunk-850b013e").then(a.bind(null,"edc3"))},{path:"/radio",name:"Radio",component:()=>a.e("chunk-48812fbb").then(a.bind(null,"b3ad"))},{path:"/nowplaying",name:"NowPlaying",component:()=>a.e("chunk-d70e2628").then(a.bind(null,"185b"))}],Ut=new Ct["a"]({routes:Bt});var Dt=Ut,Et=a("2f62"),jt=a("be8d"),Rt=a.n(jt),qt=a("a123"),Nt=a("ced0"),zt={state:{recentlyPlayed:[],track:null,local:!1,currentTime:0,duration:1,playing:!1,queue:[],shuffledQueue:[],contextItem:null,shuffle:!1,repeat:!0,downloads:[],playAfterLoad:!1,volume:1,trackLoading:!0,shouldDownload:!0,dontOverwriteTrackFromCache:!1,audio:document.createElement("audio"),backupAudio:document.createElement("audio")},mutations:{setMediaStateValue:(t,{key:e,value:a})=>{"track"===e&&t.dontOverwriteTrackFromCache||i["a"].set(t,e,a)},swapAudios:t=>[t.audio,t.backupAudio]=[t.backupAudio,t.audio],local:(t,e)=>t.local=e,trackLoading:(t,e)=>t.trackLoading=e,volume:(t,e)=>t.volume=e,seekTo:(t,e)=>{t.audio.duration&&(t.audio.currentTime=t.audio.duration*e)},duration:(t,e)=>t.duration=e||0,currentTime:(t,e)=>t.currentTime=e||0,playing:(t,e)=>t.playing=e,audioElement:(t,e)=>t.audio=e,addDownload:(t,e)=>{let a=t.downloads.findIndex(t=>t.track.id===e.track.id);-1!==a?t.downloads[a]=e:t.downloads.push(e)},downloadProgress:(t,{track:e,progress:a})=>t.downloads.find(t=>t.track.id===e.id).state=a,removeDownload:(t,e)=>{let a=t.downloads.findIndex(t=>t.track.id===e.id);-1!==a&&t.downloads.splice(a,1)},toggleShuffle:t=>t.shuffle=!t.shuffle,toggleRepeat:t=>t.repeat=!t.repeat,shuffle:(t,e)=>t.shuffle=e,repeat:(t,e)=>t.repeat=e,playAfterLoad:(t,e)=>t.playAfterLoad=e,dontOverwriteTrackFromCache:(t,e)=>t.dontOverwriteTrackFromCache=e,shuffledQueue:t=>t.shuffledQueue=qt["a"].shuffleArray([...t.queue]),queue:(t,e)=>{t.queue=e,t.shuffledQueue=qt["a"].shuffleArray([...e])},track:(t,{track:e,contextItem:a})=>{if(t.track=e,void 0!==a&&(null===t.contextItem||t.contextItem.id!==a.id||t.contextItem.type!==a.type||!t.queue||-1===t.queue.findIndex(t=>t.id===e))){if("radio"!==a.type&&"search"!==a.type){let e=t.recentlyPlayed.findIndex(t=>t.id===a.id);-1!==e&&t.recentlyPlayed.splice(e,1),t.recentlyPlayed.unshift(a),t.recentlyPlayed=t.recentlyPlayed.slice(0,10)}t.queue=a.tracks,t.contextItem=a,t.shuffledQueue=qt["a"].shuffleArray([...t.queue])}},playNext:(t,e)=>{let a=[t.queue,t.shuffledQueue];for(let i of a){let a=i.findIndex(e=>e.id===t.track.id);for(let t of e){let e=i.findIndex(e=>e.id===t.id);e!==a&&(-1!==e&&i.splice(e,1),i.splice(a+1,0,t))}}},addToQueue:(t,e)=>{let a=[t.queue,t.shuffledQueue];for(let i of a){let a=i.findIndex(e=>e.id===t.track.id);for(let t of e){let e=i.findIndex(e=>e.id===t.id);e!==a&&(-1!==e&&i.splice(e,1),i.push(t))}}},removeFromQueue:(t,e)=>{if(e.id===t.track.id)return;let a=t.queue.findIndex(t=>t.id===e.id),i=t.shuffledQueue.findIndex(t=>t.id===e.id);-1!==a&&t.queue.splice(a,1),-1!==i&&t.shuffledQueue.splice(i,1)},clearQueue:t=>{t.queue=[t.track],t.shuffledQueue=[t.track]}},getters:{trackIndex:(t,e)=>e.isTrackSet?e.currentQueue.findIndex(e=>e.id===t.track.id):-1,currentQueue:t=>t.shuffle?t.shuffledQueue:t.queue,isTrackSet:t=>null!==t.track,durationHms:t=>qt["a"].secondsToHms(t.duration),currentTimeHms:t=>qt["a"].secondsToHms(t.currentTime),progress:t=>t.duration?t.currentTime/t.duration:0},actions:{initializeMedia:async({state:t,commit:e,dispatch:a})=>{let i=await Object(Nt["c"])(),s=async t=>{let e=await Object(Nt["b"])(t),a=t.substring("media.".length);return{key:a,value:e}},r=await Promise.all(i.filter(t=>t.startsWith("media.")).map(s));r.forEach(({key:t,value:a})=>e("setMediaStateValue",{key:t,value:a})),t.queue&&e("shuffledQueue"),await a("initAudios")},cacheMedia:async({state:t})=>{let e=["shouldDownload","recentlyPlayed","track","contextItem","shuffle","repeat","volume","queue"];await Promise.all(e.map(e=>Object(Nt["d"])("media."+e,t[e]))),console.log("Media cache complete")},isTrackAvailableOffline:async({rootState:t},e)=>await t.platform.downloader.isTrackOffline(e),removeCached:async({rootState:t,commit:e},a)=>{await t.platform.downloader.removeCached(a)},downloadTrackByUrl:async({rootState:t,state:e,commit:a},{track:i,url:s})=>{if(!e.shouldDownload)return;let r=new AbortController;a("addDownload",{track:i,state:"Preparing",abortController:r}),await t.platform.downloader.downloadTrack(s,i,t=>a("downloadProgress",{track:i,progress:t}),r.signal)},getTrackUrls({rootState:t},e){return t.platform.downloader.getTrackUrls(e)},async setTrack({dispatch:t,state:e,commit:a},i){a("local",!1),t("setMetadata",i),a("trackLoading",!0),a("currentTime",0),await t("pause");for await(let{url:s,local:r}of await t("getTrackUrls",i)){if(e.track.id!==i.id)return;a("local",r);let o=await t("setTrackUrl",s);if(o)return a("trackLoading",!1),void(r||await t("downloadTrackByUrl",{track:i,url:s}));r&&await t("removeCached",i)}console.warn("Failed to load track, skipping"),await t("skip",1)},initAudios({state:t,commit:e,dispatch:a}){for(let i of[t.audio,t.backupAudio])i.onloadedmetadata=()=>{i===t.audio&&e("duration",i.duration)},i.onended=()=>{i===t.audio&&a("skip",1)},i.onplay=()=>{i===t.audio&&(navigator.mediaSession&&(navigator.mediaSession.playbackState="playing"),a("setPlatformPlaying",!0),e("playing",!0))},i.onpause=()=>{i===t.audio&&(navigator.mediaSession&&(navigator.mediaSession.playbackState="paused"),a("setPlatformPlaying",!1),e("playing",!1))}},async setTrackUrl({dispatch:t,state:e,commit:a},i){return new Promise((t,s)=>{let r=e.playAfterLoad;a("playAfterLoad",!1),console.log("🎵 Now playing 🎵",i),a("swapAudios"),e.backupAudio.pause(),e.audio.src=i,r&&e.audio.play();let o=setTimeout(()=>{console.warn("Can't play"),t(!1)},3500),n=!1;e.backupAudio.oncanplay=()=>0,e.backupAudio.onerror=()=>0,e.audio.onerror=async()=>{clearTimeout(o),t(!1)},e.audio.oncanplay=async()=>{n||(n=!0,clearTimeout(o),t(!0))}})},async play({state:t}){t.audio.paused&&await t.audio.play()},async pause({state:t}){t.audio.paused||await t.audio.pause()},async skip({state:t,getters:e,commit:a,dispatch:i},s){if(-1===s&&t.currentTime>5)return void(t.audio.currentTime=0);let r=e.trackIndex+s;if(r>=t.queue.length){if(!t.repeat)return await i("pause");r-=t.queue.length}if(r<0){if(!t.repeat)return await i("pause");r+=t.queue.length}a("playAfterLoad",!0),a("track",{track:e.currentQueue[r]})},setMetadata({dispatch:t,getters:e,state:a,commit:i},s){let r=s.artists.map(t=>t.name).join(", ");if(document.title="Vue Music • "+s.name+" - "+r,!("mediaSession"in navigator))return;let o=[{src:e.notFoundImage,type:"image/png",sizes:"512x512"}];s.album.images.length>0&&(o=s.album.images.map(t=>({src:t.url,type:"image/png",sizes:`${t.width}x${t.height}`}))),navigator.mediaSession.metadata=new MediaMetadata({title:s.name,artist:r,album:s.album.name,artwork:o}),navigator.mediaSession.setActionHandler("previoustrack",()=>{t("skip",-1)}),navigator.mediaSession.setActionHandler("nexttrack",()=>{t("skip",1)});let n=10;navigator.mediaSession.setActionHandler("seekbackward",t=>{const e=t.seekOffset||n;a.audio.currentTime=Math.max(a.audio.currentTime-e,0)}),navigator.mediaSession.setActionHandler("seekforward",t=>{const e=t.seekOffset||n;a.audio.currentTime=Math.min(a.audio.currentTime+e,a.audio.duration)}),navigator.mediaSession.setActionHandler("play",()=>{t("play")}),navigator.mediaSession.setActionHandler("pause",()=>{t("pause")});try{navigator.mediaSession.setActionHandler("stop",()=>{t("pause")})}catch(l){console.warn('Warning! The "stop" media session action is not supported.')}try{navigator.mediaSession.setActionHandler("seekto",t=>{i("seekTo",t.seekTime/a.duration)})}catch(l){console.warn('Warning! The "seekto" media session action is not supported.')}},playItem:async({state:t,commit:e,dispatch:a},{item:i,shuffle:s=!1})=>{let r,o=await a("getContextItem",i);if(!o.tracks||0===o.tracks.length)return a("addSnack",{text:"This item has no tracks"});r=s?o.tracks[Math.floor(Math.random()*o.tracks.length)]:o.tracks[0],"track"===i.type&&console.warn("Setting track item as context item, this should probably not happen"),e("playAfterLoad",!0),e("track",{contextItem:o,track:r}),e("shuffle",s)}}},Wt={state:{liveTerm:"",term:"",results:{},recent:null===localStorage.getItem("recentSearch")?[]:JSON.parse(localStorage.recentSearch)},mutations:{searchTerm:(t,e)=>{t.term=e.term,t.recent.includes(t.term)&&t.recent.splice(t.recent.indexOf(t.term),1),t.recent=[t.term,...t.recent.slice(0,5)],localStorage.recentSearch=JSON.stringify(t.recent),i["a"].set(t.results,e.term,e)},liveTerm:(t,e)=>t.liveTerm=e},getters:{},actions:{search:async({state:t,commit:e,rootState:a},i)=>{let s=await a.api.search(i,["album","artist","playlist","track"]);e("searchTerm",{term:i,albums:s.albums.items,artists:s.artists.items,playlists:s.playlists.items,tracks:s.tracks.items})}}},Ht=a("f309");i["a"].use(Ht["a"]);var Qt=new Ht["a"]({theme:{dark:"true"===localStorage.darkTheme,themes:{dark:{primary:"#ef2d46",foreground:"#ffffff",primarySeek:"#c9c9c9",navBackground:"#1b1b1c",primaryLight:"#2a2a2b",secondary:"#de901a"},light:{primary:"#e7474c",foreground:"#1a1a1a",primarySeek:"#e7474c",navBackground:"#ffffff",primaryLight:"#f1efef",secondary:"#ffcf84"}}}}),Kt={state:{original:JSON.parse(JSON.stringify(Qt.userPreset.theme)),color:null,fgLegible:!0},mutations:{color:(t,e)=>t.color=e,fgLegible:(t,e)=>t.fgLegible=e},getters:{currentTheme:()=>Qt.framework.theme},actions:{async setThemeToItem({getters:t,dispatch:e,state:a},i){console.log("getter",t.currentTheme,"original",a.original);let s=t.itemImage(i),r=await e("getImageColor",s);await e("applyThemeColor",r)},async applyThemeColor({commit:t,state:e,dispatch:a,getters:i},s){if(null===s||void 0===s)return await a("revertThemeColor");console.log("Apply",s),t("color",s);let{bgLegible:r,fgLegible:o}=qt["a"].isLegible(s,i.currentTheme);if(!r)return await a("revertThemeColor");console.log("Applying theme color 🎨",s),t("fgLegible",o),i.currentTheme.isDark?i.currentTheme.themes.dark.primary=s:(i.currentTheme.themes.light.primary=s,i.currentTheme.themes.light.primarySeek=s)},revertThemeColor({commit:t,getters:e,state:a}){t("fgLegible",!0),e.currentTheme.isDark?e.currentTheme.themes.dark.primary=a.original.themes.dark.primary:(e.currentTheme.themes.light.primary=a.original.themes.light.primary,e.currentTheme.themes.light.primarySeek=a.original.themes.light.primarySeek)},async leavePage({commit:t,dispatch:e}){t("color",null),await e("revertThemeColor")},async getImageColor({dispatch:t},e){return new Promise(a=>{let i=document.createElement("img");i.crossOrigin="anonymous",i.src=e;let s=document.createElement("canvas"),r=s.getContext("2d");i.onload=async()=>{let e=20,o=20;s.width=e,s.height=o,r.drawImage(i,0,0,e,o);let n={},l=r.getImageData(0,0,e,o);for(let a=0;a<l.data.length;a+=4){let e=l.data.slice(a,a+3),i=e.map(t=>Math.floor(t/20)),[s,r,o]=await t("rgbToHsl",i),c=i.join(",");void 0===n[c]&&(n[c]={n:0,color:e}),n[c].n+=1+r*(1-Math.abs(.5-o))*255}let c=Object.values(n);const d=c.map(t=>t.n).reduce((t,e,a,i)=>e>i[t]?a:t,0);let[u,m,h]=c[d].color,p=t=>t.toString(16).padStart(2,"0");a("#"+p(u)+p(m)+p(h))}})},rgbToHsl({},t){let[e,a,i]=t;e/=255,a/=255,i/=255;let s,r,o=Math.max(e,a,i),n=Math.min(e,a,i),l=(o+n)/2;if(o===n)s=r=0;else{let t=o-n;switch(r=l>.5?t/(2-o-n):t/(o+n),o){case e:s=(a-i)/t+(a<i?6:0);break;case a:s=(i-e)/t+2;break;case i:s=(e-a)/t+4;break}s/=6}return[s,r,l]}}},Yt=a("faa1"),Gt=a.n(Yt);let Jt=window&&void 0!==window.process&&void 0!==window.process.type;console.log("is electron?",Jt);const Xt=a(Jt?"bf8a":"e51b").default;if(0===document.querySelectorAll("head link[rel='manifest']").length){let t=document.createElement("link");t.setAttribute("rel","manifest"),t.setAttribute("href","./manifest.json"),document.querySelector("head").appendChild(t)}i["a"].use(Et["a"]);var Zt=new Et["a"].Store({state:{keys:{spotifyId:"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa",spotifySecret:"bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb",youtube:"cccccccccccc-dddddddddddddddddddddddddd"},requestedScopes:"ugc-image-upload user-read-email user-read-private playlist-read-collaborative playlist-modify-public playlist-read-private playlist-modify-private user-library-modify user-library-read user-top-read user-read-recently-played user-follow-read user-follow-modify",authUrl:"https://accounts.spotify.com/",isTouch:qt["a"].isTouchDevice(),dontCache:!1,events:new Gt.a,windowWidth:window.innerWidth,timeout:-1,snackbars:[],api:new Rt.a,isRefreshing:{playlist:!1,album:!1,artist:!1,track:!1},auth:{code:null,token:null,refresh:null,expiryDate:null},homePage:{featured:{title:"",playlists:[]},newReleases:[],personalized:[]},browse:{categories:[],genres:[]},userInfo:{id:"",name:"",mail:"",country:"",followers:0,avatar:"img/no-user.jpg"},library:{playlists:[],artists:[],albums:[],tracks:[]},playlist:{},album:{},artist:{},category:{},user:{}},mutations:{setStateValue:(t,{key:e,value:a})=>i["a"].set(t,e,a),spotifyId:(t,e)=>{t.keys.spotifyId=e},spotifySecret:(t,e)=>{t.keys.spotifySecret=e},youtubeKey:(t,e)=>{t.keys.youtube=e,t.platform.downloader.apiKey=e},dontCache:t=>t.dontCache=!0,addSnackObject:(t,e)=>t.snackbars.push(e),removeSnack:(t,e)=>t.snackbars.splice(t.snackbars.indexOf(e),1),loadCategory:(t,{id:e,category:a})=>i["a"].set(t.category,e,a),extendCategory:(t,{id:e,playlists:a})=>t.category[e].playlists.push(...a),loadPlaylist:(t,{id:e,playlist:a})=>i["a"].set(t.playlist,e,a),extendPlaylist:(t,{id:e,tracks:a})=>t.playlist[e].tracks.push(...a),loadAlbum:(t,{id:e,album:a})=>i["a"].set(t.album,e,a),extendAlbum:(t,{id:e,tracks:a})=>t.album[e].tracks.push(...a),loadInitialArtist:(t,{id:e,artist:a})=>i["a"].set(t.artist,e,{artist:a,related:[],tracks:[],albums:{}}),loadArtist:(t,{id:e,artist:a})=>t.artist[e].artist=a,loadArtistRelated:(t,{id:e,related:a})=>t.artist[e].related=a,loadArtistTracks:(t,{id:e,tracks:a})=>t.artist[e].tracks=a,loadArtistAlbums:(t,{id:e,albums:a})=>t.artist[e].albums=a,loadUser:(t,{id:e,user:a})=>i["a"].set(t.user,e,a),extendUser:(t,{id:e,playlists:a})=>t.user[e].playlists.push(...a),browseCategories:(t,e)=>t.browse.categories=e,browseGenres:(t,e)=>t.browse.genres=e,homeFeatured:(t,e)=>t.homePage.featured=e,homeRecent:(t,e)=>t.homePage.recent=e,homeNew:(t,e)=>t.homePage.newReleases=e,homePersonalized:(t,e)=>t.homePage.personalized=e,isRefreshing:(t,{type:e,value:a})=>t.isRefreshing[e]=a,addUserPlaylist:(t,e)=>t.library.playlists.push(e),userPlaylists:(t,e)=>t.library.playlists=e,addToLibrary:(t,{type:e,item:a,addAtStart:i=!1})=>t.library[e+"s"][i?"unshift":"push"](a),removeFromLibrary:(t,{type:e,id:a})=>{let i=t.library[e+"s"].findIndex(t=>t.id===a);-1!==i&&t.library[e+"s"].splice(i,1)},setLibrary:(t,{type:e,items:a})=>t.library[e+"s"]=a,userInfo:(t,e)=>t.userInfo=e,timeout:(t,e)=>t.timeout=e,windowWidth:(t,e)=>t.windowWidth=e,server:(t,e)=>t.server=e,auth:(t,e)=>t.auth=e},getters:{isValidKeySet:()=>({spotifyId:t,spotifySecret:e,youtube:a})=>"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"!==t&&"bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb"!==e&&"cccccccccccc-dddddddddddddddddddddddddd"!==a&&32===t.length&&32===e.length&&39===a.length,isKeySet:(t,e)=>e.isValidKeySet({...t.keys}),notFoundUser:()=>{let t=Math.floor(7*Math.random())+1;return`img/user/${t}.png`},notFoundImage:()=>{let t=Math.floor(7*Math.random())+1;return`img/notfound/${t}.png`},likedImage:()=>{let t=Math.floor(7*Math.random())+1;return`img/liked/${t}.png`},itemImage:(t,e)=>t=>{if(!t)return e.notFoundImage;let a=t.type||"category";return"category"===a?t.icons.length>0?t.icons[0].url:e.notFoundImage:"track"===a?t.album&&t.album.images&&t.album.images.length>0?t.album.images[0].url:e.notFoundImage:"search"===a?(console.warn("Tried getting image for search"),""):"radio"===a?(console.warn("Tried getting image for radio"),""):"liked"===a?e.likedImage:t.images.length>0?t.images[0].url:"user"===a?e.notFoundUser:e.notFoundImage},isLoggedIn:t=>null!==t.auth.code&&null!==t.auth.token&&null!==t.auth.refresh&&null!==t.auth.expiryDate,isAuthExpired:(t,e)=>e.isLoggedIn?new Date>t.auth.expiryDate:(console.warn("Auth expiry check warning: User is not logged in"),!0),urlName:()=>t=>encodeURIComponent(t.toLowerCase().replace(/ /gi,"-").slice(0,36)),relativeItemUrl:(t,e)=>t=>{let a=t.type||"category",i="user"===a?t.display_name:t.name;return"category"===a?`${a}/${t.id}`:"radio"===a?null:"search"===a?t.to:"liked"===a?"/library/tracks":`/${a}/${e.urlName(i)}/${t.id}`},shareUrl:(t,e)=>a=>{let i="web"===t.platform.type?`${location.origin}${location.pathname}`:"https://ruurd.dev/vuemusic/";return`${i}#${e.relativeItemUrl(a)}`},spotifyShareUrl:(t,e)=>t=>{let e=t.type||"category",a="https://open.spotify.com/";return`${a}${e}/${t.id}`},isArtistFollowed:t=>e=>t.library.artists.find(t=>t.id===e.id),isTrackFollowed:t=>e=>t.library.tracks.find(t=>t.id===e.id),isPlaylistFollowed:t=>e=>t.library.playlists.find(t=>t.id===e.id),isAlbumFollowed:t=>e=>t.library.albums.find(t=>t.id===e.id)},actions:{initialize:async({commit:t,state:e,dispatch:a})=>{let i=await Object(Nt["c"])(),s=async t=>{let e=await Object(Nt["b"])(t),a=t.substring("state.".length);return{key:a,value:e}},r=await Promise.all(i.filter(t=>t.startsWith("state.")).map(s));r.forEach(({key:e,value:a})=>t("setStateValue",{key:e,value:a})),e.platform.downloader.apiKey=e.keys.youtube,await a("processAuth"),await a("initializeMedia"),await a("initializePlatform")},cacheAll:async({commit:t,dispatch:e})=>{await Promise.all([e("cacheState"),e("cacheMedia")])},cacheState:async({state:t})=>{let e=["auth","homePage","browse","userInfo","library","playlist","album","artist","category","user","keys"];await Promise.all(e.map(e=>Object(Nt["d"])("state."+e,t[e]))),console.log("State cache complete")},clearCache:async({state:t,commit:e})=>{e("dontCache"),localStorage.clear(),await Object(Nt["a"])(),location.reload()},getAuthByRefreshToken:async({state:t},e)=>{console.log("Refresh using refreshToken",e);let a=await(await fetch("https://accounts.spotify.com/api/token",{method:"post",body:`grant_type=refresh_token&refresh_token=${e}&client_id=${t.keys.spotifyId}&client_secret=${t.keys.spotifySecret}`,headers:{"Content-Type":"application/x-www-form-urlencoded"}})).text();try{return JSON.parse(a)}catch(i){console.log("Error",i.message,"result = ",a)}},getAuthByCode:async({state:t},{redirectUrl:e,code:a})=>{console.log("Getting auth using code",{redirectUrl:e,code:a});let i=await(await fetch(t.authUrl+"api/token",{method:"post",body:`grant_type=authorization_code&code=${a}&redirect_uri=${e}&client_id=${t.keys.spotifyId}&client_secret=${t.keys.spotifySecret}`,headers:{"Content-Type":"application/x-www-form-urlencoded"}})).text();try{return console.log(i),JSON.parse(i)}catch(s){console.log("Error",s.message,"t = ",i)}},spotifyLogin:async({dispatch:t,commit:e})=>{let a=await t("firstLogin");console.log("Auth result from 'firstLogin'",a),e("auth",a),await t("cacheState"),await t("processAuth")},loginByRefreshToken:async({state:t,dispatch:e,commit:a})=>{if(!t.auth.refresh)return void console.warn("Couldn't get new token, refresh token isn't set",t.auth);let{access_token:i,expires_in:s}=await e("getAuthByRefreshToken",t.auth.refresh),r={...t.auth};r.token=i,r.expiryDate=+new Date+1e3*s,a("auth",r),await e("cacheState"),await e("processAuth")},spotifyLogout:async({state:t,commit:e,dispatch:a})=>{e("auth",{code:null,token:null,refresh:null,expiryDate:null}),e("userInfo",{id:"",name:"",mail:"",country:"",followers:0,avatar:"img/no-user.jpg"}),await a("cacheState"),clearTimeout(t.timeout)},addSnack:async({state:t,commit:e},{text:a,timeout:i=3e3})=>{let s={text:a,open:!0,timeout:i};return e("addSnackObject",s),new Promise(t=>{setTimeout(()=>{e("removeSnack",s),t()},i+500)})},share:async({dispatch:t,getters:e},{item:a,copy:i,urlType:s="vuemusic"})=>{let r="spotify"===s?e.spotifyShareUrl(a):e.shareUrl(a);if(navigator.share instanceof Function){let t=null===a.type||void 0===a.type?"category":a.type;try{await navigator.share({title:t.substr(0,1).toUpperCase()+t.substr(1),text:null===a.name||void 0===a.name?a.display_name:a.name,url:r})}catch(o){console.warn(o)}}else await i(r),await t("addSnack",{text:"Share URL copied to clipboard!"})},processAuth:async({dispatch:t,commit:e,state:a})=>{let i=new Date;if(a.auth.expiryDate>i){a.api.setAccessToken(a.auth.token),a.events.emit("accessToken");let s=a.auth.expiryDate-i;await t("initializeSpotify"),e("timeout",setTimeout(async()=>{await t("loginByRefreshToken")},s-3e5))}else console.warn("Auth has expired, getting new token"),await t("loginByRefreshToken")},waitFor:async({state:t},e)=>new Promise(a=>{t.events.on(e,a)}),awaitAuth:async({dispatch:t,commit:e,state:a})=>{if(null===a.api.getAccessToken())return await t("waitFor","accessToken")},findPagination:({},t)=>{if(null===t)return!1;let e;e=({keys:t=[],o:a})=>{if(null!==a&&a.hasOwnProperty("next")&&a.hasOwnProperty("items"))return[!0,t];if("object"!==typeof a||null===a)return[!1,t.slice(0,-1)];for(let i in a){if(!a.hasOwnProperty(i))continue;let s;if([s,t]=e({keys:t.concat(i),o:a[i]}),s)return[!0,t]}return[!1,t.slice(0,-1)]};let[a,i]=e({o:t});return!!a&&(t=>{for(let e of i)t=t[e];return t})},async*retrieveSpotifyArray({state:t,dispatch:e},a){let i=()=>a();while(1){let a=await i(),s=await e("findPagination",a);if(null!==a&&(yield a),null===a||!1===s||null===s(a).next)break;let r=s(a).next;void 0===r&&console.warn("next url is undefined"),i=()=>t.api.getGeneric(r)}},initializeSpotify:async({state:t,commit:e,dispatch:a})=>{await a("refreshUserInfo");let i=0,s=0!==t.library.tracks.length,r=async()=>{i++,i===(s?3:4)&&await a("cacheState")};a("refreshUserData").then(r),a("refreshUserData","artist").then(r),a("refreshUserData","album").then(r),s||a("refreshUserData","track").then(r)},refreshUserInfo:async({commit:t,state:e,getters:a})=>{let i=await e.api.getMe();t("userInfo",{id:i.id,name:i.display_name,mail:i.email,country:i.country,followers:i.followers,avatar:0===i.images.length?a.notFoundUser:i.images[0].url})},refreshUserData:async({commit:t,state:e,dispatch:a},i="playlist")=>{if(["playlist","album","track","artist"].includes(i)||console.warn("Wrong type set for refreshUserData!"),e.isRefreshing[i])return console.info("This library type is already refreshing, waiting for that to finish"),void await a("waitFor","refreshed"+i);await a("awaitAuth"),t("isRefreshing",{type:i,value:!0});let s=0===e.library[i+"s"].length;""===e.userInfo.id&&await a("refreshUserInfo");let r,o=t=>t;switch(i){case"playlist":r=()=>e.api.getUserPlaylists(e.userInfo.id,{limit:50});break;case"album":r=()=>e.api.getMySavedAlbums();break;case"artist":r=()=>e.api.getFollowedArtists(),o=t=>t.artists;break;case"track":r=()=>e.api.getMySavedTracks({limit:50});break}let n=[],l=e=>{s?t("addToLibrary",{type:i,item:e}):n.push(e)};for await(let c of await a("retrieveSpotifyArray",r))for(let t of o(c).items)l("track"===i?t.track:"album"===i?t.album:t);s||t("setLibrary",{type:i,items:n}),e.events.emit("refreshed"+i),t("isRefreshing",{type:i,value:!1})},refreshHomePage:async({commit:t,state:e,dispatch:a})=>{await a("awaitAuth");let i,s=await e.api.getFeaturedPlaylists({limit:50});t("homeFeatured",{title:s.message,playlists:s.playlists.items}),0===e.library.playlists.length&&await a("refreshUserData");const r=["Discover Weekly","Release Radar",...[...Array(10)].map((t,e)=>"Daily Mix "+(e+1))];i=e.library.playlists.filter(t=>-1!==r.findIndex(e=>t.name.includes(e))&&"Spotify"===t.owner.display_name),i.sort((t,e)=>{let a=r.findIndex(e=>t.name.includes(e)),i=r.findIndex(t=>e.name.includes(t));return a-i}),i.length>0&&t("homePersonalized",i);let o=await e.api.getNewReleases({limit:50});t("homeNew",o.albums.items),null!==localStorage.getItem("recentlyPlayed")&&t("homeRecent",JSON.parse(localStorage.recentlyPlayed))},refreshBrowsePage:async({dispatch:t,commit:e,state:a})=>{await t("awaitAuth"),a.api.getCategories({limit:50}).then(t=>e("browseCategories",t.categories.items)),a.api.getAvailableGenreSeeds().then(t=>{e("browseGenres",t.genres.map(t=>t.split("-").map(t=>t.substr(0,1).toUpperCase()+t.substr(1)).join(" ")))})},loadPlaylist:async({dispatch:t,commit:e,state:a},i)=>{await t("awaitAuth");let s=()=>a.api.getPlaylist(i);for await(let r of await t("retrieveSpotifyArray",s))r.items?e("extendPlaylist",{id:i,tracks:r.items.map(t=>t.track).filter(t=>null!==t)}):e("loadPlaylist",{id:i,playlist:{...r,tracks:r.tracks.items.map(t=>t.track).filter(t=>null!==t)}})},loadAlbum:async({dispatch:t,commit:e,state:a},i)=>{await t("awaitAuth");let s=()=>a.api.getAlbum(i);for await(let r of await t("retrieveSpotifyArray",s))if(r.items)r.items.forEach(t=>t.album={images:a.album[i].images,name:a.album[i].name,id:a.album[i].id}),e("extendAlbum",{id:i,tracks:r.items});else{let t={...r};t.tracks=t.tracks.items,t.tracks.forEach(e=>e.album={images:t.images,name:t.name,id:t.id}),e("loadAlbum",{id:i,album:t})}},loadCategory:async({state:t,commit:e,dispatch:a},i)=>{if(await a("awaitAuth"),!t.category.hasOwnProperty(i)){let a={playlists:[],...await t.api.getCategory(i)};e("loadCategory",{id:i,category:a})}let s=()=>t.api.getCategoryPlaylists(i);for await(let r of await a("retrieveSpotifyArray",s))r.playlists?e("extendCategory",{id:i,playlists:r.playlists.items}):e("extendCategory",{id:i,playlists:r.items})},loadArtist:async({dispatch:t,commit:e,state:a},i)=>{await t("awaitAuth");let s=!a.artist.hasOwnProperty(i),r=await a.api.getArtist(i);e(s?"loadInitialArtist":"loadArtist",{id:i,artist:r}),a.api.getArtistRelatedArtists(i).then(t=>{e("loadArtistRelated",{id:i,related:t.artists})}),a.api.getArtistTopTracks(i,"from_token").then(t=>{e("loadArtistTracks",{id:i,tracks:t.tracks})});let o=()=>a.api.getArtistAlbums(i),n=[];for await(let l of await t("retrieveSpotifyArray",o))n.push(...l.items);e("loadArtistAlbums",{id:i,albums:n})},loadUser:async({dispatch:t,commit:e,state:a},i)=>{await t("awaitAuth");let s=void 0===a.user[i],r=await a.api.getUser(i);s&&e("loadUser",{id:i,user:{...r,playlists:[]}});let o=(await a.api.getUserPlaylists(i,{limit:50})).items;s?e("extendUser",{id:i,playlists:o}):e("loadUser",{id:i,user:{...r,playlists:o}})},loadTrack:async({state:t,dispatch:e},a)=>(await e("awaitAuth"),await t.api.getTrack(a)),followPlaylist:async({state:t,dispatch:e},a)=>{await t.api.followPlaylist(a.id),await e("refreshUserData","playlist")},unfollowPlaylist:async({state:t,dispatch:e},a)=>{await t.api.unfollowPlaylist(a.id),await e("refreshUserData","playlist"),await e("loadUser",t.userInfo.id)},followArtist:async({state:t,dispatch:e},a)=>{await t.api.followArtists([a.id]),await e("refreshUserData","artist")},unfollowArtist:async({state:t,dispatch:e},a)=>{await t.api.unfollowArtists([a.id]),await e("refreshUserData","artist")},followAlbum:async({state:t,dispatch:e},a)=>{await t.api.addToMySavedAlbums([a.id]),await e("refreshUserData","album")},unfollowAlbum:async({state:t,dispatch:e},a)=>{await t.api.removeFromMySavedAlbums([a.id]),await e("refreshUserData","album")},toggleFollowCurrentTrack:async({state:t,dispatch:e})=>{let a=t.media.track;if(null===a)return;let[i]=await t.api.containsMySavedTracks([a.id]);return i?await e("unfollowTrack",a):await e("followTrack",a),!i},followTrack:async({state:t,dispatch:e,commit:a},i)=>{await t.api.addToMySavedTracks([i.id]),a("addToLibrary",{type:"track",item:i,addAtStart:!0})},unfollowTrack:async({state:t,dispatch:e,commit:a},i)=>{await t.api.removeFromMySavedTracks([i.id]),a("removeFromLibrary",{type:"track",id:i.id})},addToPlaylist:async({state:t,dispatch:e},{track:a,playlist:i})=>{await e("loadPlaylist",i.id);let s=t.playlist[i.id].tracks;if(-1===s.findIndex(t=>t.id===a.id))try{await t.api.addTracksToPlaylist(i.id,[a.uri]),await e("loadPlaylist",i.id),e("addSnack",{text:"Added to playlist!"}).then()}catch(r){console.warn(r),e("addSnack",{text:"Could not add track to this playlist"}).then()}else e("addSnack",{text:"Track is already in playlist"}).then()},removeFromPlaylist:async({state:t,dispatch:e},{track:a,playlist:i})=>{try{await t.api.removeTracksFromPlaylist(i.id,[a.uri]),await e("loadPlaylist",i.id)}catch(s){console.warn(s),e("addSnack",{text:"Could not remove track from this playlist"}).then()}},createPlaylist:async({state:t,dispatch:e,commit:a},i)=>{let s=await t.api.createPlaylist(t.userInfo.id,{name:i});return await e("loadPlaylist",s.id),await e("refreshUserData","playlist"),t.playlist[s.id]},getRadioTracks:async({state:t,dispatch:e},a)=>{let i=null,s=Object.keys(a);if(1===s.length&&"seed_tracks"===s[0]){let t=a["seed_tracks"].split(",");1===t.length&&(i=await e("loadTrack",t[0]))}a.limit=i?99:100;let r=(await t.api.getRecommendations(a)).tracks;return i?[i,...r]:r},getItem:async({state:t,dispatch:e},a)=>{let i=a.type||"category";return a.tracks&&a.tracks.length>0?a:(t[i][a.id]||await e("load"+i[0].toUpperCase()+i.slice(1),a.id),t[i][a.id])},getContextItem:async({state:t,dispatch:e},a)=>{if("track"===a.type)return{...a,tracks:[a]};if(a.tracks&&a.tracks.length>0)return a;let i=await e("getItem",a),s=a.type||"category";if("category"===s){let t=i.playlists[Math.floor(Math.random()*i.playlists.length)];return await e("getContextItem",t)}return"artist"===s?{...i.artist,tracks:i.tracks}:i}},modules:{platform:Xt,media:zt,search:Wt,theme:Kt}}),te=a("a4a1"),ee=a.n(te),ae=(a("f6b9"),a("e508")),ie=(a("a899"),a("4eb5")),se=a.n(ie);i["a"].use(ee.a),i["a"].component("RecycleScroller",ae["a"]),i["a"].use(se.a),i["a"].config.productionTip=!1,new i["a"]({router:Dt,store:Zt,vuetify:Qt,render:t=>t(St)}).$mount("#app")},"58f3":function(t,e,a){"use strict";a("15a8")},"5c2f":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-lazy",{staticClass:"item-square",attrs:{width:t.big?240:t.small?80:180,"min-height":t.big?240:t.small?80:180}},[a("router-link",{attrs:{tag:"span",to:t.$store.getters.relativeItemUrl(t.item)}},[a("div",{staticClass:"image",class:{big:t.big,small:t.small},style:{backgroundImage:"url("+t.$store.getters.itemImage(t.item)+")",borderRadius:"artist"===t.type?"50%":"5px"}}),a("div",{staticClass:"play-button",class:{big:t.big,small:t.small},style:{borderRadius:"artist"===t.type?"50%":"5px"}},[t.itemIsPlaying||t.$store.state.isTouch?t.$store.state.isTouch?t._e():a("v-btn",{attrs:{loading:t.playLoading,fab:"",small:"",color:"primary"},on:{click:t.pause}},[a("v-icon",{attrs:{color:"white"}},[t._v("mdi-pause")])],1):a("v-btn",{attrs:{loading:t.playLoading,fab:"",small:"",color:"primary"},on:{click:t.play}},[a("v-icon",{attrs:{color:"white"}},[t._v("mdi-play")])],1),t.hideMenu||t.$store.state.isTouch?t._e():a("item-menu",{attrs:{color:"artist"===t.type?"default":"white",fab:"artist"===t.type,item:t.item}})],1),t.noTitle?t._e():a("div",{staticClass:"text",class:{big:t.big,small:t.small},style:{textAlign:"artist"===t.type?"center":"left"}},[a("p",{staticClass:"preview-title"},[t._v(t._s(t.item.name))]),t.item.hasOwnProperty("description")?a("p",{staticClass:"preview-description",attrs:{title:t.item.description},domProps:{innerHTML:t._s(t.item.description)}}):t._e(),t.showYear?a("p",{staticClass:"preview-year"},[t._v(t._s(new Date(t.item.release_date).getFullYear()))]):t._e()])])],1)},s=[],r=a("5dd2"),o=a("190f"),n=a("9bcd"),l={name:"ItemSquare",components:{ItemMenu:n["a"],FollowMenuItem:o["a"],ShareMenuItem:r["a"]},props:{big:{type:Boolean,default:!1},small:{type:Boolean,default:!1},item:{type:Object,default:null},showYear:{type:Boolean,default:!1},noTitle:{type:Boolean,default:!1},hideMenu:{type:Boolean,default:!1}},data:()=>({playLoading:!1}),methods:{async pause(t){t.stopPropagation(),await this.$store.dispatch("pause")},async play(t){if(t.stopPropagation(),this.itemIsLoaded)return await this.$store.dispatch("play");this.playLoading=!0,await this.$store.dispatch("playItem",{item:this.item}),this.playLoading=!1}},computed:{itemIsLoaded(){if(!this.$store.getters.isTrackSet)return!1;let t=this.$store.state.media.contextItem;return t.type===this.item.type&&t.id===this.item.id},itemIsPlaying(){return!!this.itemIsLoaded&&(!!this.$store.state.media.playing||void 0)},type(){return this.item.type?this.item.type:"category"}}},c=l,d=(a("986f"),a("2877")),u=a("6544"),m=a.n(u),h=a("8336"),p=a("132d"),f=a("b687"),y=Object(d["a"])(c,i,s,!1,null,"3a24db36",null);e["a"]=y.exports;m()(y,{VBtn:h["a"],VIcon:p["a"],VLazy:f["a"]})},"5dd2":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-menu",{attrs:{"offset-y":""},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on,s=e.attrs;return[a("v-list-item",t._g(t._b({},"v-list-item",s,!1),i),[a("v-list-item-icon",[a("v-icon",[t._v("mdi-share")])],1),a("v-list-item-title",[t._v("Share")])],1)]}}])},[a("v-list",[a("v-list-item",{on:{click:t.share}},[a("v-list-item-icon",[t.loading?a("v-progress-circular",{attrs:{size:"20",indeterminate:"",width:"1"}}):a("v-icon",[t._v("mdi-share")])],1),a("v-list-item-title",[t._v("Share Vue Music link")])],1),void 0!==t.item.type&&"category"!==t.item.type?a("v-list-item",{on:{click:t.shareSpotify}},[a("v-list-item-icon",[t.loadingSpotify?a("v-progress-circular",{attrs:{size:"20",indeterminate:"",width:"1"}}):a("v-icon",[t._v("mdi-spotify")])],1),a("v-list-item-title",[t._v("Share Spotify™ link")])],1):t._e()],1)],1)},s=[],r={name:"ShareMenuItem",props:{item:{type:Object,default:null}},data:()=>({loading:!1,loadingSpotify:!1}),methods:{async share(){this.$emit("action"),this.loading=!0,await this.$store.dispatch("share",{item:this.item,copy:this.$copyText}),this.loading=!1},async shareSpotify(){this.$emit("action"),this.loadingSpotify=!0,await this.$store.dispatch("share",{item:this.item,copy:this.$copyText,urlType:"spotify"}),this.loadingSpotify=!1}}},o=r,n=a("2877"),l=a("6544"),c=a.n(l),d=a("132d"),u=a("8860"),m=a("da13"),h=a("34c3"),p=a("5d23"),f=a("e449"),y=a("490a"),g=Object(n["a"])(o,i,s,!1,null,"b3c8ae50",null);e["a"]=g.exports;c()(g,{VIcon:d["a"],VList:u["a"],VListItem:m["a"],VListItemIcon:h["a"],VListItemTitle:p["c"],VMenu:f["a"],VProgressCircular:y["a"]})},6:function(t,e){},"63da":function(t,e,a){},"644f":function(t,e,a){"use strict";a("6af0")},"6af0":function(t,e,a){},"6e9c":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.$store.getters.isTrackSet?a("div",{staticClass:"controls",class:t.large?"large":"",style:{minWidth:t.full?"156px":"96px"}},[t.full?a("v-btn",{attrs:{color:t.$store.state.media.shuffle?"primary":"default",icon:"",small:!t.large},on:{click:function(e){return t.$store.commit("toggleShuffle")}}},[a("v-icon",{attrs:{small:!t.large}},[t._v("mdi-shuffle")])],1):t._e(),a("v-btn",{attrs:{icon:"",small:!t.large,large:t.large},on:{click:function(e){return t.$store.dispatch("skip",-1)}}},[a("v-icon",[t._v("mdi-rewind")])],1),a("v-btn",{attrs:{loading:t.$store.state.media.trackLoading,icon:!t.large,fab:t.large,color:t.large&&t.$store.state.theme.fgLegible?"primary":"default",large:""},on:{click:function(e){return t.$store.dispatch(t.playing?"pause":"play")}}},[t.playing?a("v-icon",{attrs:{large:t.large}},[t._v("mdi-pause")]):a("v-icon",{attrs:{large:t.large}},[t._v("mdi-play")])],1),a("v-btn",{attrs:{icon:"",small:!t.large,large:t.large},on:{click:function(e){return t.$store.dispatch("skip",1)}}},[a("v-icon",[t._v("mdi-fast-forward")])],1),t.full?a("v-btn",{attrs:{color:t.$store.state.media.repeat?"primary":"default",icon:"",small:!t.large},on:{click:function(e){return t.$store.commit("toggleRepeat")}}},[a("v-icon",{attrs:{small:!t.large}},[t._v("mdi-repeat")])],1):t._e()],1):t._e()},s=[],r={name:"MediaControls",props:{full:{type:Boolean,default:!1},large:{type:Boolean,default:!1}},computed:{playing(){return this.$store.state.media.playing}}},o=r,n=(a("d56f"),a("2877")),l=a("6544"),c=a.n(l),d=a("8336"),u=a("132d"),m=Object(n["a"])(o,i,s,!1,null,"4621d430",null);e["a"]=m.exports;c()(m,{VBtn:d["a"],VIcon:u["a"]})},7:function(t,e){},7628:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",{staticClass:"artists",attrs:{title:t.artists.map((function(t){return t.name})).join(", ")}},t._l(t.artists,(function(e,i){return a("span",{key:e.id},[a("router-link",{staticClass:"artist",style:{opacity:t.grey?.7:1},attrs:{tag:t.grey?"span":"a",to:t.$store.getters.relativeItemUrl(e)}},[t._v(t._s(e.name))]),i!==t.artists.length-1?a("span",[t._v(", ")]):t._e()],1)})),0)},s=[],r={name:"ArtistsSpan",props:{grey:{type:Boolean,default:!1},artists:{type:Array,default:()=>[]}}},o=r,n=(a("a985"),a("2877")),l=Object(n["a"])(o,i,s,!1,null,"7560a804",null);e["a"]=l.exports},"767c":function(t,e,a){},"7d25":function(t,e,a){},8:function(t,e){},"812c":function(t,e,a){},8201:function(t,e,a){"use strict";a("3bfc")},"83ca":function(t,e,a){},"85ec":function(t,e,a){},9:function(t,e){},"986f":function(t,e,a){"use strict";a("091d")},"9bcd":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-menu",{ref:"parentMenu",attrs:{"close-on-content-click":!0,"close-on-click":!0},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on;e.attrs;return[a("v-btn",t._g({attrs:{color:t.color,fab:t.fab,icon:!t.fab,small:t.fab}},i),[a("v-icon",[t._v("mdi-dots-horizontal")])],1)]}}])},[a("v-list",{attrs:{dense:""}},[a("share-menu-item",{attrs:{item:t.item},on:{action:function(e){t.$refs.parentMenu.isActive=!1}}}),"category"!==t.type&&"user"!==t.type&&"liked"!==t.type?a("follow-menu-item",{attrs:{item:t.item}}):t._e(),"track"===t.type||"artist"===t.type?a("v-list-item",{attrs:{exact:"",to:"/radio?seed_"+t.type+"s="+t.item.id}},[a("v-list-item-icon",[a("v-icon",[t._v("mdi-radio-tower")])],1),a("v-list-item-title",[t._v("Go to "+t._s(t.type)+" radio")])],1):t._e(),t.queueTrack||"category"===t.type||"liked"===t.type||"user"===t.type?t._e():a("v-list-item",{on:{click:function(e){return t.playNext(t.item)}}},[a("v-list-item-icon",[t.nextQueueLoading?a("v-progress-circular",{attrs:{size:"20",indeterminate:"",width:"1"}}):a("v-icon",[t._v("mdi-play-circle-outline")])],1),a("v-list-item-title",[t._v("Play next")])],1),t.queueTrack||"category"===t.type||"liked"===t.type||"user"===t.type?t._e():a("v-list-item",{on:{click:function(e){return t.addToQueue(t.item)}}},[a("v-list-item-icon",[t.addQueueLoading?a("v-progress-circular",{attrs:{size:"20",indeterminate:"",width:"1"}}):a("v-icon",[t._v("mdi-plus")])],1),a("v-list-item-title",[t._v("Add to queue")])],1),t.editablePlaylist?a("v-list-item",{on:{click:function(e){return t.remove(t.item,t.contextItem)}}},[a("v-list-item-icon",[t.removeLoading?a("v-progress-circular",{attrs:{size:"20",indeterminate:"",width:"1"}}):a("v-icon",[t._v("mdi-playlist-minus")])],1),a("v-list-item-title",[t._v("Remove from "),a("span",{staticClass:"font-weight-bold"},[t._v(t._s(t.contextItem.name))])])],1):t._e(),"track"===t.type&&t.queueTrack&&t.$store.getters.isTrackSet&&t.item.id!==t.$store.state.media.track.id?a("v-list-item",{on:{click:function(e){return t.$store.commit("removeFromQueue",t.item)}}},[a("v-list-item-icon",[a("v-icon",[t._v("mdi-playlist-minus")])],1),a("v-list-item-title",[t._v("Remove from queue")])],1):t._e(),a("v-menu",{attrs:{"offset-y":""},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on,s=e.attrs;return["track"===t.item.type?a("v-list-item",t._g(t._b({},"v-list-item",s,!1),i),[a("v-list-item-icon",[a("v-icon",[t._v("mdi-playlist-plus")])],1),a("v-list-item-title",[t._v("Add to playlist")])],1):t._e()]}}])},[a("v-list",{staticClass:"playlist-menu",attrs:{dense:""}},t._l(t.myPlaylists,(function(e){return a("v-list-item",{key:e.id,on:{click:function(a){return t.add(t.item,e)}}},[a("v-list-item-icon",[t.addLoading[e.id]?a("v-progress-circular",{attrs:{size:"20",indeterminate:"",width:"1"}}):a("v-icon",[t._v("mdi-playlist-music")])],1),a("v-list-item-title",[t._v(t._s(e.name))])],1)})),1)],1)],1)],1)},s=[],r=a("5dd2"),o=a("190f"),n=a("2b0e"),l={name:"ItemMenu",components:{FollowMenuItem:o["a"],ShareMenuItem:r["a"]},props:{item:{type:Object,default:null},fab:{type:Boolean,default:!1},color:{type:String,default:"default"},contextItem:{type:Object,default:null},queueTrack:{type:Boolean,default:!1}},data:()=>({addLoading:{},removeLoading:!1,addQueueLoading:!1,nextQueueLoading:!1}),methods:{async add(t,e){this.$refs.parentMenu.isActive=!1,n["a"].set(this.addLoading,e.id,!0),await this.$store.dispatch("addToPlaylist",{track:t,playlist:e}),n["a"].set(this.addLoading,e.id,!1)},async remove(t,e){this.removeLoading=!0,await this.$store.dispatch("removeFromPlaylist",{track:t,playlist:e}),this.removeLoading=!1},async playNext(t){let e=await this.$store.dispatch("getContextItem",t);this.$store.commit("playNext",e.tracks)},async addToQueue(t){let e=await this.$store.dispatch("getContextItem",t);this.$store.commit("addToQueue",e.tracks)}},computed:{editablePlaylist(){return null!==this.contextItem&&"playlist"===this.contextItem.type&&(this.contextItem.collaborative||this.contextItem.owner.id===this.$store.state.userInfo.id)},myPlaylists(){return this.$store.state.library.playlists.filter(t=>t.owner.id===this.$store.state.userInfo.id||t.collaborative)},type(){return this.item.type?this.item.type:"category"}}},c=l,d=(a("58f3"),a("2877")),u=a("6544"),m=a.n(u),h=a("8336"),p=a("132d"),f=a("8860"),y=a("da13"),g=a("34c3"),v=a("5d23"),w=a("e449"),b=a("490a"),k=Object(d["a"])(c,i,s,!1,null,"3616c00e",null);e["a"]=k.exports;m()(k,{VBtn:h["a"],VIcon:p["a"],VList:f["a"],VListItem:y["a"],VListItemIcon:g["a"],VListItemTitle:v["c"],VMenu:w["a"],VProgressCircular:b["a"]})},a123:function(t,e,a){"use strict";a.d(e,"a",(function(){return i}));class i{static isTouchDevice(){return"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0}static reduceTrackSize(t){return{album:{images:t.album.images,name:t.album.name,type:t.album.type,id:t.album.id,release_date:t.album.release_date},artists:t.artists,name:t.name,duration_ms:t.duration_ms,id:t.id,is_local:t.is_local,type:t.type,disc_number:t.disc_number}}static isLegible(t,e){console.log("Is",t,"legible on theme",e);let a=e.themes[e.isDark?"dark":"light"],s=a.navBackground,r=a.foreground,o=i.hexContrast(t,s),n=i.hexContrast(t,r);return console.log({contrastOnBg:o,contrastOnFg:n}),{bgLegible:o>3,fgLegible:n>2}}static hexToRgb(t){"#"===t[0]&&(t=t.slice(1));let e=t.slice(0,2),a=t.slice(2,4),i=t.slice(4,6);return[parseInt(e,16),parseInt(a,16),parseInt(i,16)]}static hexContrast(t,e){return i.contrast(i.hexToRgb(t),i.hexToRgb(e))}static luminance(t,e,a){const i=[t,e,a].map(t=>(t/=255,t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)));return.2126*i[0]+.7152*i[1]+.0722*i[2]}static contrast(t,e){const a=i.luminance(t[0],t[1],t[2]),s=i.luminance(e[0],e[1],e[2]),r=Math.max(a,s),o=Math.min(a,s);return(r+.05)/(o+.05)}static secondsToHms(t){if(isNaN(t)||void 0===t)return"0:00";t=Math.round(t);let e=Math.floor(t/3600),a=Math.floor(t%3600/60),i=t%60;return e=e.toString(),a=a.toString(),i=i.toString(),"0"!==e&&(a=a.padStart(2,"0"),i=i.padStart(2,"0")),i=i.padStart(2,"0"),"0"===e?`${a}:${i}`:`${e}:${a}:${i}`}static shuffleArray(t){for(let e=t.length-1;e>0;e--){const a=Math.floor(Math.random()*(e+1));[t[e],t[a]]=[t[a],t[e]]}return t}static bytesToReadable(t){let e=Math.log10(t);return e<2?t+" B":e<5?(t/1024).toFixed(2)+" kB":e<8?(t/1048576).toFixed(2)+" MB":e<12?(t/1024**3).toFixed(2)+" GB":e<15?(t/1024**4).toFixed(2)+" TB":"very bige bytes"}}},a556:function(t,e,a){"use strict";a("ad64")},a7fc:function(t,e,a){},a892:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("perfect-scrollbar",{staticClass:"item-container"},t._l(t.itemGroups,(function(e,i){return a("div",{staticClass:"column",class:{last:i===t.items.length-1}},t._l(e,(function(e){return a("item-square",{staticClass:"single-item",attrs:{big:t.big,small:t.small,"show-year":t.showYear,item:e}})})),1)})),0)},s=[],r=a("5c2f"),o={name:"ItemRow",components:{ItemSquare:r["a"]},props:{items:{type:Array,default:()=>[]},small:{type:Boolean,default:!1},big:{type:Boolean,default:!1},rows:{type:Number,default:1},showYear:{type:Boolean,default:!1}},computed:{itemGroups(){let t=[];for(let e=0;e<this.items.length;e+=this.rows)t.push(this.items.slice(e,e+this.rows));return t}}},n=o,l=(a("dd67"),a("2877")),c=Object(l["a"])(n,i,s,!1,null,"11f2d088",null);e["a"]=c.exports},a955:function(t,e,a){"use strict";(function(t){a.d(e,"a",(function(){return m}));var i=a("df7c"),s=a.n(i),r=a("a13b"),o=a.n(r),n=a("3e8f"),l=a.n(n),c=a("0baa"),d=a.n(c),u=a("33b3");class m extends u["a"]{constructor(t="./",e="./",a="./"){super(),this.directories={music:t,files:e,temp:a},this.ffmpegPath=null,this.downloadingFfmpeg=!1}async isTrackOffline(t){let e=d()(this.getSearchString(t)),a=s.a.join(this.directories.music,e+".mp3");return!!await this.fileExists(a)&&a}async removeCached(t){let e=d()(this.getSearchString(t)),a=s.a.join(this.directories.music,e+".mp3");return!!await this.fileExists(a)&&(await this.deleteFile(a),console.warn(`Deleted cache ${a} for`,t),!0)}async downloadTrack(t,e,a=(()=>0),i=null){i.addEventListener("abort",()=>a("Cancelled"));let r=d()(this.getSearchString(e)),o=s.a.join(this.directories.temp,r);a("Downloading");try{await this.downloadFile(t,o,i)}catch(l){return a("Failed")}a("Processing metadata");let n=await this.ffmpegProcessing(e,o,()=>0,i);a("Downloaded"),console.log("Downloaded track and converted to mp3 ✔",n)}async ffmpegProcessing(t,e,a=(()=>0),i=null){let r=s.a.basename(e),o={title:t.name,artist:t.artists.map(t=>t.name),disc:t.disc_number,track:t.track_number};t.hasOwnProperty("album")&&(o.album=t.album.name,o.year=new Date(t.album.release_date).getFullYear());let n=t.hasOwnProperty("album")&&t.album.images.length>0,c=s.a.join(this.directories.temp,`image-${r}.jpg`);n&&await this.downloadFile(t.album.images[0].url,c,i);let d=s.a.join(this.directories.temp,r+".mp3");try{await this.ffmpegMetadata(e,d,n?c:"",o,i)}catch(u){a("Failed")}return new Promise((t,a)=>{let i=s.a.join(this.directories.music,r+".mp3");l.a.rename(d,i,a=>{this.deleteFile(e).then(),n&&this.deleteFile(c).then(),t(i)})})}async downloadFile(e,a,i=null){let s=await fetch(e,{signal:i}),r=await s.blob(),o=l.a.createWriteStream(a);o.write(t.from(await r.arrayBuffer()))}async ffmpegMetadata(t,e,a,i,s=null){return new Promise(async(r,o)=>{let n,c=await this.getFfmpegPath();if(n=a?`${c} -y -i "${t}" -i "${a}" -map 0:0 -map 1:0 -id3v2_version 3 -metadata:s:v title="Album cover" -metadata:s:v comment="Cover (Front)" ${this.tagsToString(i)} "${e}"`:`${c} -y -i "${t}"${this.tagsToString(i)} "${e}"`,await this.fileExists(e)&&await this.deleteFile(e),await this.waitForFileUnlock(t),await this.waitForFileUnlock(a),await this.waitForFileUnlock(c),!s.aborted){let t=l.a.exec(n,(t,e,a)=>{if(t)return o(t);r({err:a,out:e})});s.addEventListener("abort",()=>t.kill())}})}tagsToString(t){let e=[];for(let a in t)if(t.hasOwnProperty(a))if(t[a]instanceof Array)for(let i of t[a])e.push(`-metadata ${a}="${i}"`);else e.push(`-metadata ${a}="${t[a]}"`);return e.join(" ")}async deleteFile(t){return new Promise((e,a)=>{l.a.unlink(t,t=>{if(t)return a(t);e()})})}async fileExists(t){return new Promise((e,a)=>{l.a.access(t,l.a.F_OK,t=>{t&&e(!1),e(!0)})})}async waitSleep(t){return new Promise(e=>setTimeout(e,t))}async waitForFileUnlock(t,e=1e4){let a=performance.now();while(1){if(performance.now()>a+e)throw"Timeout waiting for file to unlock";let i=await this.isFileLocked(t);if(!i)return!0;await this.waitSleep(250)}}async isFileLocked(t){return new Promise((e,a)=>{l.a.open(t,"r+",(t,i)=>{t&&"EBUSY"===t.code?e(!0):t&&"ENOENT"===t.code?a("File does not exist"):l.a.close(i,t=>{if(t)return a(t);e(!1)})})})}async getFfmpegPath(){return new Promise(async(t,e)=>this.ffmpegPath?t(this.ffmpegPath):this.downloadingFfmpeg?this.once("downloadFFMPEG",t):(this.downloadingFfmpeg=!0,void o.a.downloadBinaries(["ffmpeg"],{destination:this.directories.files},()=>{this.ffmpegPath=s.a.join(this.directories.files,o.a.getBinaryFilename("ffmpeg",o.a.detectPlatform())),t(this.ffmpegPath),this.emit("downloadFFMPEG"),this.downloadingFfmpeg=!1})))}}}).call(this,a("1c35").Buffer)},a985:function(t,e,a){"use strict";a("5119")},aa56:function(t,e,a){},ad64:function(t,e,a){},beca:function(t,e,a){"use strict";a("767c")},bf8a:function(t,e,a){"use strict";a.r(e);var i=a("a955"),s=a("bdb9"),r=a.n(s),o=a("9490"),n=a.n(o),l=a("3e8f"),c=a.n(l),d=a("df7c"),u=a.n(d);class m{constructor(){this.temp=this.initializeDir("temp","vuemusic"),this.files=this.initializeDir("appData","vuemusic-files"),this.music=this.getDir("music","")}initializeDir(t,e){let a=this.getDir(t,e);return this.createDir(a),a}getDir(t="music",e="files"){let a=r.a.app;return r.a.hasOwnProperty("remote")&&(a=r.a.remote.app),u.a.join(a.getPath(t),e)}createDir(t){c.a.existsSync(t)||c.a.mkdirSync(t)}importLSFile(){let t=u.a.join(this.files,"localStorage.json");if(c.a.existsSync(t)){let e=JSON.parse(c.a.readFileSync(t));for(let t in e)e.hasOwnProperty(t)&&(localStorage[t]=e[t])}}exportLSToFile(){let t=u.a.join(this.files,"localStorage.json"),e=JSON.stringify(localStorage);c.a.writeFileSync(t,e)}}var h=new m;const p=window.require("express");h.importLSFile();e["default"]={state:{type:"electron",server:null,downloader:new i["a"](h.music,h.files,h.temp),downloads:[],playingIcons:[],pausedIcons:[]},mutations:{playIcons:(t,{playIcon:e,pauseIcon:a,prevIcon:i,nextIcon:s})=>{t.playingIcons=[i,a,s],t.pausedIcons=[i,e,s]}},getters:{},actions:{initializePlatform:async({state:t,commit:e,dispatch:a,getters:i,rootState:r})=>{const o="Shift+Alt+L";s["remote"].globalShortcut.isRegistered(o)&&s["remote"].globalShortcut.unregister(o);let n=s["remote"].globalShortcut.register(o,async()=>{let t=await a("toggleFollowCurrentTrack"),e=t?"Added to favorites":"Removed from favorites",i=speechSynthesis.getVoices(),s=i[Math.floor(Math.random()*i.length)],r=new SpeechSynthesisUtterance(e);r.voice=s,speechSynthesis.speak(r)});n?console.log("Registered global shortcut ✔"):console.log("Failed to register global shortcut ❌");let l={tooltip:"Play",icon:u.a.join(__static,"/img/playicon.png"),click:()=>a("play")},c={tooltip:"Play",icon:u.a.join(__static,"/img/pauseicon.png"),click:()=>a("pause")},d={tooltip:"Previous Song",icon:u.a.join(__static,"/img/previcon.png"),click:()=>a("skip",-1)},m={tooltip:"Next Song",icon:u.a.join(__static,"/img/nexticon.png"),click:()=>a("skip",1)};e("playIcons",{playIcon:l,pauseIcon:c,prevIcon:d,nextIcon:m})},setPlatformPlaying:({state:t},e)=>{const a=s["remote"].getCurrentWindow();a.setThumbarButtons(e?t.playingIcons:t.pausedIcons)},openDevTools:async({})=>{s["remote"].getCurrentWindow().openDevTools()},closeWindow:async({})=>{s["remote"].getCurrentWindow().close()},minimizeWindow:async({})=>{s["remote"].getCurrentWindow().minimize()},exportCache:({})=>{h.exportLSToFile()},resetSpotifyLogin({state:t,commit:e}){null!==t.server&&(t.server.close(),e("server",null))},firstLogin:async({rootState:t,getters:e,state:a,commit:i,dispatch:o})=>new Promise(async l=>{if(!e.isKeySet)return void console.warn("Can't log in, keys are not set");const c=38900,d="http://localhost:"+c,u=`${t.authUrl}authorize?client_id=${t.keys.spotifyId}&response_type=code&redirect_uri=${d}&scope=${encodeURIComponent(t.requestedScopes)}`;let{shell:m}=r.a;await m.openExternal(u),null!==a.server&&a.server.close();const h=p(),f=n.a.createServer(h);h.get("/",async(t,e)=>{t.query.hasOwnProperty("code")&&(f.close(),i("server",null),console.log("Stopped listening on *:"+c),o("getAuthByCode",{redirectUrl:d,code:t.query.code}).then(e=>{s["remote"].getCurrentWindow().focus(),l({code:t.query.code,token:e.access_token,refresh:e.refresh_token,expiryDate:+new Date+1e3*e.expires_in})})),e.send('\n                        <html lang="en">\n                            <head><title>Logging in...</title></head>\n                            <body>\n                                <script>\n                                    window.close();\n                                <\/script>\n                            </body>\n                        </html>\n                    ')}),i("server",n.a),f.listen(c,()=>{console.log("listening on *:"+c)})})}}},c0f2:function(t,e,a){"use strict";a("812c")},d24b:function(t,e,a){"use strict";a("db08")},d498:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"seek",on:{mousedown:t.seekDown,touchstart:t.touchDown}},[a("span",{staticClass:"time",class:t.smallTime?"smallTime":""},[t._v(t._s(t.$store.getters.currentTimeHms))]),a("v-sheet",{ref:"seekBar",staticClass:"seek-background",style:{margin:t.smallTime?"0 -50px":"0 5px"},attrs:{flat:"",color:t.noBackground?"transparent":"default"}},[a("v-sheet",{staticClass:"seek-progress",style:{width:Math.round(1e4*t.$store.getters.progress)/100+"%"},attrs:{color:"primarySeek"}}),a("v-sheet",{staticClass:"seek-thumb",style:{left:"calc("+Math.round(1e4*t.$store.getters.progress)/100+"% - 5px)"},attrs:{color:"primarySeek"}})],1),a("span",{staticClass:"time",class:t.smallTime?"smallTime":""},[t._v(t._s(t.$store.getters.durationHms))])],1)},s=[],r={name:"MediaSeek",props:{smallTime:{type:Boolean,default:!1},noBackground:{type:Boolean,default:!1}},data:()=>({seeking:!1}),mounted(){document.addEventListener("mousemove",this.seekMove),document.addEventListener("mouseup",this.seekUp),document.addEventListener("touchmove",this.touchMove),document.addEventListener("touchend",this.touchEnd)},beforeDestroy(){document.removeEventListener("mousemove",this.seekMove),document.removeEventListener("mouseup",this.seekUp),document.removeEventListener("touchmove",this.touchMove),document.removeEventListener("touchend",this.touchEnd)},methods:{touchDown(t){this.seekDown(t.touches[0])},touchMove(t){this.seekMove(t.touches[0])},touchEnd(t){this.seekUp(t.touches[0])},seekDown(t){this.seeking=!0,this.seekByEvent(t)},seekMove(t){this.seeking&&this.seekByEvent(t)},seekByEvent(t){let{left:e,width:a}=this.$refs.seekBar.$el.getBoundingClientRect(),i=t.pageX-e,s=Math.max(Math.min(1,i/a),0);this.$store.commit("seekTo",s)},seekUp(t){this.seeking=!1}},watch:{"$store.state.media.track"(){this.seeking=!1}}},o=r,n=(a("1ed8"),a("2877")),l=a("6544"),c=a.n(l),d=a("8dd9"),u=Object(n["a"])(o,i,s,!1,null,"24042a70",null);e["a"]=u.exports;c()(u,{VSheet:d["a"]})},d56f:function(t,e,a){"use strict";a("4c27")},db08:function(t,e,a){},dd67:function(t,e,a){"use strict";a("83ca")},e292:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return null!==t.item?a("div",{staticClass:"follow-button"},[t.hideTooltip?a("div",[t.isFollowed?a("v-btn",{attrs:{loading:t.loading,icon:"",color:"primary"},on:{click:t.unfollow}},[a("v-icon",[t._v("mdi-heart-outline")])],1):a("v-btn",{attrs:{loading:t.loading,icon:""},on:{click:t.follow}},[a("v-icon",[t._v("mdi-heart-outline")])],1)],1):a("v-tooltip",{attrs:{top:""},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on,s=e.attrs;return[t.isFollowed?a("v-btn",t._g(t._b({attrs:{loading:t.loading,icon:"",color:"primary"},on:{click:t.unfollow}},"v-btn",s,!1),i),[a("v-icon",[t._v("mdi-heart-outline")])],1):a("v-btn",t._g(t._b({attrs:{loading:t.loading,icon:""},on:{click:t.follow}},"v-btn",s,!1),i),[a("v-icon",[t._v("mdi-heart-outline")])],1)]}}],null,!1,2796376417)},[t.isFollowed?a("span",[t._v("Remove from library")]):a("span",[t._v("Add to library")])])],1):t._e()},s=[],r={name:"FollowButton",props:{item:{type:Object,default:null},hideTooltip:{type:Boolean,default:!1}},data:()=>({loading:!1}),methods:{async follow(){this.loading=!0,await this.$store.dispatch("follow"+this.typeCapitalized,this.item),this.loading=!1},async unfollow(){this.loading=!0,await this.$store.dispatch("unfollow"+this.typeCapitalized,this.item),this.loading=!1}},computed:{typeCapitalized(){return this.item.type.substring(0,1).toUpperCase()+this.item.type.substring(1)},isFollowed(){return this.$store.getters[`is${this.typeCapitalized}Followed`](this.item)}}},o=r,n=a("2877"),l=a("6544"),c=a.n(l),d=a("8336"),u=a("132d"),m=a("3a2f"),h=Object(n["a"])(o,i,s,!1,null,"04dea7bf",null);e["a"]=h.exports;c()(h,{VBtn:d["a"],VIcon:u["a"],VTooltip:m["a"]})},e51b:function(t,e,a){"use strict";a.r(e);var i=a("33b3"),s={api:"https://api.ruurd.dev"};class r{constructor(){this._fetch=window.fetch}start(){let t=this._fetch;window.fetch=function(){let[e,a]=arguments,i=["https://www.youtube.com","https://manifest.googlevideo.com","https://r1---","https://r2---","https://r3---","https://r4---","https://r5---","https://r6---","https://r7---","https://r8---","https://r9---"];for(let t of i)if(e.startsWith(t)){console.log("INTERCEPT",e,a),e=`${s.api}/proxy?url=${encodeURIComponent(e)}`;break}return t.apply(this,[e,a])}}stop(){window.fetch=this._fetch}}var o=new r;class n{constructor(){this.options={},this.url="",this.readyState=0,this.status=0,this.onreadystatechange=()=>{},this.responseText=""}static start(){this._XMLHttpRequest=window.XMLHttpRequest,window.XMLHttpRequest=n}static stop(){window.XMLHttpRequest=this._XMLHttpRequest}async send(t){this.options.body=t,await this.sendLive()}async sendLive(){let t=await fetch(this.url,this.options);this.readyState=4,this.status=t.status,this.responseText=await t.text(),this.onreadystatechange()}open(t,e){this.options.method=t,this.url=e}abort(...t){console.info("abort",...t)}setRequestHeader(t,e){this.options.hasOwnProperty("headers")||(this.options.headers={}),this.options.headers[t]=e}}class l extends i["a"]{constructor(){super(),this.cacheName="vue-music",o.start(),n.start()}async getYtdlInfo(t){let e=await fetch(s.api+"/ytdl?id="+t,{method:"POST"});return await e.json()}async removeCached(t){let e=this.getSearchString(t);const a=await caches.open(this.cacheName);return console.warn(`Deleted cache ${e} for`,t),await a.delete(e)}async isTrackOffline(t){let e=this.getSearchString(t);const a=await caches.open(this.cacheName);let i=await a.match(e);if(void 0===i)return!1;let s=await i.blob();return URL.createObjectURL(s)}async downloadTrack(t,e,a=(()=>0),i=null){a("Downloading");let s=this.getSearchString(e);try{let e=await fetch(t,{signal:i});const r=await caches.open(this.cacheName);await r.put(s,e),a("Downloaded")}catch(r){return a("Failed")}}}e["default"]={state:{type:"web",channel:null,downloads:[],playingIcons:[],pausedIcons:[],downloader:new l},mutations:{channel:(t,e)=>t.channel=e},getters:{},actions:{exportCache(){},initializePlatform:async({state:t,commit:e,dispatch:a,getters:i,rootState:s})=>{},setPlatformPlaying:({state:t},e)=>{},resetSpotifyLogin({state:t,commit:e}){null!==t.channel&&(t.channel.close(),e("channel",null))},firstLogin:async({rootState:t,getters:e,state:a,commit:i,dispatch:s})=>new Promise(async r=>{if(!e.isKeySet)return void console.warn("Can't log in, keys are not set");let o=location.origin+(location.pathname+(location.pathname.endsWith("/")?"":"/")).replace(/\/\//gi,"/");console.log("REDIRECT URL:",o),o=encodeURIComponent(o);const n=`${t.authUrl}authorize?client_id=${t.keys.spotifyId}&response_type=code&redirect_uri=${o}&scope=${encodeURIComponent(t.requestedScopes)}`;window.open(n),a.channel&&a.channel.close();let l=new BroadcastChannel("loginCode");i("channel",l),l.onmessage=t=>{l.close(),i("channel",null),s("getAuthByCode",{redirectUrl:o,code:t.data}).then(e=>{r({code:t.data,token:e.access_token,refresh:e.refresh_token,expiryDate:+new Date+1e3*e.expires_in})})}})}}},f966:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return null!==t.contextItem?a("v-list",{ref:"list",staticClass:"queue-list",style:{height:t.height}},[a("h5",{staticClass:"context"},[t._v(t._s(t.context.name))]),a("recycle-scroller",{ref:"scroller",staticClass:"scroller",style:{height:t.scrollerHeight+"px"},attrs:{items:t.queue,"item-size":51},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.item;e.index;return[a("div",{staticClass:"scroll-item"},[a("v-divider"),a("track-row",{key:i.id,attrs:{"queue-track":"","context-item":t.contextItem,track:i}})],1)]}}],null,!1,3097587504)}),a("div",{staticClass:"bottom-buttons"},[null!==t.context.to?a("v-btn",{staticClass:"view-more",attrs:{disabled:t.$route.fullPath===t.context.to,color:"primary",text:"",small:"",to:t.context.to,title:"Visit "+t.contextItem.name}},[t._v("Go to "+t._s(t.contextItem.type)+" ")]):t._e(),a("v-btn",{staticClass:"view-more",attrs:{small:"",text:""},on:{click:function(e){return t.$store.commit("clearQueue")}}},[t._v("Clear queue")])],1)],1):t._e()},s=[],r=a("1344"),o={name:"QueueList",components:{TrackRow:r["a"]},props:{height:{type:[Number,String],default:"90vh"}},data:()=>({scrollerHeight:window.innerHeight-110-150}),mounted(){this.calculateHeight(),window.addEventListener("resize",this.calculateHeight)},beforeDestroy(){window.removeEventListener("resize",this.calculateHeight)},methods:{calculateHeight(){if(!this.$refs.list)return;let{height:t}=this.$refs.list.$el.getBoundingClientRect();this.scrollerHeight=t-110},scrollToItem(){setTimeout(()=>{this.calculateHeight(),this.$refs.scroller&&this.$refs.scroller.scrollToItem(this.$store.getters.trackIndex)},100)}},computed:{contextItem(){return this.$store.state.media.contextItem},context(){return{name:this.contextItem.name,to:this.$store.getters.relativeItemUrl(this.contextItem)}},queue(){return this.$store.getters.currentQueue}},watch:{"$store.getters.trackIndex"(){this.$refs.scroller&&this.$refs.scroller.scrollToItem(this.$store.getters.trackIndex)}}},n=o,l=(a("a556"),a("2877")),c=a("6544"),d=a.n(c),u=a("8336"),m=a("ce7e"),h=a("8860"),p=Object(l["a"])(n,i,s,!1,null,"262b5931",null);e["a"]=p.exports;d()(p,{VBtn:u["a"],VDivider:m["a"],VList:h["a"]})}});
//# sourceMappingURL=app.127a8c81.js.map