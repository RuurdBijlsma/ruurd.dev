(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-15419897"],{"185b":function(e,t,i){"use strict";i.r(t);var r=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{ref:"nowPlaying",staticClass:"now-playing"},[e.track?i("div",{staticClass:"left"},[i("div",{staticClass:"blur-background",style:{backgroundImage:"url("+e.image+")"}}),i("div",{staticClass:"media"},[i("div",{staticClass:"fsb-container"},[i("v-btn",{staticClass:"fullscreen-button",attrs:{title:"Toggle fullscreen",icon:"",small:""},on:{click:e.toggleFullScreen}},[i("v-icon",[e._v("mdi-fullscreen")])],1),e.hideQueue?i("v-btn",{staticClass:"fullscreen-button",attrs:{title:"Open queue list",icon:"",small:""},on:{click:function(t){e.hideQueue=!1}}},[i("v-icon",[e._v("mdi-menu-left")])],1):i("v-btn",{staticClass:"fullscreen-button",attrs:{title:"Close queue list",icon:"",small:""},on:{click:function(t){e.hideQueue=!0}}},[i("v-icon",[e._v("mdi-menu-right")])],1)],1),i("div",{staticClass:"media-container"},[i("div",{staticClass:"media-center"},[i("glow-image",{staticClass:"album-image",attrs:{size:e.$store.state.windowWidth<400?200:300,url:e.image}}),i("div",{staticClass:"track-info"},[i("span",{staticClass:"track-title"},[e._v(e._s(e.track.name))]),i("artists-span",{staticClass:"track-artists",attrs:{artists:e.track.artists,grey:""}})],1),i("media-seek",{staticClass:"seek"}),i("media-controls",{staticClass:"controls",attrs:{"fg-legible":e.fgLegible,full:"",large:""}})],1)])])]):e._e(),e.$store.state.windowWidth>=1080?i("queue-list",{directives:[{name:"show",rawName:"v-show",value:!e.hideQueue,expression:"!hideQueue"}],ref:"list",staticClass:"queue",attrs:{height:"100%"}}):e._e()],1)},a=[],s=(i("a15b"),i("d81d"),i("13d5"),i("fb6a"),i("d3b7"),i("07ac"),i("25f0"),i("4d90"),i("2909")),n=i("3835"),o=(i("96cf"),i("1da1")),l=i("f966"),u=i("506b"),c=i("6e9c"),m=i("7628"),h=i("d498"),d=i("a123"),g={name:"NowPlaying",components:{MediaSeek:h["a"],ArtistsSpan:m["a"],MediaControls:c["a"],GlowImage:u["a"],QueueList:l["a"]},data:function(){return{previousColors:null,fgLegible:!0,color:null,hideQueue:null!==localStorage.getItem("hideNPQueue")&&JSON.parse(localStorage.hideNPQueue)}},mounted:function(){this.processImage()},methods:{toggleFullScreen:function(){document.fullscreenElement?document.exitFullscreen():this.$refs.nowPlaying.requestFullscreen()},processImage:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return i=e.$store.getters.itemImage(e.track),t.next=3,e.getImageColor(i);case 3:e.color=t.sent,e.applyThemeColor(e.color);case 5:case"end":return t.stop()}}),t)})))()},getImageColor:function(e){var t=this;return new Promise((function(i){var r=document.createElement("img");r.src=e;var a=document.createElement("canvas"),o=a.getContext("2d");r.onload=function(){var e=20,l=20;a.width=e,a.height=l,o.drawImage(r,0,0,e,l);for(var u={},c=o.getImageData(0,0,e,l),m=0;m<c.data.length;m+=4){var h=c.data.slice(m,m+3),d=h.map((function(e){return Math.floor(e/20)})),g=t.rgbToHsl.apply(t,Object(s["a"])(d)),f=Object(n["a"])(g,3),p=(f[0],f[1]),v=(f[2],d.join(","));void 0===u[v]&&(u[v]={n:0,color:h}),u[v].n+=1+255*p}var b=Object.values(u),y=b.map((function(e){return e.n})).reduce((function(e,t,i,r){return t>r[e]?i:e}),0),k=Object(n["a"])(b[y].color,3),C=k[0],w=k[1],$=k[2],I=function(e){return e.toString(16).padStart(2,"0")};i("#"+I(C)+I(w)+I($))}}))},rgbToHsl:function(e,t,i){e/=255,t/=255,i/=255;var r,a,s=Math.max(e,t,i),n=Math.min(e,t,i),o=(s+n)/2;if(s===n)r=a=0;else{var l=s-n;switch(a=o>.5?l/(2-s-n):l/(s+n),s){case e:r=(t-i)/l+(t<i?6:0);break;case t:r=(i-e)/l+2;break;case i:r=(e-t)/l+4;break}r/=6}return[r,a,o]},applyThemeColor:function(e){var t,i=d["a"].isLegible(e,this.$vuetify.theme),r=i.bgLegible,a=i.fgLegible;if(!r)return console.log("Theme color",e,"not legible on background, reverting back to",null===(t=this.previousColors)||void 0===t?void 0:t.primaryDark),void this.revertThemeColor();console.log("Applying theme color ðŸŽ¨",e),this.fgLegible=a,null===this.previousColors&&(this.previousColors={primaryDark:this.$vuetify.theme.themes.dark.primary,primaryLight:this.$vuetify.theme.themes.light.primary,primarySeekLight:this.$vuetify.theme.themes.light.primarySeek}),this.$vuetify.theme.themes.dark.primary=e,this.$vuetify.theme.themes.light.primary=e,this.$vuetify.theme.themes.light.primarySeek=e},revertThemeColor:function(){this.fgLegible=!0,null!==this.previousColors&&(this.$vuetify.theme.themes.dark.primary=this.previousColors.primaryDark,this.$vuetify.theme.themes.light.primary=this.previousColors.primaryLight,this.$vuetify.theme.themes.light.primarySeek=this.previousColors.primarySeekLight)},scrollToItem:function(){var e=this;this.intervals.push(setInterval((function(){e.$refs.list&&(e.$refs.list.scrollToItem(),e.clearIntervals())}),50))}},watch:{hideQueue:function(){localStorage.hideNPQueue=this.hideQueue,!1===this.hideQueue&&this.$refs.list.scrollToItem()},"$vuetify.theme.dark":function(){null!==this.color&&this.applyThemeColor(this.color)},track:function(){this.processImage()}},computed:{track:function(){return this.$store.state.media.track},image:function(){return this.$store.getters.itemImage(this.track)}},beforeRouteLeave:function(e,t,i){this.revertThemeColor(),i()}},f=g,p=(i("7602"),i("2877")),v=i("6544"),b=i.n(v),y=i("8336"),k=i("132d"),C=Object(p["a"])(f,r,a,!1,null,"2230ee1c",null);t["default"]=C.exports;b()(C,{VBtn:y["a"],VIcon:k["a"]})},"4d32":function(e,t,i){},"506b":function(e,t,i){"use strict";var r=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"glow-image",style:{width:e.size+"px"}},[i("div",{staticClass:"album-art album-background",style:{backgroundImage:"url("+e.image+")",opacity:e.$vuetify.theme.dark?.4:.7,minWidth:e.size+"px",height:e.size+"px",right:-e.size/2+"px",borderRadius:e.rounded?"50%":"5px",top:e.size/16+"px",filter:"blur("+e.size/16+"px)"}}),i("div",{staticClass:"album-art album-normal",style:{backgroundImage:"url("+e.image+")",minWidth:e.size+"px",height:e.size+"px",left:-e.size/2+"px",borderRadius:e.rounded?"50%":"5px"}})])},a=[],s=(i("a9e3"),{name:"GlowImage",props:{url:{type:String,default:void 0},size:{type:Number,default:300},rounded:{type:Boolean,default:!1}},computed:{image:function(){return this.url?this.url:this.$store.getters.notFoundImage}}}),n=s,o=(i("f114"),i("2877")),l=Object(o["a"])(n,r,a,!1,null,"5c72778c",null);t["a"]=l.exports},7602:function(e,t,i){"use strict";var r=i("4d32"),a=i.n(r);a.a},f114:function(e,t,i){"use strict";var r=i("feac"),a=i.n(r);a.a},feac:function(e,t,i){}}]);
//# sourceMappingURL=chunk-15419897.9e6a7d9f.js.map