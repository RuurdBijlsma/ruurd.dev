{"version":3,"sources":["webpack:///./src/views/Tracks.vue?0513","webpack:///./src/views/Tracks.vue","webpack:///src/views/Tracks.vue","webpack:///./src/views/Tracks.vue?d2f9","webpack:///./src/views/Tracks.vue?6ff9"],"names":["attrs","scopedSlots","index","staticClass","filter","apply","_vm","_c","on","model","value","callback","expression","item","dispatch","shuffle","_v","key","id","hideAlbum","context","staticRenderFns","render","name","components","TrackRow","data","liveFilter","filterTerm","focusInterval","beforeDestroy","clearInterval","methods","clearFilter","hasSwitched","console","computed","lowerFilterTerm","type","tracks","loading","compactMenu","scrollItems","size","t","fullDuration","component"],"mappings":"kHAAA,W,4ICAkJA,EAAM,W,IAAC,O,EAAwB,QAAY,G,OAAK,QAAY,CAAO,YAAC,UAACC,sBAAoB,C,YAAK,W,MAAa,C,MAAc,c,YAAEC,KAAK,aAAE,Q,YAA+BC,EAAW,GAAC,E,IAAwB,U,GAAcA,e,EAAgC,M,UAAoD,CAAWC,IAAX,EAAWA,EAAOC,MAAM,C,YAAgB,wBAAC,WAAE,YAAU,kBAACF,IAA2BG,OAAO,SAAYC,GAAqCJ,OAAf,EAAC,iBAAyB,EAAC,aAAa,mB,CAAsB,OAAS,C,YAAc,c,CAAC,KAAO,YAAC,SAAe,C,IAAC,cAAc,YAAC,cAACK,MAAG,CAAC,YAA8B,WAACC,MAAM,GAACC,MAAOJ,gBAAgBK,UAAS,I,GAAmC,CAACC,cAAW,eAAe,MAAKL,CAAgBJ,QAAY,WAAYI,SAAS,YAACJ,aAAY,GAAwBH,WAAM,iBAAY,KAAO,OAAC,CAAS,YAAC,YAAG,EAAC,O,YAAS,W,GAAiB,OAAOM,C,MAAiCO,C,MAAmB,oBAAG,GAAI,CAAWV,MAAW,SAAO,GAACH,OAAM,8BAAC,KAAQ,e,CAA2F,SAAQ,C,YAAW,OAAS,MAAC,CAAG,MAAC,K,GAA0B,iBAAkBc,KAAS,WAAY,+B,MAACD,C,MAAmBE,G,MAAc,WAAC,IAAIR,MAAG,SAAS,GAACJ,OAAW,EAAC,OAAM,qBAAM,KAAC,UAAC,SAAQ,OAAwG,CAACI,EAAG,OAAM,CAA2DJ,YAAY,OAAM,MAAMa,CAAiFb,MAAW,KAAkCA,uBAAY,0CAAM,YAAa,eAA6BA,UAAY,QAAS,2CAACH,YAAM,O,CAAC,YAAe,EAAC,OAAE,kD,YAAQ,qB,CAAK,SAAQ,CAAG,mBAAG,CAACO,EAAG,UAAW,EAAG,OAAkB,CAA8BJ,YAAY,UAAa,MAAI,CAA8BA,cAAY,GAAgBI,KAAG,KAAaU,MAASC,OAAU,SAAU,CAACZ,EAAIa,oBAAS,sB,YAAC,eAA+B,UAAeb,EAAIc,EAAO,S,YAAC,e,CAAmB,cAAQP,CAAI,SAAG,MAAI,CAAaV,WAAY,YAAc,eAAa,uCAAG,gBAAO,WAEhpEkB,SAAoB,CAEfC,YAAQD,e,+DCqDjB,GACAE,cACAC,YAAAC,iBACAC,WACAC,cACAC,cACAC,mBAEA,sBACA,iDAEAC,gBACAC,mCAEAC,SACAC,cACA,mBACA,iBAEA7B,aAEA,GADA,iCACA,EACA,OAKA,SACA,MACA,KACA,IACA2B,kCACA,oCACA,wDACA,6BACAG,KACA,+BACAH,kCACAI,yCAEA,UACAJ,kCACAI,qCAEA,KAGAC,UACAC,kBACA,sCAEAjB,UACA,OAAAkB,aAAApB,WAAAK,oBAAAgB,qBAEAC,UACA,6CAEAC,cACA,oCACA,8BAEAtB,YACA,oCACA,cAEAuB,cACA,gCAAAC,WACA,MACA,QAAAzB,OAAAyB,WAAA,IAEAJ,SACA,2BACA,wDACA,4CACA,YACAK,qDACAA,kFAGAC,eACA,8BACA,uBACA,iFC3IgV,I,wBCQ5UC,EAAY,eACd,EACA,EACAzB,GACA,EACA,KACA,WACA,MAIa,aAAAyB,E","file":"js/chunk-76968ffa.f42807fb.js","sourcesContent":["export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Tracks.vue?vue&type=style&index=0&id=2b6d4f20&prod&scoped=true&lang=css&\"","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"tracks\"},[_c('recycle-scroller',{staticClass:\"scroller\",attrs:{\"items\":_vm.scrollItems,\"key-field\":\"id\",\"size-field\":\"size\"},scopedSlots:_vm._u([{key:\"default\",fn:function({item, index}){return [(index===0)?_c('div',{staticClass:\"page-title-container\"},[_c('v-form',{staticClass:\"title-container\",on:{\"submit\":function($event){$event.preventDefault();return _vm.filter.apply(null, arguments)}}},[_c('h1',{staticClass:\"page-title\"},[_vm._v(\"Tracks\")]),_c('v-text-field',{ref:\"filterInput\",staticClass:\"filter-term\",attrs:{\"outlined\":\"\",\"rounded\":\"\",\"dense\":\"\",\"label\":\"Filter tracks\",\"clearable\":\"\"},on:{\"click:clear\":_vm.clearFilter},model:{value:(_vm.liveFilter),callback:function ($$v) {_vm.liveFilter=$$v},expression:\"liveFilter\"}})],1),_c('v-divider',{staticClass:\"divider\"}),_c('div',{staticClass:\"buttons\"},[_c('v-btn',{attrs:{\"small\":\"\",\"color\":\"primary\"},on:{\"click\":function($event){return _vm.$store.dispatch('playItem', {item: _vm.context})}}},[_c('v-icon',{staticClass:\"mr-2\",attrs:{\"small\":\"\"}},[_vm._v(\"mdi-play\")]),_vm._v(\" Play \")],1),(_vm.tracks.length > 1)?_c('v-btn',{attrs:{\"small\":\"\",\"color\":\"primary\"},on:{\"click\":function($event){return _vm.$store.dispatch('playItem', {item: _vm.context, shuffle:true})}}},[_c('v-icon',{staticClass:\"mr-2\",attrs:{\"small\":\"\"}},[_vm._v(\"mdi-shuffle\")]),_vm._v(\" Shuffle \")],1):_vm._e()],1),_c('div',{staticClass:\"sub-caption\"},[_c('span',[_vm._v(_vm._s(_vm.tracks.length)+\" tracks\")]),_c('span',{staticClass:\"dot\"},[_vm._v(\"•\")]),_c('span',[_vm._v(_vm._s(_vm.fullDuration))]),(_vm.loading)?_c('span',{staticClass:\"loading-indicator\"},[_c('span',{staticClass:\"dot\"},[_vm._v(\"•\")]),_c('v-progress-circular',{staticClass:\"spinner\",attrs:{\"indeterminate\":\"\",\"size\":\"10\",\"width\":\"1\"}}),_c('span',[_vm._v(\"Refreshing\")])],1):_vm._e()]),_c('v-divider',{staticClass:\"mr-1 ml-1\"})],1):_vm._e(),(index>0)?_c('div',{staticClass:\"scroll-item\"},[_c('track-row',{key:item.id,attrs:{\"no-album\":_vm.hideAlbum,\"compact-menu\":_vm.compactMenu,\"context-item\":_vm.context,\"album-list\":false,\"track\":item}}),_c('v-divider',{staticClass:\"mr-1 ml-1\"})],1):_vm._e()]}}])})],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n    <div class=\"tracks\">\r\n        <recycle-scroller\r\n                class=\"scroller\"\r\n                :items=\"scrollItems\"\r\n                key-field=\"id\"\r\n                size-field=\"size\"\r\n                v-slot=\"{item, index}\">\r\n            <div v-if=\"index===0\" class=\"page-title-container\">\r\n                <v-form @submit.prevent=\"filter\" class=\"title-container\">\r\n                    <h1 class=\"page-title\">Tracks</h1>\r\n                    <v-text-field ref=\"filterInput\" outlined rounded dense v-model=\"liveFilter\" label=\"Filter tracks\"\r\n                                  class=\"filter-term\" clearable\r\n                                  @click:clear=\"clearFilter\"></v-text-field>\r\n                </v-form>\r\n                <v-divider class=\"divider\"></v-divider>\r\n                <div class=\"buttons\">\r\n                    <v-btn small color=\"primary\" @click=\"$store.dispatch('playItem', {item: context})\">\r\n                        <v-icon small class=\"mr-2\">mdi-play</v-icon>\r\n                        Play\r\n                    </v-btn>\r\n                    <v-btn small v-if=\"tracks.length > 1\" color=\"primary\"\r\n                           @click=\"$store.dispatch('playItem', {item: context, shuffle:true})\">\r\n                        <v-icon small class=\"mr-2\">mdi-shuffle</v-icon>\r\n                        Shuffle\r\n                    </v-btn>\r\n                </div>\r\n                <div class=\"sub-caption\">\r\n                    <span>{{tracks.length}} tracks</span>\r\n                    <span class=\"dot\">•</span>\r\n                    <span>{{fullDuration}}</span>\r\n                    <span v-if=\"loading\" class=\"loading-indicator\">\r\n                        <span class=\"dot\">•</span>\r\n                        <v-progress-circular class=\"spinner\" indeterminate size=\"10\" width=\"1\"></v-progress-circular>\r\n                        <span>Refreshing</span>\r\n                    </span>\r\n                </div>\r\n                <v-divider class=\"mr-1 ml-1\"></v-divider>\r\n            </div>\r\n            <div class=\"scroll-item\" v-if=\"index>0\">\r\n                <track-row\r\n                        :no-album=\"hideAlbum\"\r\n                        :compact-menu=\"compactMenu\"\r\n                        :context-item=\"context\"\r\n                        :album-list=\"false\"\r\n                        :key=\"item.id\"\r\n                        :track=\"item\"></track-row>\r\n                <v-divider class=\"mr-1 ml-1\"></v-divider>\r\n            </div>\r\n        </recycle-scroller>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n    import TrackRow from \"../components/TrackRow\";\r\n    import Utils from \"../js/Utils\";\r\n\r\n    export default {\r\n        name: \"Tracks\",\r\n        components: {TrackRow},\r\n        data: () => ({\r\n            liveFilter: '',\r\n            filterTerm: '',\r\n            focusInterval: -1,\r\n        }),\r\n        async mounted() {\r\n            await this.$store.dispatch('refreshUserData', 'track');\r\n        },\r\n        beforeDestroy() {\r\n            clearInterval(this.focusInterval);\r\n        },\r\n        methods: {\r\n            clearFilter() {\r\n                this.liveFilter = '';\r\n                this.filter(false);\r\n            },\r\n            filter(focus = true) {\r\n                this.filterTerm = this.liveFilter;\r\n                if (!focus)\r\n                    return;\r\n\r\n                // 🍝 Input element is destroyed due to recycle scroller being rebuild\r\n                // so input focus is sometimes lost which is unexpected.\r\n                // This restores focus\r\n                let hasSwitched = false;\r\n                let timeout = 800;\r\n                let intervalSpeed = 10;\r\n                let i = 0;\r\n                clearInterval(this.focusInterval);\r\n                this.focusInterval = setInterval(() => {\r\n                    let inputEl = this.$refs.filterInput.$el.querySelector(\"input\");\r\n                    if (inputEl !== document.activeElement) {\r\n                        hasSwitched = true;\r\n                        this.$refs.filterInput.focus();\r\n                        clearInterval(this.focusInterval);\r\n                        console.log(\"Stop due to focus called\");\r\n                    }\r\n                    if (i++ > timeout / intervalSpeed) {\r\n                        clearInterval(this.focusInterval);\r\n                        console.log(\"Stop due to timeout\");\r\n                    }\r\n                }, intervalSpeed);\r\n            }\r\n        },\r\n        computed: {\r\n            lowerFilterTerm() {\r\n                return this.filterTerm.toLowerCase();\r\n            },\r\n            context() {\r\n                return {type: 'liked', id: 'liked', name: 'Liked tracks', tracks: this.tracks}\r\n            },\r\n            loading() {\r\n                return this.$store.state.isRefreshing.track;\r\n            },\r\n            compactMenu() {\r\n                let width = this.$store.state.windowWidth;\r\n                return width < 735 && (width > 680 || width < 436);\r\n            },\r\n            hideAlbum() {\r\n                let width = this.$store.state.windowWidth;\r\n                return width < 950;\r\n            },\r\n            scrollItems() {\r\n                let tracks = this.tracks.map(t => ({...t, size: 51}));\r\n                let titleHeight = 142;\r\n                return [{id: '0', size: titleHeight}, ...tracks];\r\n            },\r\n            tracks() {\r\n                if (this.filterTerm === '')\r\n                    return this.$store.state.library.tracks.filter(t => !t.is_local);\r\n                return this.$store.state.library.tracks.filter(t =>\r\n                    !t.is_local &&\r\n                    t.name.toLowerCase().includes(this.lowerFilterTerm) ||\r\n                    t.artists.map(a => a.name).join(' ').toLowerCase().includes(this.lowerFilterTerm)\r\n                );\r\n            },\r\n            fullDuration() {\r\n                if (this.tracks.length === 0)\r\n                    return Utils.secondsToHms(0);\r\n                return Utils.secondsToHms(this.tracks.map(t => t.duration_ms / 1000).reduce((a, b) => a + b));\r\n            },\r\n        }\r\n    }\r\n</script>\r\n\r\n<style scoped>\r\n    .tracks {\r\n        height: 100%;\r\n        width: 100%;\r\n    }\r\n\r\n    .title-container {\r\n        display: flex;\r\n        justify-content: space-between;\r\n        align-items: center;\r\n        margin-top: 4px;\r\n    }\r\n\r\n    .filter-term {\r\n        margin-bottom: -20px;\r\n        max-width: 250px;\r\n        margin-right: 5px;\r\n        margin-top: 4px;\r\n    }\r\n\r\n    .scroller {\r\n        height: 100%;\r\n        padding: 30px;\r\n        padding-top: 20px;\r\n    }\r\n\r\n    @media (max-width: 680px) {\r\n        .scroller {\r\n            padding: 10px;\r\n        }\r\n    }\r\n\r\n    .divider {\r\n        margin-bottom: 15px;\r\n    }\r\n\r\n    .buttons {\r\n        display: flex;\r\n    }\r\n\r\n    .buttons > *:not(:last-child) {\r\n        margin-right: 15px;\r\n    }\r\n\r\n    .sub-caption {\r\n        margin: 15px 0 10px;\r\n        text-transform: uppercase;\r\n        font-size: 12px;\r\n        font-weight: bolder;\r\n        opacity: 0.7;\r\n    }\r\n\r\n    .dot {\r\n        margin: 0 10px;\r\n    }\r\n\r\n    .loading-indicator {\r\n        display: inline-flex;\r\n        justify-content: center;\r\n        align-items: center;\r\n        vertical-align: top;\r\n    }\r\n\r\n    .spinner {\r\n        margin-right: 5px;\r\n    }\r\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Tracks.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Tracks.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Tracks.vue?vue&type=template&id=2b6d4f20&scoped=true&\"\nimport script from \"./Tracks.vue?vue&type=script&lang=js&\"\nexport * from \"./Tracks.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Tracks.vue?vue&type=style&index=0&id=2b6d4f20&prod&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"2b6d4f20\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}