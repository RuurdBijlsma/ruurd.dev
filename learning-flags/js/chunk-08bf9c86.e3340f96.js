(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-08bf9c86"],{"20f6":function(e,t,r){},"2fa4":function(e,t,r){"use strict";r("20f6");var a=r("80d2");t["a"]=Object(a["g"])("spacer","div","v-spacer")},"4fe6":function(e,t,r){"use strict";r("50bf")},"50bf":function(e,t,r){},6062:function(e,t,r){"use strict";var a=r("6d61"),n=r("6566");e.exports=a("Set",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),n)},"8ce9":function(e,t,r){},"93a4":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"home",style:{flexDirection:e.$vuetify.breakpoint.mobile?"column":"row",alignItems:e.$vuetify.breakpoint.mobile?"stretch":"flex-start"}},[r("v-card",{staticClass:"left-card",class:e.$vuetify.breakpoint.width>1300?"rounded-xl":"",attrs:{elevation:"2"}},[r("v-card-title",[e._v("What flag is this?")]),r("v-divider"),e.game.fact?r("v-sheet",{staticClass:"flag",attrs:{color:"lightBackground"}},[r("v-img",{attrs:{contain:"",src:e.$store.getters.flagUrl(e.game.fact.question)}})],1):e._e(),r("v-divider"),r("v-card-text",[e.game.showFeedback?r("div",{staticClass:"feedback"},[""!==e.game.userAnswer?r("h4",[e._v('You answered "'+e._s(e.game.userAnswer)+'"')]):e._e(),e.game.correctAnswer&&e.game.fact?[r("v-icon",{attrs:{size:"100",color:"success"}},[e._v("mdi-check")]),r("h2",[e._v('Correct! The answer was "'+e._s(e.game.fact.answer)+'"')])]:e.game.fact?[r("v-icon",{attrs:{size:"100",color:"error"}},[e._v("mdi-alert-circle-outline")]),r("h2",[""!==e.game.userAnswer?r("span",[e._v("Wrong! ")]):e._e(),e._v(' The answer was "'+e._s(e.game.fact.answer)+'"')])]:e._e()],2):r("v-text-field",{ref:"userInput",attrs:{outlined:"",dense:"","hide-details":"",label:"Answer",placeholder:"For example: 'Netherlands'"},on:{keypress:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.answerFact.apply(null,arguments)}},model:{value:e.game.userAnswer,callback:function(t){e.$set(e.game,"userAnswer",t)},expression:"game.userAnswer"}})],1),r("v-card-actions",[r("v-spacer"),e.game.showFeedback?r("v-btn",{attrs:{rounded:"",color:"primary",loading:e.loading.fact},on:{click:e.nextFact}},[r("span",{staticClass:"ml-4 mr-4"},[e._v("Next fact")])]):r("v-btn",{attrs:{rounded:"",color:"primary",loading:e.loading.answer},on:{click:e.answerFact}},[""!==e.game.userAnswer?r("span",{staticClass:"ml-4 mr-4"},[e._v("Submit answer")]):r("span",{staticClass:"ml-4 mr-4"},[e._v("I don't know")])])],1)],1),r("v-card",{staticClass:"right-card",class:e.$vuetify.breakpoint.width>1300?"rounded-xl":"",style:{marginLeft:e.$vuetify.breakpoint.mobile?"0":"30px",width:e.$vuetify.breakpoint.mobile?"100%":"300px"},attrs:{elevation:"2"}},[r("v-card-title",[e._v("Session progress")]),r("v-card-text",[r("v-progress-linear",{attrs:{value:100-e.game.timeLeft/e.game.duration*100}}),r("div",{staticClass:"time-container mb-4"},[r("span",[e._v(e._s(e.toHms(e.game.timeLeft)))]),r("span",[e._v(e._s(e.toHms(e.game.duration)))])]),r("p",[e._v(e._s(e.game.encounteredFlags.size)+" / "+e._s(e.$store.state.factCount)+" flags encountered")]),r("p",[e._v(e._s(Math.round(100*e.correctPercentage))+"% correct")])],1)],1)],1)},n=[],s=r("2909"),o=r("1da1"),i=(r("96cf"),r("d3b7"),r("6062"),r("3ca3"),r("ddb0"),r("99af"),r("d81d"),r("fb6a"),r("2b0e")),c=r("1889"),u=i["a"].extend({name:"Game",components:{},data:function(){return{loading:{fact:!1,answer:!1},game:{startTime:0,duration:0,timeLeft:1,fact:null,userAnswer:"",factShownTimestamp:0,correctAnswer:!1,showFeedback:!1,answerHistory:[],encounteredFlags:new Set},timerInterval:-1}},beforeDestroy:function(){clearInterval(this.timerInterval),document.removeEventListener("keypress",this.handleKey)},mounted:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.connected){t.next=4;break}return t.next=3,e.$router.push("/experiment");case 3:return t.abrupt("return",t.sent);case 4:return t.next=6,e.newGame();case 6:document.addEventListener("keypress",e.handleKey,!1);case 7:case"end":return t.stop()}}),t)})))()},methods:{handleKey:function(e){this.game.showFeedback&&"Enter"===e.key&&this.nextFact()},newGame:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$store.dispatch("resetModel",{subsetId:e.subsetId,enablePropagation:e.subsetId===e.$store.state.propagationSubsetId});case 2:return e.game.duration=60*e.sessionDuration,e.game.timeLeft=e.game.duration,e.game.startTime=performance.now(),t.next=7,e.nextFact();case 7:e.timerInterval=setInterval((function(){var t=(performance.now()-e.game.startTime)/1e3;e.game.timeLeft=e.game.duration-t,e.game.timeLeft<=0&&(e.game.timeLeft=0,e.stopGame())}),1e3);case 8:case"end":return t.stop()}}),t)})))()},stopGame:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var r,a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return clearInterval(e.timerInterval),r=(performance.now()-e.game.startTime)/1e3,a={duration:Math.min(e.game.duration,r),history:e.game.answerHistory,encounteredFlags:e.game.encounteredFlags},console.log("committing game result",a),t.next=6,e.$store.dispatch("getStats");case 6:return n=t.sent,console.log({modelStats:n}),e.$store.commit("setModelStat",{subsetId:e.subsetId,modelStats:n}),e.$store.commit("setLearnResult",{subsetId:e.subsetId,learnResult:a}),t.next=12,e.$router.push("/experiment/test-intro/".concat(e.subsetId));case 12:case"end":return t.stop()}}),t)})))()},nextFact:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var r,a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.game.userAnswer="",e.game.showFeedback=!1,e.loading.fact=!0,t.next=5,e.$store.dispatch("nextFact");case 5:e.game.fact=t.sent,e.game.encounteredFlags.add(null!==(r=null===(a=e.game.fact)||void 0===a?void 0:a.question)&&void 0!==r?r:"Unknown"),console.log({fact:e.game.fact}),e.loading.fact=!1,e.game.factShownTimestamp=performance.now(),n=e.$refs.userInput,n.focus();case 12:case"end":return t.stop()}}),t)})))()},answerFact:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var r,a,n,o,i,c,u,d,l,m,f,g,v;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading.answer=!0,i=performance.now()-e.game.factShownTimestamp,t.next=4,e.$store.dispatch("answerFact",{countryCode:null===(r=e.game.fact)||void 0===r?void 0:r.question,answer:e.game.userAnswer,responseTime:i});case 4:c=t.sent,u=[].concat(Object(s["a"])(e.game.answerHistory.map((function(e){return e.correct}))),[c]),d=u.reduce((function(e,t){return e+(t?1:0)}),0),l=d/u.length,m=5,f=u.slice(-m),g=f.reduce((function(e,t){return e+(t?1:0)}),0),v=g/f.length,e.game.answerHistory.push({rollingAccuracy:v,accuracy:l,countryCode:null!==(a=null===(n=e.game.fact)||void 0===n?void 0:n.question)&&void 0!==a?a:"",correct:c,responseTime:i,userAnswer:e.game.userAnswer}),console.log("answered fact",{countryCode:null===(o=e.game.fact)||void 0===o?void 0:o.question,answer:e.game.userAnswer,responseTime:i,correct:c}),e.game.correctAnswer=c,e.game.showFeedback=!0,e.loading.answer=!1;case 17:case"end":return t.stop()}}),t)})))()},toHms:function(e){return Object(c["b"])(e)}},computed:{subsetId:function(){return+this.$route.params.subsetId},countries:function(){return this.$store.state.countries},sessionDuration:function(){return this.$store.state.sessionDuration},connected:function(){return this.$store.state.connected},correctPercentage:function(){if(0===this.game.answerHistory.length)return 1;var e=this.game.answerHistory.reduce((function(e,t){return e+(t.correct?1:0)}),0);return e/this.game.answerHistory.length}}}),d=u,l=(r("4fe6"),r("2877")),m=r("6544"),f=r.n(m),g=r("8336"),v=r("b0af"),p=r("99d9"),h=r("ce7e"),w=r("132d"),b=r("adda"),x=r("8e36"),k=r("8dd9"),y=r("2fa4"),_=r("8654"),$=Object(l["a"])(d,a,n,!1,null,"b66193b4",null);t["default"]=$.exports;f()($,{VBtn:g["a"],VCard:v["a"],VCardActions:p["a"],VCardText:p["b"],VCardTitle:p["c"],VDivider:h["a"],VIcon:w["a"],VImg:b["a"],VProgressLinear:x["a"],VSheet:k["a"],VSpacer:y["a"],VTextField:_["a"]})},ce7e:function(e,t,r){"use strict";var a=r("5530"),n=(r("8ce9"),r("7560"));t["a"]=n["a"].extend({name:"v-divider",props:{inset:Boolean,vertical:Boolean},render:function(e){var t;return this.$attrs.role&&"separator"!==this.$attrs.role||(t=this.vertical?"vertical":"horizontal"),e("hr",{class:Object(a["a"])({"v-divider":!0,"v-divider--inset":this.inset,"v-divider--vertical":this.vertical},this.themeClasses),attrs:Object(a["a"])({role:"separator","aria-orientation":t},this.$attrs),on:this.$listeners})}})}}]);
//# sourceMappingURL=chunk-08bf9c86.e3340f96.js.map