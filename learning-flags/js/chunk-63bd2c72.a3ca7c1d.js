(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-63bd2c72"],{"0ccb":function(e,t,r){var n=r("50c4"),a=r("577e"),s=r("1148"),o=r("1d80"),c=Math.ceil,i=function(e){return function(t,r,i){var u,d,l=a(o(t)),m=l.length,f=void 0===i?" ":a(i),g=n(r);return g<=m||""==f?l:(u=g-m,d=s.call(f,c(u/f.length)),d.length>u&&(d=d.slice(0,u)),e?l+d:d+l)}};e.exports={start:i(!1),end:i(!0)}},1889:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));r("d3b7"),r("25f0"),r("4d90"),r("99af");function n(e){if(isNaN(e)||void 0===e)return"0:00";e=Math.round(e);var t=Math.floor(e/3600),r=Math.floor(e%3600/60),n=e%60,a=t.toString(),s=r.toString(),o=n.toString();return"0"!==a&&(s=s.padStart(2,"0"),o=o.padStart(2,"0")),o=o.padStart(2,"0"),"0"===a?"".concat(s,":").concat(o):"".concat(a,":").concat(s,":").concat(o)}},"20f6":function(e,t,r){},"2fa4":function(e,t,r){"use strict";r("20f6");var n=r("80d2");t["a"]=Object(n["g"])("spacer","div","v-spacer")},"4d90":function(e,t,r){"use strict";var n=r("23e7"),a=r("0ccb").start,s=r("9a0c");n({target:"String",proto:!0,forced:s},{padStart:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}})},6062:function(e,t,r){"use strict";var n=r("6d61"),a=r("6566");e.exports=n("Set",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),a)},"8ce9":function(e,t,r){},"9a0c":function(e,t,r){var n=r("342f");e.exports=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(n)},ba12:function(e,t,r){"use strict";r("eff8")},ce7e:function(e,t,r){"use strict";var n=r("5530"),a=(r("8ce9"),r("7560"));t["a"]=a["a"].extend({name:"v-divider",props:{inset:Boolean,vertical:Boolean},render:function(e){var t;return this.$attrs.role&&"separator"!==this.$attrs.role||(t=this.vertical?"vertical":"horizontal"),e("hr",{class:Object(n["a"])({"v-divider":!0,"v-divider--inset":this.inset,"v-divider--vertical":this.vertical},this.themeClasses),attrs:Object(n["a"])({role:"separator","aria-orientation":t},this.$attrs),on:this.$listeners})}})},d9c4:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"home",style:{flexDirection:e.$vuetify.breakpoint.mobile?"column":"row",alignItems:e.$vuetify.breakpoint.mobile?"stretch":"flex-start"}},[r("v-card",{staticClass:"left-card",class:e.$vuetify.breakpoint.width>1300?"rounded-xl":"",attrs:{elevation:"2"}},[r("v-card-title",[e._v("What flag is this?")]),r("v-divider"),e.game.fact?r("v-sheet",{staticClass:"flag",attrs:{color:"lightBackground"}},[r("v-img",{attrs:{contain:"",src:e.$store.getters.flagUrl(e.game.fact.question)}})],1):e._e(),r("v-divider"),r("v-card-text",[e.game.showFeedback?r("div",{staticClass:"feedback"},[""!==e.game.userAnswer?r("h4",[e._v('You answered "'+e._s(e.game.userAnswer)+'"')]):e._e(),e.game.correctAnswer&&e.game.fact?[r("v-icon",{attrs:{size:"100",color:"success"}},[e._v("mdi-check")]),r("h2",[e._v('Correct! The answer was "'+e._s(e.game.fact.answer)+'"')])]:e.game.fact?[r("v-icon",{attrs:{size:"100",color:"error"}},[e._v("mdi-alert-circle-outline")]),r("h2",[""!==e.game.userAnswer?r("span",[e._v("Wrong! ")]):e._e(),e._v(' The answer was "'+e._s(e.game.fact.answer)+'"')])]:e._e()],2):r("v-text-field",{ref:"userInput",attrs:{outlined:"",dense:"","hide-details":"",label:"Answer",placeholder:"For example: 'Netherlands'"},on:{keypress:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.answerFact.apply(null,arguments)}},model:{value:e.game.userAnswer,callback:function(t){e.$set(e.game,"userAnswer",t)},expression:"game.userAnswer"}})],1),r("v-card-actions",[r("v-spacer"),e.game.showFeedback?r("v-btn",{attrs:{rounded:"",color:"primary",loading:e.loading.fact},on:{click:e.nextFact}},[r("span",{staticClass:"ml-4 mr-4"},[e._v("Next fact")])]):r("v-btn",{attrs:{rounded:"",color:"primary",loading:e.loading.answer},on:{click:e.answerFact}},[""!==e.game.userAnswer?r("span",{staticClass:"ml-4 mr-4"},[e._v("Submit answer")]):r("span",{staticClass:"ml-4 mr-4"},[e._v("I don't know")])])],1)],1),r("v-card",{staticClass:"right-card",class:e.$vuetify.breakpoint.width>1300?"rounded-xl":"",style:{marginLeft:e.$vuetify.breakpoint.mobile?"0":"30px",width:e.$vuetify.breakpoint.mobile?"100%":"300px"},attrs:{elevation:"2"}},[r("v-card-title",[e._v("Session progress")]),r("v-card-text",[r("v-progress-linear",{attrs:{value:100-e.game.timeLeft/e.game.duration*100}}),r("div",{staticClass:"time-container mb-4"},[r("span",[e._v(e._s(e.toHms(e.game.timeLeft)))]),r("span",[e._v(e._s(e.toHms(e.game.duration)))])]),r("p",[e._v(e._s(e.game.encounteredFlags.size)+" / "+e._s(e.$store.state.factCount)+" flags encountered")]),r("p",[e._v(e._s(Math.round(100*e.correctPercentage))+"% correct")])],1),r("v-card-actions",[r("v-spacer"),r("v-btn",{attrs:{rounded:"",color:"primary"},on:{click:e.stopGame}},[r("span",{staticClass:"ml-4 mr-4"},[e._v("Stop session")])])],1)],1)],1)},a=[],s=r("2909"),o=r("1da1"),c=(r("96cf"),r("d3b7"),r("6062"),r("3ca3"),r("ddb0"),r("99af"),r("d81d"),r("fb6a"),r("2b0e")),i=r("1889"),u=c["a"].extend({name:"Game",components:{},data:function(){return{loading:{fact:!1,answer:!1},game:{startTime:0,duration:0,timeLeft:1,fact:null,userAnswer:"",factShownTimestamp:0,correctAnswer:!1,showFeedback:!1,answerHistory:[],encounteredFlags:new Set},randomFlags:[],timerInterval:-1}},beforeDestroy:function(){clearInterval(this.timerInterval),document.removeEventListener("keypress",this.handleKey)},mounted:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.connected){t.next=4;break}return t.next=3,e.$router.push("/");case 3:return t.abrupt("return",t.sent);case 4:return t.next=6,e.newGame();case 6:document.addEventListener("keypress",e.handleKey,!1);case 7:case"end":return t.stop()}}),t)})))()},methods:{handleKey:function(e){this.game.showFeedback&&"Enter"===e.key&&this.nextFact()},newGame:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.game.duration=60*e.sessionDuration,e.game.timeLeft=e.game.duration,e.game.startTime=performance.now(),t.next=5,e.nextFact();case 5:e.timerInterval=setInterval((function(){var t=(performance.now()-e.game.startTime)/1e3;e.game.timeLeft=e.game.duration-t,e.game.timeLeft<=0&&(e.game.timeLeft=0,e.stopGame())}),1e3);case 6:case"end":return t.stop()}}),t)})))()},stopGame:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var r,n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return clearInterval(e.timerInterval),r=(performance.now()-e.game.startTime)/1e3,n={duration:Math.min(e.game.duration,r),history:e.game.answerHistory,encounteredFlags:e.game.encounteredFlags},console.log("committing game result",n),t.next=6,e.$store.dispatch("getStats");case 6:return a=t.sent,e.$store.commit("setModelStat",{subsetId:null,modelStats:a}),e.$store.commit("setLearnResult",{subsetId:null,learnResult:n}),t.next=11,e.$router.push("/result");case 11:case"end":return t.stop()}}),t)})))()},nextFact:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var r,n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.game.userAnswer="",e.game.showFeedback=!1,e.loading.fact=!0,t.next=5,e.$store.dispatch("nextFact");case 5:e.game.fact=t.sent,e.game.encounteredFlags.add(null!==(r=null===(n=e.game.fact)||void 0===n?void 0:n.question)&&void 0!==r?r:"Unknown"),console.log({fact:e.game.fact}),e.loading.fact=!1,e.game.factShownTimestamp=performance.now(),a=e.$refs.userInput,a.focus();case 12:case"end":return t.stop()}}),t)})))()},answerFact:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var r,n,a,o,c,i,u,d,l,m,f,g,v;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading.answer=!0,c=performance.now()-e.game.factShownTimestamp,t.next=4,e.$store.dispatch("answerFact",{countryCode:null===(r=e.game.fact)||void 0===r?void 0:r.question,answer:e.game.userAnswer,responseTime:c});case 4:i=t.sent,u=[].concat(Object(s["a"])(e.game.answerHistory.map((function(e){return e.correct}))),[i]),d=u.reduce((function(e,t){return e+(t?1:0)}),0),l=d/u.length,m=5,f=u.slice(-m),g=f.reduce((function(e,t){return e+(t?1:0)}),0),v=g/f.length,e.game.answerHistory.push({rollingAccuracy:v,accuracy:l,countryCode:null!==(n=null===(a=e.game.fact)||void 0===a?void 0:a.question)&&void 0!==n?n:"",correct:i,responseTime:c,userAnswer:e.game.userAnswer}),console.log("answered fact",{countryCode:null===(o=e.game.fact)||void 0===o?void 0:o.question,answer:e.game.userAnswer,responseTime:c,correct:i}),e.game.correctAnswer=i,e.game.showFeedback=!0,e.loading.answer=!1;case 17:case"end":return t.stop()}}),t)})))()},toHms:function(e){return Object(i["a"])(e)}},computed:{countries:function(){return this.$store.state.countries},sessionDuration:function(){return this.$store.state.sessionDuration},connected:function(){return this.$store.state.connected},correctPercentage:function(){if(0===this.game.answerHistory.length)return 1;var e=this.game.answerHistory.reduce((function(e,t){return e+(t.correct?1:0)}),0);return e/this.game.answerHistory.length}}}),d=u,l=(r("ba12"),r("2877")),m=r("6544"),f=r.n(m),g=r("8336"),v=r("b0af"),h=r("99d9"),p=r("ce7e"),w=r("132d"),b=r("adda"),x=r("8e36"),k=r("8dd9"),y=r("2fa4"),_=r("8654"),$=Object(l["a"])(d,n,a,!1,null,"679cffed",null);t["default"]=$.exports;f()($,{VBtn:g["a"],VCard:v["a"],VCardActions:h["a"],VCardText:h["b"],VCardTitle:h["c"],VDivider:p["a"],VIcon:w["a"],VImg:b["a"],VProgressLinear:x["a"],VSheet:k["a"],VSpacer:y["a"],VTextField:_["a"]})},eff8:function(e,t,r){}}]);
//# sourceMappingURL=chunk-63bd2c72.a3ca7c1d.js.map