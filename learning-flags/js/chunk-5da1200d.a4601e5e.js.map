{"version":3,"sources":["webpack:///../../../src/components/VGrid/VSpacer.ts","webpack:///./node_modules/core-js/modules/es.set.js","webpack:///./src/views/game/Game.vue?09ab","webpack:///../../../src/components/VDivider/VDivider.ts","webpack:///./src/views/game/Game.vue?2afc","webpack:///./src/views/game/Game.vue","webpack:///./src/views/game/Game.vue?6ebc","webpack:///./src/views/game/Game.vue?5681"],"names":["collection","collectionStrong","module","exports","init","this","arguments","length","undefined","name","props","inset","vertical","Boolean","render","$attrs","role","orientation","h","class","themeClasses","attrs","on","$listeners","_vm","_h","$createElement","_c","_self","staticClass","style","flexDirection","$vuetify","breakpoint","mobile","alignItems","width","_v","game","$store","getters","flagUrl","fact","question","_e","showFeedback","userAnswer","_s","correctAnswer","answer","ref","$event","type","indexOf","_k","keyCode","key","answerFact","apply","model","value","callback","$$v","$set","expression","loading","nextFact","marginLeft","timeLeft","duration","toHms","encounteredFlags","size","state","factCount","Math","round","correctPercentage","stopGame","staticRenderFns","extend","components","data","startTime","factShownTimestamp","answerHistory","Set","randomFlags","timerInterval","beforeDestroy","clearInterval","document","removeEventListener","handleKey","mounted","connected","$router","push","newGame","addEventListener","methods","e","sessionDuration","performance","now","setInterval","elapsed","learnResult","min","history","console","log","dispatch","modelStats","commit","subsetId","add","userInput","$refs","focus","responseTime","countryCode","correct","correctHistory","map","a","correctCount","reduce","b","rollSize","slicedHistory","slice","rollCorrectCount","rollingAccuracy","accuracy","s","computed","countries","component","VBtn","VCard","VCardActions","VCardText","VCardTitle","VDivider","VIcon","VImg","VProgressLinear","VSheet","VSpacer","VTextField"],"mappings":"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","file":"js/chunk-5da1200d.a4601e5e.js","sourcesContent":["import './_grid.sass'\nimport { createSimpleFunctional } from '../../util/helpers'\n\nexport default createSimpleFunctional('spacer', 'div', 'v-spacer')\n","'use strict';\nvar collection = require('../internals/collection');\nvar collectionStrong = require('../internals/collection-strong');\n\n// `Set` constructor\n// https://tc39.es/ecma262/#sec-set-objects\nmodule.exports = collection('Set', function (init) {\n  return function Set() { return init(this, arguments.length ? arguments[0] : undefined); };\n}, collectionStrong);\n","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Game.vue?vue&type=style&index=0&id=679cffed&scoped=true&lang=css&\"","// Styles\nimport './VDivider.sass'\n\n// Types\nimport { VNode } from 'vue'\n\n// Mixins\nimport Themeable from '../../mixins/themeable'\n\nexport default Themeable.extend({\n  name: 'v-divider',\n\n  props: {\n    inset: Boolean,\n    vertical: Boolean,\n  },\n\n  render (h): VNode {\n    // WAI-ARIA attributes\n    let orientation\n    if (!this.$attrs.role || this.$attrs.role === 'separator') {\n      orientation = this.vertical ? 'vertical' : 'horizontal'\n    }\n    return h('hr', {\n      class: {\n        'v-divider': true,\n        'v-divider--inset': this.inset,\n        'v-divider--vertical': this.vertical,\n        ...this.themeClasses,\n      },\n      attrs: {\n        role: 'separator',\n        'aria-orientation': orientation,\n        ...this.$attrs,\n      },\n      on: this.$listeners,\n    })\n  },\n})\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"home\",style:({\n    flexDirection: _vm.$vuetify.breakpoint.mobile ? 'column' : 'row',\n    alignItems:  _vm.$vuetify.breakpoint.mobile ? 'stretch' : 'flex-start',\n})},[_c('v-card',{staticClass:\"left-card\",class:_vm.$vuetify.breakpoint.width > 1300 ? 'rounded-xl' : '',attrs:{\"elevation\":\"2\"}},[_c('v-card-title',[_vm._v(\"What flag is this?\")]),_c('v-divider'),(_vm.game.fact)?_c('v-sheet',{staticClass:\"flag\",attrs:{\"color\":\"lightBackground\"}},[_c('v-img',{attrs:{\"contain\":\"\",\"src\":_vm.$store.getters.flagUrl(_vm.game.fact.question)}})],1):_vm._e(),_c('v-divider'),_c('v-card-text',[(!_vm.game.showFeedback)?_c('v-text-field',{ref:\"userInput\",attrs:{\"outlined\":\"\",\"dense\":\"\",\"hide-details\":\"\",\"label\":\"Answer\",\"placeholder\":\"For example: 'Netherlands'\"},on:{\"keypress\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\")){ return null; }return _vm.answerFact.apply(null, arguments)}},model:{value:(_vm.game.userAnswer),callback:function ($$v) {_vm.$set(_vm.game, \"userAnswer\", $$v)},expression:\"game.userAnswer\"}}):_c('div',{staticClass:\"feedback\"},[(_vm.game.userAnswer !== '')?_c('h4',[_vm._v(\"You answered \\\"\"+_vm._s(_vm.game.userAnswer)+\"\\\"\")]):_vm._e(),(_vm.game.correctAnswer && _vm.game.fact)?[_c('v-icon',{attrs:{\"size\":\"100\",\"color\":\"success\"}},[_vm._v(\"mdi-check\")]),_c('h2',[_vm._v(\"Correct! The answer was \\\"\"+_vm._s(_vm.game.fact.answer)+\"\\\"\")])]:(_vm.game.fact)?[_c('v-icon',{attrs:{\"size\":\"100\",\"color\":\"error\"}},[_vm._v(\"mdi-alert-circle-outline\")]),_c('h2',[(_vm.game.userAnswer !== '')?_c('span',[_vm._v(\"Wrong! \")]):_vm._e(),_vm._v(\" The answer was \\\"\"+_vm._s(_vm.game.fact.answer)+\"\\\"\")])]:_vm._e()],2)],1),_c('v-card-actions',[_c('v-spacer'),(!_vm.game.showFeedback)?_c('v-btn',{attrs:{\"rounded\":\"\",\"color\":\"primary\",\"loading\":_vm.loading.answer},on:{\"click\":_vm.answerFact}},[(_vm.game.userAnswer !== '')?_c('span',{staticClass:\"ml-4 mr-4\"},[_vm._v(\"Submit answer\")]):_c('span',{staticClass:\"ml-4 mr-4\"},[_vm._v(\"I don't know\")])]):_c('v-btn',{attrs:{\"rounded\":\"\",\"color\":\"primary\",\"loading\":_vm.loading.fact},on:{\"click\":_vm.nextFact}},[_c('span',{staticClass:\"ml-4 mr-4\"},[_vm._v(\"Next fact\")])])],1)],1),_c('v-card',{staticClass:\"right-card\",class:_vm.$vuetify.breakpoint.width > 1300 ? 'rounded-xl' : '',style:({\n        marginLeft: _vm.$vuetify.breakpoint.mobile ? '0' : '30px',\n        width: _vm.$vuetify.breakpoint.mobile ? '100%' : '300px',\n    }),attrs:{\"elevation\":\"2\"}},[_c('v-card-title',[_vm._v(\"Session progress\")]),_c('v-card-text',[_c('v-progress-linear',{attrs:{\"value\":100 - _vm.game.timeLeft / _vm.game.duration * 100}}),_c('div',{staticClass:\"time-container mb-4\"},[_c('span',[_vm._v(_vm._s(_vm.toHms(_vm.game.timeLeft)))]),_c('span',[_vm._v(_vm._s(_vm.toHms(_vm.game.duration)))])]),_c('p',[_vm._v(_vm._s(_vm.game.encounteredFlags.size)+\" / \"+_vm._s(_vm.$store.state.factCount)+\" flags encountered\")]),_c('p',[_vm._v(_vm._s(Math.round(_vm.correctPercentage * 100))+\"% correct\")])],1),_c('v-card-actions',[_c('v-spacer'),_c('v-btn',{attrs:{\"rounded\":\"\",\"color\":\"primary\"},on:{\"click\":_vm.stopGame}},[_c('span',{staticClass:\"ml-4 mr-4\"},[_vm._v(\"Stop session\")])])],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\nimport Vue from 'vue'\r\nimport {secondsToHms} from \"@/ts/utils\";\r\nimport {EncounterResult, TestResult} from \"@/ts/types\";\r\n\r\nexport default Vue.extend({\r\n    name: 'Game',\r\n    components: {},\r\n    data: () => ({\r\n        loading: {\r\n            fact: false,\r\n            answer: false,\r\n        },\r\n        game: {\r\n            startTime: 0,\r\n            duration: 0,\r\n            timeLeft: 1,\r\n            fact: null as null | { fact_id: number, answer: string, question: string },\r\n            userAnswer: '',\r\n            factShownTimestamp: 0,\r\n            correctAnswer: false,\r\n            showFeedback: false,\r\n            answerHistory: [] as EncounterResult[],\r\n            encounteredFlags: new Set() as Set<string>,\r\n        },\r\n        randomFlags: [] as string[],\r\n        timerInterval: -1,\r\n    }),\r\n    beforeDestroy() {\r\n        clearInterval(this.timerInterval);\r\n        document.removeEventListener('keypress', this.handleKey);\r\n    },\r\n    async mounted() {\r\n        if (!this.connected)\r\n            return await this.$router.push('/');\r\n        await this.newGame();\r\n        document.addEventListener('keypress', this.handleKey, false);\r\n    },\r\n    methods: {\r\n        handleKey(e: KeyboardEvent) {\r\n            if (this.game.showFeedback && e.key === 'Enter') {\r\n                this.nextFact();\r\n            }\r\n        },\r\n        async newGame() {\r\n            this.game.duration = this.sessionDuration * 60;\r\n            this.game.timeLeft = this.game.duration;\r\n            this.game.startTime = performance.now();\r\n            await this.nextFact();\r\n            this.timerInterval = setInterval(() => {\r\n                let elapsed = (performance.now() - this.game.startTime) / 1000;\r\n                this.game.timeLeft = this.game.duration - elapsed;\r\n                if (this.game.timeLeft <= 0) {\r\n                    this.game.timeLeft = 0;\r\n                    this.stopGame();\r\n                }\r\n            }, 1000);\r\n        },\r\n        async stopGame() {\r\n            clearInterval(this.timerInterval);\r\n            let elapsed = (performance.now() - this.game.startTime) / 1000;\r\n            let learnResult: TestResult = {\r\n                duration: Math.min(this.game.duration, elapsed),\r\n                history: this.game.answerHistory,\r\n                encounteredFlags: this.game.encounteredFlags,\r\n            };\r\n            console.log('committing game result', learnResult);\r\n            let modelStats = await this.$store.dispatch('getStats');\r\n            this.$store.commit('setModelStat', {subsetId: null, modelStats})\r\n            this.$store.commit('setLearnResult', {subsetId: null, learnResult});\r\n            await this.$router.push('/result');\r\n        },\r\n        async nextFact() {\r\n            this.game.userAnswer = '';\r\n            this.game.showFeedback = false;\r\n            this.loading.fact = true;\r\n            this.game.fact = await this.$store.dispatch('nextFact');\r\n            this.game.encounteredFlags.add(this.game.fact?.question ?? 'Unknown');\r\n            console.log({fact: this.game.fact});\r\n            this.loading.fact = false;\r\n            this.game.factShownTimestamp = performance.now();\r\n            let userInput = this.$refs.userInput as any;\r\n            userInput.focus();\r\n        },\r\n        async answerFact() {\r\n            this.loading.answer = true;\r\n            let responseTime = performance.now() - this.game.factShownTimestamp;\r\n            let correct = await this.$store.dispatch('answerFact', {\r\n                countryCode: this.game.fact?.question,\r\n                answer: this.game.userAnswer,\r\n                responseTime,\r\n            }) as boolean;\r\n            // calculate correct percentage including this last fact\r\n            let correctHistory = [...this.game.answerHistory.map(a => a.correct), correct];\r\n            let correctCount = correctHistory.reduce((a, b) => a + (b ? 1 : 0), 0) as number;\r\n            let correctPercentage = correctCount / correctHistory.length;\r\n            let rollSize = 5;\r\n            let slicedHistory = correctHistory.slice(-rollSize);\r\n            let rollCorrectCount = slicedHistory.reduce((a, b) => a + (b ? 1 : 0), 0) as number;\r\n            let rollingAccuracy = rollCorrectCount / slicedHistory.length;\r\n            // add to history\r\n            this.game.answerHistory.push({\r\n                rollingAccuracy,\r\n                accuracy: correctPercentage,\r\n                countryCode: this.game.fact?.question ?? '',\r\n                correct,\r\n                responseTime,\r\n                userAnswer: this.game.userAnswer,\r\n            });\r\n            console.log(\"answered fact\", {\r\n                countryCode: this.game.fact?.question,\r\n                answer: this.game.userAnswer,\r\n                responseTime,\r\n                correct,\r\n            })\r\n            this.game.correctAnswer = correct;\r\n            this.game.showFeedback = true;\r\n            this.loading.answer = false;\r\n\r\n        },\r\n        toHms(s: number) {\r\n            return secondsToHms(s);\r\n        },\r\n    },\r\n    computed: {\r\n        countries(): { [key: string]: string }[] {\r\n            return this.$store.state.countries;\r\n        },\r\n        sessionDuration() {\r\n            return this.$store.state.sessionDuration;\r\n        },\r\n        connected() {\r\n            return this.$store.state.connected;\r\n        },\r\n        correctPercentage() {\r\n            if (this.game.answerHistory.length === 0) return 1;\r\n            let correctCount = this.game.answerHistory.reduce((a, b) => a + (b.correct ? 1 : 0), 0);\r\n            return correctCount / this.game.answerHistory.length;\r\n        },\r\n    },\r\n})\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--13-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Game.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--13-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Game.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./Game.vue?vue&type=template&id=679cffed&scoped=true&\"\nimport script from \"./Game.vue?vue&type=script&lang=ts&\"\nexport * from \"./Game.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./Game.vue?vue&type=style&index=0&id=679cffed&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"679cffed\",\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VBtn } from 'vuetify/lib/components/VBtn';\nimport { VCard } from 'vuetify/lib/components/VCard';\nimport { VCardActions } from 'vuetify/lib/components/VCard';\nimport { VCardText } from 'vuetify/lib/components/VCard';\nimport { VCardTitle } from 'vuetify/lib/components/VCard';\nimport { VDivider } from 'vuetify/lib/components/VDivider';\nimport { VIcon } from 'vuetify/lib/components/VIcon';\nimport { VImg } from 'vuetify/lib/components/VImg';\nimport { VProgressLinear } from 'vuetify/lib/components/VProgressLinear';\nimport { VSheet } from 'vuetify/lib/components/VSheet';\nimport { VSpacer } from 'vuetify/lib/components/VGrid';\nimport { VTextField } from 'vuetify/lib/components/VTextField';\ninstallComponents(component, {VBtn,VCard,VCardActions,VCardText,VCardTitle,VDivider,VIcon,VImg,VProgressLinear,VSheet,VSpacer,VTextField})\n"],"sourceRoot":""}