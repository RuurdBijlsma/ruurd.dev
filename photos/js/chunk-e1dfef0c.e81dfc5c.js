(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e1dfef0c"],{"0fbc":function(t,e,r){"use strict";r("fb1a")},"27c8":function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"trash",style:{maxHeight:"calc(100vh - "+(t.$vuetify.application.top+t.$vuetify.application.bottom)+"px)"}},[r("div",{staticClass:"container"},[t.trashItems.length>0?r("div",{staticClass:"trash-items"},[r("h2",{staticClass:"mb-4"},[t._v("Trash")]),r("div",{staticClass:"items"},t._l(t.trashItems,(function(e){return r("v-card",{key:e.filePath,staticClass:"mb-8",attrs:{"max-width":350}},[r("v-img",{attrs:{"max-height":200,src:t.api+"/photos/blocked/"+e.id}}),r("v-card-title",[t._v(t._s(e.filePath))]),r("v-card-subtitle",[t._v(" Deleted at "+t._s(t.formatDate(e.createdAt))+" ")]),r("v-card-actions",[r("v-spacer"),r("v-btn",{attrs:{loading:e.loading,icon:"",color:"primary"},on:{click:function(r){return t.downloadItem(e)}}},[r("v-icon",[t._v("mdi-download")])],1)],1)],1)})),1)]):r("h2",[t._v("No items in trash")]),t.errorItems.length>0?r("div",{staticClass:"failed-items mt-10"},[r("h2",{staticClass:"mb-4"},[t._v("Failed to process")]),r("div",{staticClass:"items"},t._l(t.errorItems,(function(e){return r("v-card",{key:e.filePath,staticClass:"mb-8",attrs:{"max-width":350}},[r("v-img",{attrs:{"max-height":200,src:t.api+"/photos/blocked/"+e.id}}),r("v-card-title",[t._v(t._s(e.filePath))]),r("v-card-subtitle",[t._v(" Failed at "+t._s(t.formatDate(e.createdAt))+" "),r("v-divider",{staticClass:"mt-2 mb-2"}),t._l(t.errorLines(e),(function(e){return r("p",{staticClass:"error-line"},[t._v(t._s(e))])}))],2),r("v-card-actions",[r("v-spacer"),r("v-btn",{attrs:{loading:e.loading,icon:"",color:"primary"},on:{click:function(r){return t.downloadItem(e)}}},[r("v-icon",[t._v("mdi-download")])],1),r("v-btn",{attrs:{loading:e.retrying,text:"",color:"primary"},on:{click:function(r){return t.retry(e)}}},[t._v("Retry")])],1)],1)})),1)]):t._e()])])},n=[],s=r("1da1"),i=(r("96cf"),r("4de4"),r("d3b7"),r("99af"),r("3ca3"),r("ddb0"),r("2b3d"),r("ac1f"),r("1276"),r("b166")),o=r("2b0e"),c=r("1a43"),d=o["default"].extend({name:"Trash",components:{},data:function(){return{trashItems:[],errorItems:[],api:c["a"]}},mounted:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$store.dispatch("apiRequest",{url:"photos/blockedItems"});case 2:r=e.sent,t.trashItems=r.filter((function(t){return"deleted"===t.reason})),t.errorItems=r.filter((function(t){return"error"===t.reason})),console.log(t.trashItems,t.errorItems);case 6:case"end":return e.stop()}}),e)})))()},methods:{retry:function(t){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){var a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return o["default"].set(t,"retrying",!0),r.next=3,e.$store.dispatch("apiRequest",{url:"photos/retryProcess",body:{filePath:t.filePath}});case 3:a=r.sent,!1===a.success?e.$store.dispatch("addSnack",{text:"Failed to process item again"}):e.$store.dispatch("addSnack",{text:"Processed item successfully",toText:"Visit",to:"/photo/".concat(a.id)}),o["default"].set(t,"retrying",!1);case 6:case"end":return r.stop()}}),r)})))()},downloadItem:function(t){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){var a,n,s,i;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return o["default"].set(t,"downloading",!0),r.prev=1,r.next=4,fetch("".concat(c["a"],"/photos/blocked/").concat(t.id)).then((function(t){return t.blob()}));case 4:if(a=r.sent,!("text/html"===a.type&&a.size<1e3)){r.next=8;break}throw e.$store.dispatch("addSnack",{text:"Item not found on server!"}),new Error("Not found");case 8:console.log(a),n=window.URL.createObjectURL(a),s=document.createElement("a"),s.style.display="none",s.href=n,i=t.filePath.split("/"),s.download=i[i.length-1],document.body.appendChild(s),s.click(),window.URL.revokeObjectURL(n),r.next=22;break;case 20:r.prev=20,r.t0=r["catch"](1);case 22:return r.prev=22,o["default"].set(t,"downloading",!1),r.finish(22);case 25:case"end":return r.stop()}}),r,null,[[1,20,22,25]])})))()},errorLines:function(t){var e,r,a,n;return null!==(e=null===t||void 0===t||null===(r=t.error)||void 0===r||null===(a=r.message)||void 0===a||null===(n=a.split)||void 0===n?void 0:n.call(a,"\n"))&&void 0!==e?e:[]},formatDate:function(t){return Object(i["a"])(new Date(t),"H:mm:ss, eeee dd MMMM yyyy")}}}),l=d,u=(r("0fbc"),r("2877")),m=r("6544"),f=r.n(m),h=r("8336"),v=r("b0af"),p=r("99d9"),b=r("ce7e"),w=r("132d"),g=r("adda"),y=r("2fa4"),k=Object(u["a"])(l,a,n,!1,null,"65533488",null);e["default"]=k.exports;f()(k,{VBtn:h["a"],VCard:v["a"],VCardActions:p["a"],VCardSubtitle:p["b"],VCardTitle:p["d"],VDivider:b["a"],VIcon:w["a"],VImg:g["a"],VSpacer:y["a"]})},fb1a:function(t,e,r){}}]);
//# sourceMappingURL=chunk-e1dfef0c.e81dfc5c.js.map