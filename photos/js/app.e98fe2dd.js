(function(t){function e(e){for(var o,r,s=e[0],c=e[1],u=e[2],h=0,l=[];h<s.length;h++)r=s[h],Object.prototype.hasOwnProperty.call(i,r)&&i[r]&&l.push(i[r][0]),i[r]=0;for(o in c)Object.prototype.hasOwnProperty.call(c,o)&&(t[o]=c[o]);d&&d(e);while(l.length)l.shift()();return a.push.apply(a,u||[]),n()}function n(){for(var t,e=0;e<a.length;e++){for(var n=a[e],o=!0,r=1;r<n.length;r++){var s=n[r];0!==i[s]&&(o=!1)}o&&(a.splice(e--,1),t=c(c.s=n[0]))}return t}var o={},r={app:0},i={app:0},a=[];function s(t){return c.p+"js/"+({}[t]||t)+"."+{"chunk-0cd461c3":"738fa00f","chunk-2d0b3289":"9d994aab","chunk-44141672":"5f7b13f6","chunk-725e9b4e":"a427a896","chunk-9702c420":"cd8a3488","chunk-78d9768a":"19fab167","chunk-9b896948":"78deab15","chunk-f6deb52a":"51cba86c"}[t]+".js"}function c(e){if(o[e])return o[e].exports;var n=o[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.e=function(t){var e=[],n={"chunk-0cd461c3":1,"chunk-725e9b4e":1,"chunk-9702c420":1,"chunk-78d9768a":1,"chunk-9b896948":1,"chunk-f6deb52a":1};r[t]?e.push(r[t]):0!==r[t]&&n[t]&&e.push(r[t]=new Promise((function(e,n){for(var o="css/"+({}[t]||t)+"."+{"chunk-0cd461c3":"da36ea11","chunk-2d0b3289":"31d6cfe0","chunk-44141672":"31d6cfe0","chunk-725e9b4e":"7e4dc92e","chunk-9702c420":"9ff6572d","chunk-78d9768a":"acf84abc","chunk-9b896948":"83d8f5af","chunk-f6deb52a":"d9dd8c3c"}[t]+".css",i=c.p+o,a=document.getElementsByTagName("link"),s=0;s<a.length;s++){var u=a[s],h=u.getAttribute("data-href")||u.getAttribute("href");if("stylesheet"===u.rel&&(h===o||h===i))return e()}var l=document.getElementsByTagName("style");for(s=0;s<l.length;s++){u=l[s],h=u.getAttribute("data-href");if(h===o||h===i)return e()}var d=document.createElement("link");d.rel="stylesheet",d.type="text/css",d.onload=e,d.onerror=function(e){var o=e&&e.target&&e.target.src||i,a=new Error("Loading CSS chunk "+t+" failed.\n("+o+")");a.code="CSS_CHUNK_LOAD_FAILED",a.request=o,delete r[t],d.parentNode.removeChild(d),n(a)},d.href=i;var m=document.getElementsByTagName("head")[0];m.appendChild(d)})).then((function(){r[t]=0})));var o=i[t];if(0!==o)if(o)e.push(o[2]);else{var a=new Promise((function(e,n){o=i[t]=[e,n]}));e.push(o[2]=a);var u,h=document.createElement("script");h.charset="utf-8",h.timeout=120,c.nc&&h.setAttribute("nonce",c.nc),h.src=s(t);var l=new Error;u=function(e){h.onerror=h.onload=null,clearTimeout(d);var n=i[t];if(0!==n){if(n){var o=e&&("load"===e.type?"missing":e.type),r=e&&e.target&&e.target.src;l.message="Loading chunk "+t+" failed.\n("+o+": "+r+")",l.name="ChunkLoadError",l.type=o,l.request=r,n[1](l)}i[t]=void 0}};var d=setTimeout((function(){u({type:"timeout",target:h})}),12e4);h.onerror=h.onload=u,document.head.appendChild(h)}return Promise.all(e)},c.m=t,c.c=o,c.d=function(t,e,n){c.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},c.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},c.t=function(t,e){if(1&e&&(t=c(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)c.d(n,o,function(e){return t[e]}.bind(null,o));return n},c.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return c.d(e,"a",e),e},c.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},c.p="/photos/",c.oe=function(t){throw console.error(t),t};var u=window["webpackJsonp"]=window["webpackJsonp"]||[],h=u.push.bind(u);u.push=e,u=u.slice();for(var l=0;l<u.length;l++)e(u[l]);var d=h;a.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("cd49")},"034f":function(t,e,n){"use strict";n("85ec")},1882:function(t,e,n){},1889:function(t,e,n){"use strict";n.d(e,"c",(function(){return r})),n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return a})),n.d(e,"d",(function(){return s}));var o=n("3835");n("ac1f"),n("466d"),n("99af"),n("6b93"),n("b680"),n("d3b7"),n("25f0"),n("4d90");function r(){var t=document.createElement("div");t.style.visibility="hidden",t.style.overflow="scroll",t.style.msOverflowStyle="scrollbar",document.body.appendChild(t);var e=document.createElement("div");t.appendChild(e);var n=t.offsetWidth-e.offsetWidth;return t.parentNode.removeChild(t),n}function i(t){var e=t.match(/(^|[^0-9])(\d\d\d\d)-(\d\d)-(\d\d)[^0-9]/);if(e){var n=e,r=Object(o["a"])(n,5),i=r[2],a=r[3],s=r[4];return new Date("".concat(i,"-").concat(a,"-").concat(s," 15:00:00"))}if(e=t.match(/(^|[^0-9])([21]\d\d\d)(\d\d)(\d\d)[^0-9](\d\d)(\d\d)(\d\d)/),e){var c=e,u=Object(o["a"])(c,8),h=u[2],l=u[3],d=u[4],m=u[5],p=u[6],f=u[7];return new Date("".concat(h,"-").concat(l,"-").concat(d," ").concat(m,":").concat(p,":").concat(f))}if(e=t.match(/(^|[^0-9])([21]\d\d\d)(\d\d)(\d\d)[^0-9]/),e){var v=e,b=Object(o["a"])(v,5),g=b[2],y=b[3],w=b[4];return new Date("".concat(g,"-").concat(y,"-").concat(w," 15:00:00"))}return null}function a(t){var e=Math.log10(t);return e<3?t+" B":e<6?(t/1024).toFixed(1)+" kB":e<9?(t/Math.pow(1024,2)).toFixed(2)+" MB":e<12?(t/Math.pow(1024,3)).toFixed(2)+" GB":e<15?(t/Math.pow(1024,4)).toFixed(2)+" TB":"very bige bytes"}function s(t){if(isNaN(t)||void 0===t)return"0:00";t=Math.round(t);var e=Math.floor(t/3600),n=Math.floor(t%3600/60),o=t%60,r=e.toString(),i=n.toString(),a=o.toString();return"0"!==r&&(i=i.padStart(2,"0"),a=a.padStart(2,"0")),a=a.padStart(2,"0"),"0"===r?"".concat(i,":").concat(a):"".concat(r,":").concat(i,":").concat(a)}},"1a43":function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return i})),n.d(e,"d",(function(){return a})),n.d(e,"c",(function(){return s}));var o=n("1889"),r="https://api.ruurd.dev",i=["January","February","March","April","May","June","July","August","September","October","November","December"],a=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],s=Object(o["c"])()},"1bbf":function(t,e,n){"use strict";n("9579")},2252:function(t,e,n){t.exports=n.p+"img/transparent-color-icon-256.7963b11c.png"},"45c0":function(t,e,n){},4824:function(t,e,n){"use strict";n("e2b2")},5024:function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"photo-grid roboto"},t._l(t.photoRows,(function(e){return n("div",{staticClass:"photo-row"},t._l(e.layoutBlocks,(function(e){return n("div",{staticClass:"photo-block",style:{marginRight:t.grid.blockMarginRight+"px"}},[e.showDate?n("div",{staticClass:"block-date",style:{maxWidth:Math.floor(e.width)+"px"},attrs:{title:e.dateString}},[n("router-link",{staticClass:"no-style",attrs:{to:"/?date="+t.formatDate(e.date,"yyyy-MM-dd")}},[t._v(" "+t._s(e.dateString)+" ")])],1):t._e(),t._l(e.layoutMedias,(function(e){return n("grid-photo",{key:e.media.id,staticClass:"grid-photo",style:{marginRight:t.grid.mediaMargin+"px"},attrs:{"layout-media":e}})}))],2)})),0)})),0)},r=[],i=n("b85c"),a=n("1da1"),s=(n("96cf"),n("a9e3"),n("d81d"),n("5db7"),n("73d9"),n("8a79"),n("1a43")),c=n("2b0e"),u=n("b166"),h=n("1556"),l=n("a2e1"),d=new Date,m=c["a"].extend({name:"PhotoGrid",components:{GridPhoto:l["a"]},props:{usableWidth:{type:Number,required:!0},photos:{type:Array,required:!0}},data:function(){return{api:s["a"],photoRows:[],calculateTimeout:-1}},mounted:function(){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.calculateLayout(),t.$emit("ready",t.height);case 2:case"end":return e.stop()}}),e)})))()},methods:{formatDate:function(t,e){return"number"===typeof t&&(t=new Date(t)),Object(u["a"])(t,e)},dateToString:function(t){if(d.getTime()-t.getTime()<432e6)return Object(h["a"])(t,d,{addSuffix:!0});var e="E, d MMM";return t.getFullYear()!==d.getFullYear()&&(e+=" y"),Object(u["a"])(t,e)},calculateLayout:function(){var t,e=this,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0],o=this.photos.map((function(t){return{visualWidth:0,visualHeight:0,media:t}})),r=[],a=null,s=Object(i["a"])(o);try{for(s.s();!(t=s.n()).done;){var c=t.value,u=c.media,h=this.grid.blockHeight*u.width/u.height;c.visualHeight=this.grid.blockHeight,c.visualWidth=h;var l=u.createDate,d=this.dateToString(l);if(null!==a&&a.dateString===d)a.layoutMedia.push(c),a.guessedWidth+=h+=this.grid.mediaMargin;else{var m={layoutMedia:[c],date:l,dateString:d,guessedWidth:h};r.push(m),a=m}}}catch(F){s.e(F)}finally{s.f()}for(var p=[],f=null,v=null,b=this.usableWidth,g=0,y=r;g<y.length;g++){var w,x=y[g],k=Object(i["a"])(x.layoutMedia);try{for(k.s();!(w=k.n()).done;){var M=w.value,P="";null!==v&&(P=v.dateString);var S=P===x.dateString,T=b+this.grid.speling<M.visualWidth||!S&&x.layoutMedia.length>3;if(null===v||null===f||T){var R=null===v;v={layoutMedias:[M],date:x.date,dateString:x.dateString,showDate:!S||R,width:M.visualWidth,height:this.grid.blockHeight},f={height:v.height,width:v.width,layoutBlocks:[v],hasDate:v.showDate},b=this.usableWidth-M.visualWidth,p.push(f)}else S?(v.width+=M.visualWidth,f.width+=M.visualWidth,v.layoutMedias.push(M),b-=M.visualWidth):(v={layoutMedias:[M],date:x.date,dateString:x.dateString,showDate:!0,width:M.visualWidth,height:this.grid.blockHeight},b-=M.visualWidth,f.layoutBlocks.push(v),f.width+=v.width,f.hasDate=!0)}}catch(F){k.e(F)}finally{k.f()}}for(var $=0,D=p;$<D.length;$++){var E=D[$],O=this.grid.mediaMargin*E.layoutBlocks.flatMap((function(t){return t.layoutMedias.length-1})).reduce((function(t,e){return t+e}),0),C=this.grid.blockMarginRight*(E.layoutBlocks.length-1),j=(this.usableWidth-O-C)/E.width;j>this.grid.maxScale&&(j=1),E.height*=j;var _,q=0,I=Object(i["a"])(E.layoutBlocks);try{for(I.s();!(_=I.n()).done;){var V,H=_.value,L=0,N=Object(i["a"])(H.layoutMedias);try{for(N.s();!(V=N.n()).done;){var A=V.value;A.visualWidth*=j,A.visualHeight=E.height,L+=A.visualWidth}}catch(F){N.e(F)}finally{N.f()}H.height=E.height+(E.hasDate?this.grid.blockDateHeight:0),H.width=L+(H.layoutMedias.length-1)*this.grid.mediaMargin,q+=H.width}}catch(F){I.e(F)}finally{I.f()}E.hasDate&&(E.height+=this.grid.blockDateHeight),E.width=q+(E.layoutBlocks.length-1)*this.grid.blockMarginRight}this.photoRows=p,n&&this.$nextTick((function(){return e.$emit("resizeReady",e.height)}))},scrollMediaIntoView:function(t){if(null!==t){var e=document.querySelector(".p".concat(t.id));null!==e&&e.scrollIntoView({block:"center"})}},scrollDateIntoView:function(t){var e,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=1/0,r=null,a=n?t.getDate():t.getTime(),s=Object(i["a"])(this.photoRows);try{t:for(s.s();!(e=s.n()).done;){var c,u=e.value,h=Object(i["a"])(u.layoutBlocks);try{for(h.s();!(c=h.n()).done;){var l,d=c.value,m=n?d.date.getDate():d.date.getTime(),p=Math.abs(a-m);if(!(p<=o))break t;if(o=p,r=null===(l=d.layoutMedias[0])||void 0===l?void 0:l.media,0===p)break t}}catch(f){h.e(f)}finally{h.f()}}}catch(f){s.e(f)}finally{s.f()}null!==r&&this.scrollMediaIntoView(r)}},computed:{grid:function(){return this.$vuetify.breakpoint.mobile?{blockMarginRight:10,blockDateHeight:40,mediaMargin:3,blockHeight:200,speling:150,maxScale:2}:{blockMarginRight:40,blockDateHeight:40,mediaMargin:5,blockHeight:240,speling:80,maxScale:1.73}},height:function(){return this.photoRows.map((function(t){return t.height})).reduce((function(t,e){return t+e}),0)+this.photoRows.length*this.grid.mediaMargin},currentPath:function(){var t=this.$route.path;return t.endsWith("/")?t.substr(0,t.length-1):t}},watch:{usableWidth:function(){var t=this;clearTimeout(this.calculateTimeout),this.calculateTimeout=setTimeout((function(){requestAnimationFrame((function(){return t.calculateLayout(!0)}))}),50)},photos:function(){var t=this;requestAnimationFrame((function(){return t.calculateLayout(!0)}))},grid:function(){var t=this;requestAnimationFrame((function(){return t.calculateLayout(!0)}))}}}),p=m,f=(n("6bc1"),n("2877")),v=Object(f["a"])(p,o,r,!1,null,"3b6387ce",null);e["a"]=v.exports},5776:function(t,e,n){"use strict";n("bde1")},"6bc1":function(t,e,n){"use strict";n("a422")},"85ec":function(t,e,n){},"8daa":function(t,e,n){"use strict";n("1882")},9579:function(t,e,n){},a2e1:function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("router-link",{staticClass:"photo",class:"p"+t.media.id,style:{height:t.layoutMedia.visualHeight+"px",width:t.layoutMedia.visualWidth+"px"},attrs:{to:t.currentPath+"/photo/"+t.media.id}},["photo"===t.media.type?n("div",{staticClass:"image-container"},[n("div",{staticClass:"image-background",style:{backgroundImage:"url("+t.getThumbUrl(t.media.id,t.layoutMedia.visualHeight)+")"}}),n("div",{staticClass:"image-overlay"},[n("div",{staticClass:"image-info"},["vr"===t.media.subType?n("v-icon",{staticClass:"icon",attrs:{color:"white"}},[t._v(" mdi-rotate-3d-variant ")]):"portrait"===t.media.subType?n("v-icon",{staticClass:"icon",attrs:{color:"white"}},[t._v(" mdi-blur ")]):t._e()],1)])]):n("div",{staticClass:"video-container",on:{touchstart:t.playVideo,touchend:t.pauseVideo,mouseleave:function(e){return t.pauseVideo()},mouseenter:function(e){return t.playVideo()}}},[n("video",{ref:"video",attrs:{poster:""+t.getThumbUrl(t.media.id,t.layoutMedia.visualHeight),muted:"",loop:"",src:t.api+"/photo/webm/"+t.media.id+".webm"},domProps:{muted:!0}}),n("div",{staticClass:"video-overlay"},[n("div",{staticClass:"video-info"},[n("span",{staticClass:"video-duration"},[t._v(t._s(t.toHms(t.media.duration/1e3)))]),"none"===t.media.subType?n("v-icon",{staticClass:"icon",attrs:{color:"white"}},[t._v(" mdi-play-circle-outline ")]):"slomo"===t.media.subType?n("v-icon",{staticClass:"icon",attrs:{color:"white"}},[t._v(" mdi-play-speed ")]):t._e()],1)])])])},r=[],i=(n("99af"),n("8a79"),n("2b0e")),a=n("1a43"),s=n("1889"),c=n("b166"),u=i["a"].extend({name:"GridPhoto",props:{layoutMedia:{type:Object,required:!0}},data:function(){return{api:a["a"]}},methods:{playVideo:function(){var t,e=this.$refs.video;null===e||void 0===e||null===(t=e.play)||void 0===t||t.call(e)},pauseVideo:function(){var t,e=this.$refs.video;null===e||void 0===e||null===(t=e.pause)||void 0===t||t.call(e)},formatDate:function(t,e){return"number"===typeof t&&(t=new Date(t)),Object(c["a"])(t,e)},getThumbUrl:function(t,e){var n="tiny";return e>260&&(n="small"),e>500&&(n="big"),"".concat(a["a"],"/photo/").concat(n,"/").concat(t,".webp")},toHms:function(t){return Object(s["d"])(t)}},computed:{media:function(){return this.layoutMedia.media},currentPath:function(){var t=this.$route.path;return t.endsWith("/")?t.substr(0,t.length-1):t}},watch:{}}),h=u,l=(n("bec8"),n("2877")),d=n("6544"),m=n.n(d),p=n("132d"),f=Object(l["a"])(h,o,r,!1,null,"0d5b4d88",null);e["a"]=f.exports;m()(f,{VIcon:p["a"]})},a422:function(t,e,n){},b0d1:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var o=n("b85c"),r=n("d4ec"),i=n("bee2"),a=(n("d81d"),n("07ac"),n("caad"),function(){function t(e,n,o,i,a,s,c){var u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,h=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,l=arguments.length>9&&void 0!==arguments[9]?arguments[9]:null,d=arguments.length>10&&void 0!==arguments[10]?arguments[10]:null,m=arguments.length>11&&void 0!==arguments[11]?arguments[11]:{};Object(r["a"])(this,t),this.id=e,this.filename=n,this.createDate=o,this.width=i,this.height=a,this.type=s,this.duration=u,this.subType=c,this.classifications=h,this.location=l,this.size=d,this.exif=m}return Object(i["a"])(t,[{key:"ratio",get:function(){return 0===this.height?1:this.width/this.height}}],[{key:"fromObject",value:function(e){var n,r,i=e.id,a=void 0===i?"":i,s=e.filename,c=void 0===s?"":s,u=e.createDate,h=void 0===u?-1:u,l=e.width,d=void 0===l?0:l,m=e.height,p=void 0===m?0:m,f=e.type,v=void 0===f?"":f,b=e.subType,g=void 0===b?"":b,y=e.durationMs,w=void 0===y?null:y,x=e.MediaClassifications,k=void 0===x?null:x,M=e.MediaLocation,P=void 0===M?null:M,S=e.bytes,T=void 0===S?"-1":S,R=e.exif,$=void 0===R?{}:R;g=g.toLowerCase(),v=v.toLowerCase();var D=P?{latitude:P.latitude,longitude:P.longitude,altitude:P.altitude,places:null===(n=P.MediaPlaces)||void 0===n||null===(r=n.map)||void 0===r?void 0:r.call(n,(function(t){return{type:t.type,name:t.text}}))}:null,E=k?k.map((function(t){var e,n={},r=Object(o["a"])(t.MediaGlossaries);try{for(r.s();!(e=r.n()).done;){var i=e.value,a=i.level,s=i.text;n[a]={glossary:s,level:a}}}catch(m){r.e(m)}finally{r.f()}var c,u=Object(o["a"])(t.MediaLabels);try{for(u.s();!(c=u.n()).done;){var h=c.value,l=h.level,d=h.text;n[l].labels||(n[l].labels=[]),n[l].labels.push(d)}}catch(m){u.e(m)}finally{u.f()}return{confidence:t.confidence,levels:Object.values(n)}})):null;return new t(a,c,new Date(h),d,p,"image"===v?"photo":"video",["portrait","vr","slomo"].includes(g)?g:"none",w,E,D,isFinite(+T)?+T:null,$)}}]),t}())},bde1:function(t,e,n){},bec8:function(t,e,n){"use strict";n("45c0")},cd49:function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var o=n("2b0e"),r=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("v-app",{staticClass:"app"},[o("v-app-bar",{attrs:{elevation:"0",app:"","clipped-left":""}},[o("img",{staticClass:"logo-icon",attrs:{src:n("2252"),alt:"icon"}}),t.$vuetify.breakpoint.width>500?o("v-app-bar-title",{staticClass:"logo-text"},[t._v("Photos ")]):t._e(),o("v-spacer"),o("v-autocomplete",{ref:"search",attrs:{solo:"",dense:"","hide-details":"",label:""===t.searchTip?"Search...":'Search "'+t.searchTip+'"',"prepend-inner-icon":"mdi-magnify","append-icon":"","hide-no-data":"",loading:t.loadingSuggestions,items:t.items,clearable:"","return-object":"","search-input":t.query},on:{keypress:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.enterPressed(e)},"update:searchInput":function(e){t.query=e},"update:search-input":function(e){t.query=e}},model:{value:t.querySelect,callback:function(e){t.querySelect=e},expression:"querySelect"}}),o("v-spacer"),o("v-menu",{attrs:{"close-on-content-click":!1},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on,r=e.attrs;return[o("v-btn",{attrs:{icon:""}},[o("v-icon",t._g(t._b({},"v-icon",r,!1),n),[t._v("mdi-cog-outline")])],1)]}}])},[o("v-list",{attrs:{dense:""}},[o("v-list-item",{attrs:{to:"/settings"}},[o("v-list-item-icon",[o("v-icon",[t._v("mdi-cog")])],1),o("v-list-item-content",[o("v-list-item-title",[t._v("Settings")])],1)],1),o("v-list-item",{attrs:{color:"primary"}},[o("v-list-item-icon",[o("v-icon",[t._v("mdi-brightness-6")])],1),o("v-list-item-content",[o("v-list-item-title",{staticClass:"theme-switch"},[o("span",[t._v("Dark theme")])])],1),o("v-list-item-action",[o("v-switch",{attrs:{dense:"",inset:""},model:{value:t.$vuetify.theme.dark,callback:function(e){t.$set(t.$vuetify.theme,"dark",e)},expression:"$vuetify.theme.dark"}})],1)],1)],1)],1)],1),t.$vuetify.breakpoint.mobile?t._e():o("v-navigation-drawer",{attrs:{"expand-on-hover":t.$vuetify.breakpoint.width<1600,permanent:"",app:"",floating:"",clipped:"","hide-overlay":""}},[o("v-list",{attrs:{dense:"",nav:""}},t._l(t.pages,(function(e){return o("v-list-item",{key:e.to,attrs:{exact:"",to:e.to},on:{click:t.scrollToTop}},[o("v-list-item-icon",[o("v-icon",[t._v(t._s(e.icon))])],1),o("v-list-item-content",[o("v-list-item-title",[t._v(t._s(e.name))])],1)],1)})),1)],1),o("v-main",[o("router-view")],1),t._l(t.$store.state.snackbars,(function(e){return o("v-snackbar",{key:e.id,attrs:{app:"",timeout:e.timeout,color:"secondary"},scopedSlots:t._u([{key:"action",fn:function(n){var r=n.attrs;return[o("v-btn",t._b({attrs:{text:""},on:{click:function(t){e.open=!1}}},"v-btn",r,!1),[t._v(" Dismiss ")])]}}],null,!0),model:{value:e.open,callback:function(n){t.$set(e,"open",n)},expression:"snack.open"}},[t._v(" "+t._s(e.text)+" ")])})),o("custom-dialog"),t.$vuetify.breakpoint.mobile?o("v-bottom-navigation",{attrs:{app:"",shift:""}},t._l(t.pages,(function(e){return o("v-btn",{key:e.to,style:{height:"inherit !important"},attrs:{to:e.to},on:{click:t.scrollToTop}},[o("span",[t._v(t._s(e.name))]),o("v-icon",[t._v(t._s(e.icon))])],1)})),1):t._e()],2)},i=[],a=n("b85c"),s=n("2909"),c=n("1da1"),u=(n("96cf"),n("b0c0"),n("ac1f"),n("841c"),n("d81d"),n("caad"),n("2532"),n("99af"),n("4de4"),n("1276"),n("2ca0"),n("c740"),n("1a43")),h=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-dialog",{attrs:{width:"500"},model:{value:t.prompt.show,callback:function(e){t.$set(t.prompt,"show",e)},expression:"prompt.show"}},[n("v-card",[n("v-card-title",{domProps:{innerHTML:t._s(t.prompt.title)}}),n("v-card-text",{domProps:{innerHTML:t._s(t.prompt.subtitle)}}),n("v-divider"),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{text:""},on:{click:t.dialogCancel}},[t._v(" "+t._s(t.prompt.cancelText)+" ")]),n("v-btn",{attrs:{color:"primary",text:""},on:{click:t.dialogConfirm}},[t._v(" "+t._s(t.prompt.confirmText)+" ")])],1)],1)],1)},l=[],d={name:"CustomDialog",methods:{dialogCancel:function(){this.$store.commit("hidePrompt")},dialogConfirm:function(){this.$store.commit("hidePrompt"),this.prompt.onConfirm()}},watch:{"prompt.show":function(){this.prompt.show||this.prompt.onCancel()}},computed:{prompt:function(){return this.$store.state.prompt}}},m=d,p=n("2877"),f=n("6544"),v=n.n(f),b=n("8336"),g=n("b0af"),y=n("99d9"),w=n("169a"),x=n("ce7e"),k=n("2fa4"),M=Object(p["a"])(m,h,l,!1,null,"c70abdd6",null),P=M.exports;v()(M,{VBtn:b["a"],VCard:g["a"],VCardActions:y["a"],VCardText:y["b"],VCardTitle:y["c"],VDialog:w["a"],VDivider:x["a"],VSpacer:k["a"]});var S=o["a"].extend({name:"App",components:{CustomDialog:P},data:function(){return{searchTip:"",query:"",querySelect:null,loadingSuggestions:!1,items:[],pages:[{name:"Home",icon:"mdi-home-outline",to:"/"},{name:"Explore",icon:"mdi-magnify",to:"/explore"},{name:"Photo map",icon:"mdi-earth",to:"/map"}]}},mounted:function(){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.$store.getters.isLoggedIn||"Login"===t.$route.name){e.next=3;break}return e.next=3,t.$router.push("/login");case 3:t.$route.params.query&&(t.query=t.$route.params.query,t.items=[t.query],t.querySelect=t.query),t.$store.dispatch("apiRequest",{url:"photos/searchTip"}).then((function(e){var n;return t.searchTip=null!==(n=null===e||void 0===e?void 0:e.text)&&void 0!==n?n:""})),console.log(t.$store);case 6:case"end":return e.stop()}}),e)})))()},methods:{scrollToTop:function(){"Home"===this.$route.name&&this.$store.commit("scrollToTop",!0)},enterPressed:function(){this.querySelect=this.query;var t=this.$refs.search;t.isMenuActive=!1},loadSuggestions:function(){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function e(){var n,o,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.loadingSuggestions=!0,t.items=[t.query],t.loadingSuggestions=!1,n=t.query,e.next=6,t.$store.dispatch("apiRequest",{url:"photos/suggestions?q=".concat(n)});case 6:o=e.sent,r=o.map((function(t){return t.text})),r.includes(n)||r.unshift(n),t.items=r;case 10:case"end":return e.stop()}}),e)})))()},isDate:function(t){var e=t.toLowerCase(),n=[].concat(Object(s["a"])(u["b"]),Object(s["a"])(u["d"])).map((function(t){return t.toLowerCase()}));if(n.includes(e))return{type:"month",month:n.indexOf(e)%12+1};var o=e.split(/[- _\/]/).filter((function(t){return 0!==t.length}));if(2!==o.length)return{type:"none"};var r=n.includes(o[0]),i=n.includes(o[1]),a=+o[1]>12&&+o[0]<=12;return r&&+o[1]<=31&&+o[1]>=0?{type:"dayMonth",month:n.indexOf(o[0])%12+1,day:+o[1]}:i&&+o[0]<=31&&+o[0]>=0?{type:"dayMonth",month:n.indexOf(o[1])%12+1,day:+o[0]}:a&&+o[0]<=12&&+o[0]>=0&&+o[1]<=31&&+o[1]>=0?{type:"dayMonth",month:+o[0],day:+o[1]}:+o[0]<=31&&+o[0]>=0&&+o[1]<=12&&+o[1]>=0?{type:"dayMonth",month:+o[1],day:+o[0]}:{type:"none"}},isScrubDate:function(t){var e=!isNaN(+t[0]);if(!e){var n,o=!1,r=Object(a["a"])(u["d"]);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(t.startsWith(i)){o=!0;break}}}catch(c){r.e(c)}finally{r.f()}if(!o)return{isDate:!1,date:new Date}}var s=new Date(t);return{isDate:!isNaN(s.getDate()),date:s}},startSearch:function(){if(""!==this.querySelect&&void 0!==this.querySelect&&null!==this.querySelect){var t=null,e=this.isDate(this.querySelect),n=e.type,o=e.month,r=e.day;if("month"===n)t="/date/".concat(u["b"][(null!==o&&void 0!==o?o:1)-1]);else if("dayMonth"===n)t="/date/".concat(r,"/").concat(u["b"][(null!==o&&void 0!==o?o:1)-1]);else{var i=this.isScrubDate(this.querySelect),a=i.isDate,s=i.date;t=a?"/?date=".concat(s.getFullYear(),"-").concat(s.getMonth()+1,"-").concat(s.getDate()):(this.$route.name,"/search/".concat(this.querySelect))}this.$route.path!==t&&null!==t&&this.$router.push(t)}},page:function(){var t=this;return this.pages.findIndex((function(e){return e.to===t.$route.path}))}},watch:{"$vuetify.theme.dark":function(){localStorage.darkTheme=this.$vuetify.theme.dark},querySelect:function(t){null!==t&&this.startSearch()},query:function(t){t&&t!==this.querySelect&&this.loadSuggestions()},"$route.params.query":function(){this.query=this.$route.params.query,this.querySelect=this.query}}}),T=S,R=(n("034f"),n("7496")),$=n("40dc"),D=n("bb78"),E=n("c6a6"),O=n("b81c"),C=n("132d"),j=n("8860"),_=n("da13"),q=n("1800"),I=n("5d23"),V=n("34c3"),H=n("f6c4"),L=n("e449"),N=n("f774"),A=n("2db4"),F=n("b73d"),W=Object(p["a"])(T,r,i,!1,null,null,null),z=W.exports;v()(W,{VApp:R["a"],VAppBar:$["a"],VAppBarTitle:D["a"],VAutocomplete:E["a"],VBottomNavigation:O["a"],VBtn:b["a"],VIcon:C["a"],VList:j["a"],VListItem:_["a"],VListItemAction:q["a"],VListItemContent:I["a"],VListItemIcon:V["a"],VListItemTitle:I["c"],VMain:H["a"],VMenu:L["a"],VNavigationDrawer:N["a"],VSnackbar:A["a"],VSpacer:k["a"],VSwitch:F["a"]});var B=n("9483");Object(B["a"])("".concat("/photos/","service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered:function(){console.log("Service worker has been registered.")},cached:function(){console.log("Content has been cached for offline use.")},updatefound:function(){console.log("New content is downloading.")},updated:function(){console.log("New content is available; please refresh.")},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(t){console.error("Error during service worker registration:",t)}});n("d3b7"),n("3ca3"),n("ddb0"),n("7db0"),n("fb6a"),n("a15b"),n("a630");var G=n("8c4f"),Y=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"home",staticClass:"home",style:{maxHeight:"calc(100vh - "+(t.$vuetify.application.top+t.$vuetify.application.bottom)+"px)",padding:t.pagePadding+"px"},attrs:{id:"home-element"}},[n("router-view"),n("div",{staticClass:"photos",style:{width:"calc(100% - "+t.scrubberWidth+"px)"}},t._l(t.photosPerMonth,(function(e,o){return n("div",{directives:[{name:"intersect",rawName:"v-intersect",value:function(){var e=[],n=arguments.length;while(n--)e[n]=arguments[n];return t.applyLazy.apply(void 0,[o].concat(e))},expression:"(...args) => applyLazy(i, ...args)"}],key:e.id,staticClass:"lazy-month",style:{height:t.photosPerMonth[o].ready?"auto":t.photosPerMonth[o].height+"px",backgroundImage:t.photosPerMonth[o].ready?"none":"url(img/grid.png)"}},[e.loaded?n("month-grid",{ref:"monthGrid"+o,refInFor:!0,staticClass:"month",class:"month"+o,attrs:{index:o,year:e.year,month:e.month,"usable-width":t.usableWidth},on:{resizeReady:function(e){return t.monthResize(o,e)},ready:function(e,n){return t.monthReady(o,e,n)}}}):t._e()],1)})),0),t.$vuetify.breakpoint.mobile&&t.photosPerMonth.length>0?n("mobile-scrub",{staticClass:"scrubber",attrs:{"home-id":"home-element","index-in-view":t.indexInView,"photos-per-month":t.photosPerMonth}}):t.photosPerMonth.length>0?n("desktop-scrub",{staticClass:"scrubber",attrs:{"home-id":"home-element","index-in-view":t.indexInView,"photos-per-month":t.photosPerMonth}}):t._e()],1)},J=[],Q=(n("25f0"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.loadedPhotos?n("photo-grid",{ref:"photoGrid",staticClass:"month-grid",attrs:{"usable-width":t.usableWidth,photos:t.photos},on:{ready:function(e){return t.$emit("ready",e,t.photos)},resizeReady:function(e){return t.$emit("resizeReady",e)}}}):t._e()}),K=[],U=(n("a9e3"),n("a2e1")),X=n("5024"),Z=(new Date,o["a"].extend({name:"MonthGrid",components:{PhotoGrid:X["a"],GridPhoto:U["a"]},props:{usableWidth:{type:Number,required:!0},year:{type:Number,required:!0},month:{type:Number,required:!0},index:{type:Number,required:!0}},data:function(){return{photoGrid:null,photos:[],loadedPhotos:!1}},mounted:function(){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$store.dispatch("getCachedPhotos",{year:t.year,month:t.month});case 2:t.photos=e.sent,t.loadedPhotos=!0;case 4:case"end":return e.stop()}}),e)})))()},methods:{scrollDateIntoView:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.$refs.photoGrid;n.scrollDateIntoView(t,e)},scrollMediaIntoView:function(t){var e=this.$refs.photoGrid;e.scrollMediaIntoView(t)}}})),tt=Z,et=(n("5776"),Object(p["a"])(tt,Q,K,!1,null,"c7c389e4",null)),nt=et.exports,ot=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"scrubber"},[n("canvas",{ref:"scrubber",staticClass:"inner-scrub scrubber-canvas",style:{height:t.canvasHeight+"px"},attrs:{width:100,height:t.canvasHeight}}),n("div",{staticClass:"inner-scrub scrubber-events",style:{height:t.canvasHeight+"px"},on:{mouseenter:function(e){t.overScrub=!0},mouseleave:function(e){t.overScrub=!1},touchstart:t.touchScrubStart,mousedown:t.scrubStart}})])},rt=[],it=n("3835"),at=(n("cb29"),new Date),st=o["a"].extend({name:"DesktopScrub",props:{homeId:{type:String,required:!0},photosPerMonth:{type:Array,required:!0},indexInView:{type:Number,required:!0}},data:function(){return{homeElement:{},canvas:{},context:{},yearTextSize:13,renderAnimationFrame:-1,scrollTimeout:-1,scrolling:!1,scrubbing:!1,overScrub:!1,scrubData:{percent:0,year:at.getFullYear(),month:at.getMonth()+1}}},beforeDestroy:function(){cancelAnimationFrame(this.renderAnimationFrame),document.removeEventListener("mousemove",this.scrubMove),document.removeEventListener("mouseup",this.scrubEnd),document.removeEventListener("touchmove",this.touchScrubMove),document.removeEventListener("touchend",this.scrubEnd),this.homeElement.removeEventListener("scroll",this.homeScroll)},mounted:function(){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.homeElement=document.querySelector("#".concat(t.homeId)),document.addEventListener("mousemove",t.scrubMove,!1),document.addEventListener("mouseup",t.scrubEnd,!1),document.addEventListener("touchmove",t.touchScrubMove,!1),document.addEventListener("touchend",t.scrubEnd,!1),t.homeElement.addEventListener("scroll",t.homeScroll,!1),t.canvas=t.$refs.scrubber,t.context=t.canvas.getContext("2d"),t.render();case 9:case"end":return e.stop()}}),e)})))()},methods:{homeScroll:function(){var t=this;this.scrolling=!0,clearTimeout(this.scrollTimeout),this.scrollTimeout=setTimeout((function(){return t.scrolling=!1}),1e3)},yToMonthPhotos:function(t){for(var e=t*this.homeElement.scrollHeight,n=0;n<this.photosPerMonth.length;n++)if(e-=this.photosPerMonth[n].height,e<=0)return this.photosPerMonth[n];return this.photosPerMonth[this.photosPerMonth.length-1]},dateFromScrubEvent:function(t){var e=(t-this.$vuetify.application.top)/this.canvas.height;return e=Math.max(0,Math.min(1,1.01*e)),e},render:function(){this.renderAnimationFrame=requestAnimationFrame(this.render),this.context.font="".concat(this.yearTextSize,"px Roboto"),this.context.clearRect(0,0,this.canvas.width,this.canvas.height);var t=!this.scrubbing&&!this.overScrub;this.drawYears(t),(this.overScrub||this.scrubbing)&&this.drawScrollThumb(this.scrubData.percent*this.canvas.height,this.scrubData.year,this.scrubData.month,!1,!0);var e=this.photosPerMonth[this.indexInView];if(this.scrolling&&!this.scrubbing){var n,o,r=this.homeElement.scrollTop/this.homeElement.scrollHeight*this.canvas.height;this.drawScrollThumb(r,null!==(n=e.year)&&void 0!==n?n:0,null!==(o=e.month)&&void 0!==o?o:0,!0,!0)}else if(!this.scrubbing){var i,a,s=this.homeElement.scrollTop/this.homeElement.scrollHeight*this.canvas.height;this.drawScrollThumb(s,null!==(i=e.year)&&void 0!==i?i:0,null!==(a=e.month)&&void 0!==a?a:0,!0,!1)}},drawLoadedRegion:function(){this.context.fillStyle="rgba(50,255,100,0.16)";for(var t=50,e=0,n=this.homeElement.scrollHeight,o=0;o<this.photosPerMonth.length;o++){var r=this.photosPerMonth[o];r.loaded&&this.context.fillRect(this.canvas.width-t,e/n*this.canvas.height,t,r.height/n*this.canvas.height),e+=r.height}},drawScrollThumb:function(t,e,n){var o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=15,a=i+10+3,s=t;s<a&&r&&(s=a);var c=this.$vuetify.theme.dark;if(r){this.context.fillStyle=c?"rgba(0,0,0,0.7)":"rgba(255,255,255,0.7)";var h="".concat(u["d"][n-1]," ").concat(e),l=this.context.measureText(h),d=l.width;this.context.fillRect(this.canvas.width-d-10,s-i-10,d+10,i+10),this.context.fillStyle=c?"#e2e2e2":"#171717",this.context.fillText(h,this.canvas.width-d-5,s-i+5)}this.context.fillStyle=this.$vuetify.theme.themes[c?"dark":"light"].primary;var m=o?35:50;this.context.fillRect(this.canvas.width-m,t,m,o?2:3)},drawYears:function(){for(var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.$vuetify.theme.dark,n=0,o=-1,r=[],i=this.homeElement.scrollHeight,s=this.photosPerMonth.length-1;s>=0;s--){t||(this.context.beginPath(),this.context.fillStyle=e?"rgba(255,255,255,0.2)":"rgba(0,0,0,0.2)",this.context.arc(this.canvas.width-7,this.canvas.height-n,2,0,2*Math.PI),this.context.fill());var c=this.photosPerMonth[s];if(c.year!==o){o=c.year;var u=o.toString(),h=this.context.measureText(u),l=h.width,d=n,m=function(t){var e,n=Object(a["a"])(r);try{for(n.s();!(e=n.n()).done;){var o=Object(it["a"])(e.value,2),i=o[0],s=o[1];if(t>=i&&t<=s)return!1}}catch(c){n.e(c)}finally{n.f()}return!0};while(!m(d))d+=this.yearTextSize;r.push([d,d+this.yearTextSize]),this.context.fillStyle=e?t?"rgba(255,255,255,0.5)":"white":t?"rgba(0,0,0,0.5)":"black",this.context.fillText(u,this.canvas.width-l-15,this.canvas.height-d)}n+=this.photosPerMonth[s].height/i*this.canvas.height}},touchScrubStart:function(t){this.scrubbing=!0;var e=this.dateFromScrubEvent(t.touches[0].pageY);this.homeElement.scrollTo({top:this.homeElement.scrollHeight*e})},touchScrubMove:function(t){if(this.scrubbing){var e=this.dateFromScrubEvent(t.touches[0].pageY);this.homeElement.scrollTo({top:this.homeElement.scrollHeight*e})}},scrubStart:function(t){this.scrubbing=!0;var e=this.dateFromScrubEvent(t.pageY);this.homeElement.scrollTo({top:this.homeElement.scrollHeight*e})},scrubMove:function(t){if(this.scrubbing){var e=this.dateFromScrubEvent(t.pageY);this.homeElement.scrollTo({top:this.homeElement.scrollHeight*e})}if(this.overScrub||this.scrubbing){var n=t.pageY-this.$vuetify.application.top,o=this.yToMonthPhotos(n/this.canvas.height);this.scrubData={percent:n/this.canvas.height,year:o.year,month:o.month}}},scrubEnd:function(){this.scrubbing&&(this.scrubbing=!1)}},computed:{canvasHeight:function(){return this.$vuetify.breakpoint.height-this.$vuetify.application.top-this.$vuetify.application.bottom}},watch:{}}),ct=st,ut=(n("1bbf"),Object(p["a"])(ct,ot,rt,!1,null,"38e3a264",null)),ht=ut.exports,lt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"mobile-scrub",style:{opacity:t.scrolling?1:0,pointerEvents:t.scrolling?"all":"none",height:t.tabSize+"px",top:t.topCss}},[n("div",{staticClass:"scrub-container"},[n("v-sheet",{staticClass:"scrub-date",attrs:{rounded:""}},[t._v(t._s(t.formattedDate))]),n("v-sheet",{staticClass:"scrub-tab",style:{width:t.tabSize+"px",height:t.tabSize+"px"},attrs:{elevation:"7"},on:{touchstart:t.touchScrubStart,mousedown:t.scrubStart}},[n("v-icon",[t._v("mdi-unfold-more-horizontal")])],1)],1)])},dt=[],mt=n("b166"),pt=o["a"].extend({name:"MobileScrub",props:{homeId:{type:String,required:!0},photosPerMonth:{type:Array,required:!0},indexInView:{type:Number,required:!0}},data:function(){return{tabSize:50,homeElement:{},scrollTimeout:-1,scrolling:!0,scrubbing:!1,overScrub:!1,scrollTop:0,scrollHeight:100}},beforeDestroy:function(){document.removeEventListener("mousemove",this.scrubMove),document.removeEventListener("mouseup",this.scrubEnd),document.removeEventListener("touchmove",this.touchScrubMove),document.removeEventListener("touchend",this.scrubEnd),this.homeElement.removeEventListener("scroll",this.homeScroll)},mounted:function(){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.homeElement=document.querySelector("#".concat(t.homeId)),document.addEventListener("mousemove",t.scrubMove,!1),document.addEventListener("mouseup",t.scrubEnd,!1),document.addEventListener("touchmove",t.touchScrubMove,!1),document.addEventListener("touchend",t.scrubEnd,!1),t.homeElement.addEventListener("scroll",t.homeScroll,!1),t.scrollTimeout=setTimeout((function(){return t.scrolling=!1}),3e3);case 7:case"end":return e.stop()}}),e)})))()},methods:{updateScrollData:function(){this.scrollTop=this.homeElement.scrollTop,this.scrollHeight=this.homeElement.scrollHeight},homeScroll:function(){var t=this;this.scrolling=!0,clearTimeout(this.scrollTimeout),this.scrollTimeout=setTimeout((function(){return t.scrolling=!1}),3e3),this.updateScrollData()},yToMonthPhotos:function(t){for(var e=t*this.scrollHeight,n=0;n<this.photosPerMonth.length;n++)if(e-=this.photosPerMonth[n].height,e<=0)return this.photosPerMonth[n];return this.photosPerMonth[this.photosPerMonth.length-1]},dateFromScrubEvent:function(t){var e=(t-this.$vuetify.application.top-this.tabSize/2)/(this.canvasHeight-this.tabSize);return e=Math.max(0,Math.min(1,1.01*e)),e},touchScrubStart:function(t){this.scrubbing=!0;var e=this.dateFromScrubEvent(t.touches[0].pageY);this.homeElement.scrollTo({top:this.scrollHeight*e})},touchScrubMove:function(t){if(this.scrubbing){var e=this.dateFromScrubEvent(t.touches[0].pageY);this.homeElement.scrollTo({top:this.scrollHeight*e})}},scrubStart:function(t){this.scrubbing=!0;var e=this.dateFromScrubEvent(t.pageY);this.homeElement.scrollTo({top:this.scrollHeight*e})},scrubMove:function(t){if(this.scrubbing){var e=this.dateFromScrubEvent(t.pageY);this.homeElement.scrollTo({top:this.scrollHeight*e})}},scrubEnd:function(){this.scrubbing&&(this.scrubbing=!1)}},computed:{scrubData:function(){var t=this.scrollTop/this.scrollHeight,e=this.yToMonthPhotos(t);return{percent:t,year:e.year,month:e.month}},topCss:function(){var t=Math.round((this.canvasHeight-this.tabSize)*this.scrubData.percent);return"".concat(t,"px")},formattedDate:function(){return Object(mt["a"])(new Date(this.scrubData.year,this.scrubData.month,15),"MMM yyyy")},canvasHeight:function(){return this.$vuetify.breakpoint.height-this.$vuetify.application.top-this.$vuetify.application.bottom}},watch:{}}),ft=pt,vt=(n("8daa"),n("8dd9")),bt=Object(p["a"])(ft,lt,dt,!1,null,"daa8752e",null),gt=bt.exports;v()(bt,{VIcon:C["a"],VSheet:vt["a"]});var yt=o["a"].extend({name:"Home",components:{MobileScrub:gt,DesktopScrub:ht,MonthGrid:nt},data:function(){return{api:u["a"],gridHeight:240,waitPpm:null,photosPerMonth:[],homeElement:{},indexInView:0,ignoreDateChange:!1}},mounted:function(){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function e(){var n,o,r,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.homeElement=t.$refs.home,n="HomePhoto"===t.$route.name,e.next=4,t.updatePhotosPerMonth(!n&&null===t.hasDate,[0]);case 4:if(n||null!==t.hasDate||setTimeout((function(){var e=t.photosPerMonth[1];e&&(e.loaded=!0)}),500),null===t.hasDate||n||t.updateFromDateQuery(),n){console.log(t.photosPerMonth),o=Object(a["a"])(t.photosPerMonth);try{for(o.s();!(r=o.n()).done;)i=r.value,i.loaded=i.viewed}catch(s){o.e(s)}finally{o.f()}}case 7:case"end":return e.stop()}}),e)})))()},methods:{updatePhotosPerMonth:function(t,e){var n=this;return Object(c["a"])(regeneratorRuntime.mark((function o(){var r,i,a,s;return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return r=5,i=4/3,a=n.usableWidth/(n.gridHeight*i),n.waitPpm=n.$store.dispatch("apiRequest",{url:"photos/months"}),o.next=6,n.waitPpm;case 6:s=o.sent,n.photosPerMonth=s.map((function(o,i){var s=o.year,c=void 0===s?0:s,u=o.month,h=void 0===u?0:u,l=o.count,d=void 0===l?0:l;return{year:c,month:h,count:d,viewed:e.includes(i),loaded:t&&e.includes(i),ready:!1,height:Math.ceil(d/a)*(n.gridHeight+r),photos:[],id:c.toString()+h}}));case 8:case"end":return o.stop()}}),o)})))()},monthResize:function(t,e){o["a"].set(this.photosPerMonth[t],"height",e)},monthReady:function(t,e,n){this.photosPerMonth[t].photos=n,this.photosPerMonth[t].height=e,this.photosPerMonth[t].ready=!0,this.$emit("monthReady",t),this.$emit("monthReady"+t)},applyLazy:function(t,e,n,o){var r=this;if(this.photosPerMonth[t].viewed!==o){this.photosPerMonth[t].viewed=o,o?this.indexInView=t:this.indexInView===t&&(this.indexInView=this.photosPerMonth.findIndex((function(t){return t.viewed}))),setTimeout((function(){var e=r.photosPerMonth[t].viewed;e&&(t>0&&(r.photosPerMonth[t-1].loaded=!0),r.photosPerMonth[t].loaded=!0,t+1<r.photosPerMonth.length&&(r.photosPerMonth[t+1].loaded=!0),console.log("loading",t))}),0===t?0:400);var i=function(t){var e=r.photosPerMonth[t].loaded,n=r.photosPerMonth[t].viewed;t>0&&(n||(n=r.photosPerMonth[t-1].viewed)),t+1<r.photosPerMonth.length&&(n||(n=r.photosPerMonth[t+1].viewed)),!n&&e&&(r.photosPerMonth[t].loaded=!1,r.photosPerMonth[t].ready=!1,console.log("unloading",t))};setTimeout((function(){i(t),t+1<r.photosPerMonth.length&&i(t+1),t>0&&i(t-1)}),500)}},dateToIndex:function(t){if(null===t)return-1;var e=t.getFullYear(),n=t.getMonth()+1;return this.photosPerMonth.findIndex((function(t){return t.year===e&&t.month==n}))},getClosestPhotoMonthIndex:function(t){for(var e=1/0,n=-1,o=t.getTime(),r=0;r<this.photosPerMonth.length;r++){var i=this.photosPerMonth[r],a=Math.abs(new Date(i.year,i.month-1,15).getTime()-o);if(!(a<e))break;e=a,n=r}return n},scrollMediaIntoView:function(t){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function n(){var o,r,i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(null!==t){n.next=2;break}return n.abrupt("return");case 2:if(o=e.dateToIndex(t.createDate),r=e.photosPerMonth[o],!r.ready){n.next=9;break}i=e.$refs["monthGrid"+o],i&&i.length>0&&i[0].scrollMediaIntoView(t),n.next=15;break;case 9:if(e.scrollDateIntoView(t.createDate,!1),r.ready){n.next=13;break}return n.next=13,new Promise((function(t){return e.$once("monthReady"+o,t)}));case 13:return n.next=15,e.scrollMediaIntoView(t);case 15:case"end":return n.stop()}}),n)})))()},scrollDateIntoView:function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(null!==t){var o=this.dateToIndex(t);-1===o&&(o=this.getClosestPhotoMonthIndex(t));for(var r=0,i=0;i<o;i++)r+=this.photosPerMonth[i].height;var a=function(){var r=e.$refs["monthGrid"+o];r&&r.length>0&&r[0].scrollDateIntoView(t,n)};this.photosPerMonth[o].ready?a():(this.$nextTick((function(){e.homeElement.scrollTop=r})),this.$once("monthReady"+o,(function(){return e.$nextTick((function(){return a()}))})))}},updateFromDateQuery:function(){null!==this.hasDate&&this.scrollDateIntoView(this.hasDate)},reloadPhotos:function(){var t=arguments,e=this;return Object(c["a"])(regeneratorRuntime.mark((function n(){var o,r,i,s,c,u,h,l,d;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:for(o=t.length>0&&void 0!==t[0]?t[0]:null,r=[],i=0;i<e.photosPerMonth.length;i++)e.photosPerMonth[i].viewed&&r.push(i);return n.next=5,e.updatePhotosPerMonth(!0,r);case 5:e.$store.commit("clearCachedPhotos"),s=Object(a["a"])(e.photosPerMonth);try{for(s.s();!(c=s.n()).done;)u=c.value,u.loaded=!1,u.ready=!1}catch(m){s.e(m)}finally{s.f()}return n.next=10,e.$nextTick();case 10:h=Object(a["a"])(e.photosPerMonth);try{for(h.s();!(l=h.n()).done;)d=l.value,d.viewed&&(d.loaded=!0)}catch(m){h.e(m)}finally{h.f()}if(console.log("Reloaded photos"),null!==o){n.next=15;break}return n.abrupt("return");case 15:return n.next=17,e.scrollMediaIntoView(o);case 17:case"end":return n.stop()}}),n)})))()}},computed:{hasDate:function(){if(void 0===this.$route.query.date||null===this.$route.query.date)return null;var t=new Date(this.$route.query.date);return isNaN(t.getDate())?null:t},pagePadding:function(){return this.$vuetify.breakpoint.mobile?0:10},scrubberWidth:function(){return this.$vuetify.breakpoint.mobile?0:50},usableWidth:function(){return this.$vuetify.breakpoint.width-this.$vuetify.application.left-this.$vuetify.application.right-2*this.pagePadding-this.scrubberWidth},totalPhotos:function(){var t,e=0,n=Object(a["a"])(this.photosPerMonth);try{for(n.s();!(t=n.n()).done;){var o=t.value;e+=o.count}}catch(r){n.e(r)}finally{n.f()}return e},photosQueue:function(){var t,e=[],n=Object(a["a"])(this.photosPerMonth);try{for(n.s();!(t=n.n()).done;){var o=t.value;e.push.apply(e,Object(s["a"])(o.photos))}}catch(r){n.e(r)}finally{n.f()}return e}},watch:{"$store.state.reloadPhotos":function(){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=t.$store.state.reloadPhotos,!1!==n){e.next=3;break}return e.abrupt("return");case 3:return t.$store.commit("reloadPhotos",!1),e.next=6,t.reloadPhotos(!0===n?null:n);case 6:case"end":return e.stop()}}),e)})))()},"$store.state.scrollToTop":function(){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.$store.state.scrollToTop){e.next=2;break}return e.abrupt("return");case 2:return t.$store.commit("scrollToTop",!1),e.next=5,t.waitPpm;case 5:return t.homeElement.scrollTo({top:0,behavior:"smooth"}),e.next=8,t.reloadPhotos();case 8:case"end":return e.stop()}}),e)})))()},"$store.state.keepInView":function(){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.waitPpm;case 2:return n=t.$store.state.keepInView,e.next=5,t.scrollMediaIntoView(n);case 5:case"end":return e.stop()}}),e)})))()},"$route.query.date":function(){this.ignoreDateChange?this.ignoreDateChange=!1:null!==this.hasDate&&this.scrollDateIntoView(this.hasDate)},"$route.name":function(){"HomePhoto"===this.$route.name&&(this.ignoreDateChange=!0)},photosQueue:function(){this.$store.commit("viewerQueue",this.photosQueue)}}}),wt=yt,xt=(n("4824"),n("269a")),kt=n.n(xt),Mt=n("90a2"),Pt=Object(p["a"])(wt,Y,J,!1,null,"be190aec",null),St=Pt.exports;kt()(Pt,{Intersect:Mt["a"]}),o["a"].use(G["a"]);var Tt=[{path:"/",name:"Home",component:St,meta:{title:"Photos - Ruurd Photos"},children:[{meta:{title:"Photo - Ruurd Photos"},path:"/photo/:id",name:"HomePhoto",component:function(){return n.e("chunk-9b896948").then(n.bind(null,"6ec5"))}}]},{path:"/search/:query",name:"Search",meta:{title:":query - Ruurd Photos"},component:function(){return Promise.all([n.e("chunk-44141672"),n.e("chunk-725e9b4e")]).then(n.bind(null,"2d3b"))},children:[{meta:{title:"Photo - Ruurd Photos"},path:"/search/:query/photo/:id",name:"SearchPhoto",component:function(){return n.e("chunk-9b896948").then(n.bind(null,"6ec5"))}}]},{path:"/date/:month",name:"DateMonth",meta:{title:":month - Ruurd Photos"},component:function(){return n.e("chunk-78d9768a").then(n.bind(null,"3a43"))},children:[{meta:{title:"Photo - Ruurd Photos"},path:"/date/:month/photo/:id",name:"DateMonthPhoto",component:function(){return n.e("chunk-9b896948").then(n.bind(null,"6ec5"))}}]},{path:"/date/:day/:month",name:"DateDay",meta:{title:":day :month - Ruurd Photos"},component:function(){return n.e("chunk-78d9768a").then(n.bind(null,"3a43"))},children:[{meta:{title:"Photo - Ruurd Photos"},path:"/date/:day/:month/photo/:id",name:"DateDayPhoto",component:function(){return n.e("chunk-9b896948").then(n.bind(null,"6ec5"))}}]},{path:"/explore",name:"Explore",meta:{title:"Explore - Ruurd Photos"},component:function(){return n.e("chunk-f6deb52a").then(n.bind(null,"7797"))}},{path:"/map",name:"Map",meta:{title:"Map - Ruurd Photos"},component:function(){return Promise.all([n.e("chunk-44141672"),n.e("chunk-9702c420")]).then(n.bind(null,"4bb4"))}},{path:"/settings",name:"Settings",meta:{title:"Settings - Ruurd Photos"},component:function(){return n.e("chunk-2d0b3289").then(n.bind(null,"26d3"))}},{path:"/login",name:"Login",meta:{title:"Login - Ruurd Photos"},component:function(){return n.e("chunk-0cd461c3").then(n.bind(null,"a55b"))}}],Rt=new G["a"]({routes:Tt});Rt.beforeEach((function(t,e,n){var o=t.matched.slice().reverse().find((function(t){return t.meta&&t.meta.title})),r=e.matched.slice().reverse().find((function(t){return t.meta&&t.meta.metaTags})),i=null;if(o?i=o.meta.title:r&&(i=r.meta.title),null!==i){for(var a=i.split(" "),s=0;s<a.length;s++)if(a[s].startsWith(":")){var c=a[s].substr(1);c.length>0&&t.params.hasOwnProperty(c)&&(a[s]=t.params[c])}document.title=a.join(" ")}Array.from(document.querySelectorAll("[data-vue-router-controlled]")).map((function(t){var e;return null===(e=t.parentNode)||void 0===e?void 0:e.removeChild(t)})),n()}));var $t=Rt,Dt=n("5530"),Et=(n("a434"),n("2f62")),Ot=n("bfa9"),Ct=n("b0d1"),jt=new Ot["a"]({reducer:function(t){return{email:t.email,password:t.password,verifiedLogin:t.verifiedLogin,showInfo:t.showInfo,mapboxKey:t.mapboxKey}},storage:window.localStorage});o["a"].use(Et["a"]);var _t=new Et["a"].Store({state:{api:u["a"],snackbars:[],reloadPhotos:!1,scrollToTop:!1,searchResults:{low:[],high:[],searchType:null,glossary:"",placeName:""},dateResults:[],email:"",password:"",viewerQueue:[],keepInView:null,showInfo:!0,mapboxKey:"",cachedPhotos:{},prompt:{show:!1,title:"",subtitle:"",cancelText:"",confirmText:"",onConfirm:function(){return 0},onCancel:function(){return 0}}},getters:{isLoggedIn:function(t){return""!==t.email&&""!==t.password}},mutations:{addSnackObject:function(t,e){return t.snackbars.push(e)},removeSnack:function(t,e){return t.snackbars.splice(t.snackbars.indexOf(e),1)},searchResultsHigh:function(t,e){return t.searchResults.high=e},searchResultsLow:function(t,e){return t.searchResults.low=e},searchType:function(t,e){return t.searchResults.searchType=e},glossary:function(t,e){return t.searchResults.glossary=e},placeName:function(t,e){return t.searchResults.placeName=e},mapboxKey:function(t,e){return t.mapboxKey=e},showInfo:function(t,e){return t.showInfo=e},reloadPhotos:function(t,e){return t.reloadPhotos=e},scrollToTop:function(t,e){return t.scrollToTop=e},keepInView:function(t,e){return t.keepInView=e},viewerQueue:function(t,e){return t.viewerQueue=e},dateResults:function(t,e){return t.dateResults=e},clearCachedPhotos:function(t){return t.cachedPhotos={}},cachedPhotos:function(t,e){return o["a"].set(t.cachedPhotos,e.key,e.media)},login:function(t,e){var n=e.email,o=e.password;t.email=n,t.password=o},hidePrompt:function(t){return t.prompt.show=!1},showPrompt:function(t,e){var n=e.title,o=void 0===n?"Are you sure?":n,r=e.subtitle,i=void 0===r?"There may be unsaved changes":r,a=e.cancelText,s=void 0===a?"Cancel":a,c=e.confirmText,u=void 0===c?"Confirm":c,h=e.onConfirm,l=void 0===h?function(){return 0}:h,d=e.onCancel,m=void 0===d?function(){return 0}:d;t.prompt.show=!0,t.prompt.title=o,t.prompt.subtitle=i,t.prompt.cancelText=s,t.prompt.confirmText=u,t.prompt.onConfirm=l,t.prompt.onCancel=m}},actions:{addSnack:function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(e,n){var o,r,i,a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.state,o=e.commit,r=n.text,i=n.timeout,a=void 0===i?3e3:i,s={text:r,open:!0,timeout:a,id:Math.random()},o("addSnackObject",s),t.abrupt("return",new Promise((function(t){setTimeout((function(){o("removeSnack",s),t()}),a+500)})));case 5:case"end":return t.stop()}}),t)})));function e(e,n){return t.apply(this,arguments)}return e}(),showPrompt:function(t,e){return Object(c["a"])(regeneratorRuntime.mark((function n(){var o,r,i,a,s,c,u,h,l;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return o=t.commit,r=e.title,i=void 0===r?"Are you sure?":r,a=e.subtitle,s=void 0===a?"This will discard all unsaved changes":a,c=e.cancelText,u=void 0===c?"Cancel":c,h=e.confirmText,l=void 0===h?"Confirm":h,n.abrupt("return",new Promise((function(t){o("showPrompt",{title:i,subtitle:s,cancelText:u,confirmText:l,onConfirm:function(){return t(!0)},onCancel:function(){return t(!1)}})})));case 3:case"end":return n.stop()}}),n)})))()},getCachedPhotos:function(t,e){return Object(c["a"])(regeneratorRuntime.mark((function n(){var o,r,i,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(o=t.state,r=t.dispatch,i=e.year.toString()+e.month,!o.cachedPhotos.hasOwnProperty(i)){n.next=4;break}return n.abrupt("return",o.cachedPhotos[i]);case 4:return n.next=6,r("apiRequest",{url:"photos/month-photos",body:{month:[e.year,e.month]}});case 6:return a=n.sent,n.abrupt("return",a.map(Ct["a"].fromObject));case 8:case"end":return n.stop()}}),n)})))()},apiRequest:function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(e,n){var o,r,i,a,s,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(o=e.state,r=e.getters,i=n.url,a=n.body,s=void 0===a?{}:a,r.isLoggedIn){t.next=4;break}return t.abrupt("return",{loggedIn:!1,result:null});case 4:return t.next=6,fetch("".concat(o.api,"/").concat(i),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Object(Dt["a"])({auth:{email:o.email,password:o.password}},s))}).then((function(t){return t.text()}));case 6:return c=t.sent,t.prev=7,t.abrupt("return",JSON.parse(c));case 11:return t.prev=11,t.t0=t["catch"](7),console.warn("Can't parse",{url:i,txt:c}),t.abrupt("return",null);case 15:case"end":return t.stop()}}),t,null,[[7,11]])})));function e(e,n){return t.apply(this,arguments)}return e}(),checkLogin:function(t,e){return Object(c["a"])(regeneratorRuntime.mark((function n(){var o,r,i,a,s;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return o=t.state,r=t.commit,i=e.email,a=e.password,n.next=4,fetch("".concat(o.api,"/auth"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({auth:{email:i,password:a}})}).then((function(t){return t.json()}));case 4:return s=n.sent,r("login",{email:i,password:a}),n.abrupt("return",s);case 7:case"end":return n.stop()}}),n)})))()},dateSearch:function(t,e){return Object(c["a"])(regeneratorRuntime.mark((function n(){var o,r,i,a,s,c,u,h;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return o=t.dispatch,r=t.commit,t.state,i=e.day,a=void 0===i?null:i,s=e.month,c=void 0===s?null:s,n.next=4,o("apiRequest",{url:"photos/dateSearch?m=".concat(c,"&d=").concat(a)});case 4:u=n.sent,h=u.map(Ct["a"].fromObject),r("dateResults",h);case 7:case"end":return n.stop()}}),n)})))()},search:function(t,e){return Object(c["a"])(regeneratorRuntime.mark((function n(){var o,r,i,a,s,c,u,h,l,d;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return o=t.dispatch,r=t.commit,t.state,n.next=3,o("apiRequest",{url:"photos/search?q=".concat(e)});case 3:i=n.sent,a=i.results,s=i.info,c=i.type,r("searchType",c),"label"===c?r("glossary",s):"place"===c&&r("placeName",s),u=a.map((function(t){return t.rank})).reduce((function(t,e){return t+e}),0)/a.length,h=Math.min(u,1.2),l=a.filter((function(t){return t.rank<h})).map(Ct["a"].fromObject),d=a.filter((function(t){return t.rank>=h})).map(Ct["a"].fromObject),r("searchResultsLow",l),r("searchResultsHigh",d);case 15:case"end":return n.stop()}}),n)})))()}},modules:{},plugins:[jt.plugin]}),qt=n("f309");o["a"].use(qt["a"]);var It=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches;null!==localStorage.getItem("darkTheme")&&(It="true"===localStorage.darkTheme);var Vt=new qt["a"]({breakpoint:{mobileBreakpoint:"sm"},theme:{dark:It,themes:{dark:{primary:"#5996d1",secondary:"#c95313"},light:{primary:"#318bd5",secondary:"#c1792e"}}}}),Ht=n("a4a1"),Lt=n.n(Ht),Nt=(n("f6b9"),n("8f0d"));n("6cc5");o["a"].config.productionTip=!1,o["a"].use(Lt.a),o["a"].use(Nt["a"]),new o["a"]({router:$t,store:_t,vuetify:Vt,render:function(t){return t(z)}}).$mount("#app")},e2b2:function(t,e,n){}});
//# sourceMappingURL=app.e98fe2dd.js.map