{"version":3,"sources":["webpack:///./src/views/Search.vue?3c2a","webpack:///./src/views/Search.vue?b7d6","webpack:///./src/views/Search.vue","webpack:///./src/views/Search.vue?a745","webpack:///./src/views/Search.vue?230a"],"names":["render","_vm","this","_h","$createElement","_c","_self","ref","staticClass","style","maxHeight","$vuetify","application","top","bottom","padding","pagePadding","on","homeScroll","isPlace","loading","allResults","length","_v","_s","query","_e","isLabel","glossary","bounds","height","margin","width","attrs","mapWidth","placeName","breakpoint","directives","name","rawName","value","highResults","expression","usableWidth","highSlice","endIndex","lowResults","lowSlice","staticRenderFns","extend","components","PhotoMap","PhotoGrid","data","api","prevScroll","searchElement","photoGridLow","photoGridHigh","mounted","$refs","search","console","log","updateSearch","methods","$store","dispatch","url","minCorner","latLng","minlat","minlng","maxCorner","maxlat","maxlng","latLngBounds","pad","scrollTop","Math","abs","scrollBottom","scrollHeight","clientHeight","computed","mobile","left","right","$route","params","slice","state","searchResults","high","low","concat","searchType","watch","commit","keepInView","scrollMediaIntoView","component","VIcon","VProgressCircular"],"mappings":"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","file":"js/chunk-725e9b4e.a427a896.js","sourcesContent":["export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Search.vue?vue&type=style&index=0&id=fb57aa18&scoped=true&lang=css&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{ref:\"search\",staticClass:\"search\",style:({\n        maxHeight: (\"calc(100vh - \" + (_vm.$vuetify.application.top + _vm.$vuetify.application.bottom) + \"px)\"),\n        padding: _vm.pagePadding + 'px',\n     }),on:{\"scroll\":_vm.homeScroll}},[_c('router-view'),(!_vm.isPlace && !_vm.loading && _vm.allResults.length > 0)?_c('h1',{staticClass:\"search-query\"},[_vm._v(\"‟\"+_vm._s(_vm.query)+\"”\")]):_vm._e(),(!_vm.loading && _vm.allResults.length > 0 && _vm.isLabel)?_c('p',{staticClass:\"search-glossary\"},[_vm._v(_vm._s(_vm.glossary))]):_vm._e(),(_vm.isPlace && _vm.bounds !== null)?_c('photo-map',{staticClass:\"map-leaflet\",style:({\n                    height: 450 + 'px',\n                    margin: (\"-\" + _vm.pagePadding + \"px -\" + _vm.pagePadding + \"px 0\"),\n                    width: (\"calc(100% + \" + (_vm.pagePadding * 2) + \"px);\"),\n               }),attrs:{\"width\":_vm.mapWidth,\"height\":450,\"start-bounds\":_vm.bounds}}):_vm._e(),(_vm.isPlace && !_vm.loading && _vm.allResults.length > 0)?_c('h1',{staticClass:\"search-query search-place\"},[_vm._v(\"‟\"+_vm._s(_vm.placeName)+\"”\")]):(_vm.isPlace)?_c('div',{staticClass:\"placeholder-map\",style:({height: 450 + 'px'})}):_vm._e(),(_vm.loading)?_c('div',{staticClass:\"progress-center\"},[_c('v-progress-circular',{attrs:{\"color\":\"primary\",\"size\":_vm.$vuetify.breakpoint.width / 4,\"indeterminate\":\"\"}})],1):(_vm.allResults.length === 0)?_c('div',{staticClass:\"no-results\"},[_c('div',{staticClass:\"no-results-center\"},[_c('v-icon',{staticClass:\"icon\",attrs:{\"x-large\":\"\"}},[_vm._v(\"mdi-cloud-search-outline\")]),_c('div',{staticClass:\"res-caption\"},[_vm._v(\"No results found for \\\"\"+_vm._s(_vm.query)+\"\\\"\")])],1)]):_vm._e(),(!_vm.loading)?_c('photo-grid',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.highResults.length > 0),expression:\"highResults.length > 0\"}],ref:\"photoGridHigh\",attrs:{\"usable-width\":_vm.usableWidth,\"photos\":_vm.highSlice}}):_vm._e(),(_vm.endIndex >= _vm.highResults.length && _vm.highResults.length !== 0 && _vm.lowResults.length !== 0)?_c('h2',{staticClass:\"mt-5 mb-5\"},[_vm._v(\" Less related results \")]):_vm._e(),(!_vm.loading)?_c('photo-grid',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.lowResults.length > 0),expression:\"lowResults.length > 0\"}],ref:\"photoGridLow\",attrs:{\"usable-width\":_vm.usableWidth,\"photos\":_vm.lowSlice}}):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\nimport Vue from 'vue'\r\nimport PhotoGrid from \"@/components/PhotoGrid.vue\";\r\nimport {Media} from \"@/ts/Media\";\r\nimport {api, scrollBarWidth} from \"@/ts/constants\";\r\nimport PhotoMap from \"@/components/PhotoMap.vue\";\r\nimport L from \"leaflet\";\r\n\r\nexport default Vue.extend({\r\n    name: 'Search',\r\n    components: {PhotoMap, PhotoGrid},\r\n    data: () => ({\r\n        api,\r\n        loading: false,\r\n        endIndex: 100,\r\n        prevScroll: -10000,\r\n        searchElement: {} as HTMLDivElement,\r\n        photoGridLow: null as any,\r\n        photoGridHigh: null as any,\r\n        bounds: null as L.LatLngBounds | null,\r\n    }),\r\n    async mounted() {\r\n        this.searchElement = this.$refs.search as HTMLDivElement;\r\n\r\n        console.log(this.$vuetify);\r\n\r\n        await this.updateSearch();\r\n    },\r\n    methods: {\r\n        async updateSearch() {\r\n            this.loading = true;\r\n            this.bounds = null;\r\n            await this.$store.dispatch('search', this.query);\r\n            if (this.isPlace) {\r\n                let bounds = await this.$store.dispatch('apiRequest', {url: `photos/boundingBox/${this.placeName}`});\r\n                let minCorner = L.latLng(bounds.minlat, bounds.minlng, 0);\r\n                let maxCorner = L.latLng(bounds.maxlat, bounds.maxlng, 0);\r\n                this.bounds = L.latLngBounds(minCorner, maxCorner).pad(0.1);\r\n            }\r\n            this.loading = false;\r\n        },\r\n        async homeScroll() {\r\n            let scrollTop = this.searchElement.scrollTop;\r\n            // If we haven't scrolled more than 180px since last scroll fire just return\r\n            if (Math.abs(this.prevScroll - scrollTop) < 180)\r\n                return;\r\n            this.prevScroll = scrollTop;\r\n\r\n            let scrollBottom = this.searchElement.scrollHeight - scrollTop - this.searchElement.clientHeight;\r\n            if (scrollBottom < 3000 && this.endIndex < this.allResults.length)\r\n                this.endIndex += 100;\r\n        },\r\n    },\r\n    computed: {\r\n        pagePadding(): number {\r\n            return this.$vuetify.breakpoint.mobile ? 0 : 10;\r\n        },\r\n        usableWidth(): number {\r\n            return this.$vuetify.breakpoint.width -\r\n                this.$vuetify.application.left - this.$vuetify.application.right -\r\n                this.pagePadding * 2 - scrollBarWidth;\r\n        },\r\n        mapWidth(): number {\r\n            return this.$vuetify.breakpoint.width - this.$vuetify.application.left - this.$vuetify.application.right;\r\n        },\r\n        query(): string {\r\n            return this.$route.params.query;\r\n        },\r\n        highSlice(): Media[] {\r\n            return this.highResults.slice(0, this.endIndex);\r\n        },\r\n        lowSlice(): Media[] {\r\n            return this.lowResults.slice(0, this.endIndex - this.lowResults.length);\r\n        },\r\n        highResults(): Media[] {\r\n            return this.$store.state.searchResults.high;\r\n        },\r\n        lowResults(): Media[] {\r\n            return this.$store.state.searchResults.low;\r\n        },\r\n        allResults(): Media[] {\r\n            return this.highResults.concat(this.lowResults);\r\n        },\r\n        isLabel(): boolean {\r\n            return this.$store.state.searchResults.searchType === 'label';\r\n        },\r\n        isPlace(): boolean {\r\n            return this.$store.state.searchResults.searchType === 'place';\r\n        },\r\n        placeName(): string {\r\n            return this.$store.state.searchResults.placeName;\r\n        },\r\n        glossary(): boolean {\r\n            return this.$store.state.searchResults.glossary;\r\n        },\r\n    },\r\n    watch: {\r\n        query() {\r\n            this.updateSearch();\r\n        },\r\n        allResults() {\r\n            this.$store.commit('viewerQueue', this.allResults);\r\n        },\r\n        '$store.state.keepInView'() {\r\n            if (this.$store.state.keepInView !== null) {\r\n                let photoGridLow: any = this.$refs.photoGridLow;\r\n                let photoGridHigh: any = this.$refs.photoGridHigh;\r\n                photoGridLow.scrollMediaIntoView(this.$store.state.keepInView);\r\n                photoGridHigh.scrollMediaIntoView(this.$store.state.keepInView);\r\n            }\r\n        },\r\n    }\r\n})\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Search.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Search.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./Search.vue?vue&type=template&id=fb57aa18&scoped=true&\"\nimport script from \"./Search.vue?vue&type=script&lang=ts&\"\nexport * from \"./Search.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./Search.vue?vue&type=style&index=0&id=fb57aa18&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"fb57aa18\",\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VIcon } from 'vuetify/lib/components/VIcon';\nimport { VProgressCircular } from 'vuetify/lib/components/VProgressCircular';\ninstallComponents(component, {VIcon,VProgressCircular})\n"],"sourceRoot":""}