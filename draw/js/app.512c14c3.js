(function(t){function e(e){for(var a,o,c=e[0],r=e[1],l=e[2],h=0,d=[];h<c.length;h++)o=c[h],Object.prototype.hasOwnProperty.call(s,o)&&s[o]&&d.push(s[o][0]),s[o]=0;for(a in r)Object.prototype.hasOwnProperty.call(r,a)&&(t[a]=r[a]);u&&u(e);while(d.length)d.shift()();return i.push.apply(i,l||[]),n()}function n(){for(var t,e=0;e<i.length;e++){for(var n=i[e],a=!0,c=1;c<n.length;c++){var r=n[c];0!==s[r]&&(a=!1)}a&&(i.splice(e--,1),t=o(o.s=n[0]))}return t}var a={},s={app:0},i=[];function o(e){if(a[e])return a[e].exports;var n=a[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=t,o.c=a,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)o.d(n,a,function(e){return t[e]}.bind(null,a));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/draw/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],r=c.push.bind(c);c.push=e,c=c.slice();for(var l=0;l<c.length;l++)e(c[l]);var u=r;i.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"034f":function(t,e,n){"use strict";var a=n("85ec"),s=n.n(a);s.a},"2e8b":function(t,e,n){},"40d8":function(t,e,n){"use strict";var a=n("2e8b"),s=n.n(a);s.a},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var a=n("2b0e"),s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("draw-canvas",{staticClass:"my-dc"})],1)},i=[],o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"draw-canvas"},[n("div",{staticClass:"canvas-container",on:{keypress:t.handleKey}},[n("canvas",{ref:"canvas",staticClass:"canvas",attrs:{width:t.canvasWidth,height:t.canvasHeight},on:{touchstart:t.startTouch,mousedown:t.startMove,resize:t.canvasResize}},[t._v("Canvas is not supported ")])]),n("div",{staticClass:"controls"},[n("div",{staticClass:"colors"},[n("div",{staticClass:"selected-color",style:"background-color: "+t.activeRgb}),n("div",{staticClass:"color-grid"},t._l(t.colors,(function(e,a){return n("div",{key:a,staticClass:"color-row"},t._l(e,(function(e){var a=e[0],s=e[1],i=e[2],o=e[3];return n("div",{key:a+s+i+o,staticClass:"single-color",style:"background-color: rgb("+a+","+s+","+i+")",on:{click:function(e){return t.selectColor(a,s,i,o)}}})})),0)})),0)]),n("div",{staticClass:"tools"},[n("div",{staticClass:"brush",attrs:{active:"brush"===this.activeTool},on:{click:function(e){return t.selectTool("brush")}}}),n("div",{staticClass:"fill",attrs:{active:"fill"===this.activeTool},on:{click:function(e){return t.selectTool("fill")}}}),n("div",{staticClass:"erase",attrs:{active:"eraser"===this.activeTool},on:{click:function(e){return t.selectTool("eraser")}}})]),n("div",{staticClass:"brush-sizes"},t._l(t.brushSizes,(function(e){return n("div",{key:e,style:"\n                    height: "+e+"px;\n                    width: "+e+"px;\n                    background-color: "+t.activeRgb+";\n                    margin-top: "+(30-e/2)+"px;\n                ",attrs:{active:t.activeBrush===e},on:{click:function(n){return t.selectBrush(e)}}})})),0),n("div",{staticClass:"clear-canvas",on:{click:t.clearCanvas}})])])},c=[],r=(n("99af"),n("cb29"),n("4de4"),n("fb6a"),n("2909")),l=n("3835"),u=n("b85c"),h=(n("a434"),n("d4ec")),d=n("bee2"),v=function(){function t(){Object(h["a"])(this,t),this.reset()}return Object(d["a"])(t,[{key:"addCommand",value:function(t){this.commands.splice(this.stackPosition+1,this.commands.length),this.commands.push(t),this.stackPosition=this.commands.length-1}},{key:"executeCommand",value:function(t){this.addCommand(t),t.execute()}},{key:"undo",value:function(){this.commands.length>0&&this.stackPosition>=0?this.commands[this.stackPosition--].undo():console.log("Cant undo")}},{key:"redo",value:function(){this.stackPosition+1<this.commands.length?this.commands[++this.stackPosition].execute():console.log("Cant redo")}},{key:"reset",value:function(){this.commands=[],this.stackPosition=-1}}]),t}(),f=new v,b=(n("c975"),n("262e")),m=n("2caf"),g=function(){function t(){Object(h["a"])(this,t)}return Object(d["a"])(t,[{key:"undo",value:function(){}},{key:"execute",value:function(){}}]),t}(),p=function(t){Object(b["a"])(n,t);var e=Object(m["a"])(n);function n(t,a){var s;return Object(h["a"])(this,n),s=e.call(this),s.drawables=t,s.drawable=a,s}return Object(d["a"])(n,[{key:"undo",value:function(){this.drawables.splice(this.drawables.indexOf(this.drawable),1)}},{key:"execute",value:function(){this.drawables.push(this.drawable)}}]),n}(g),y=function(t){Object(b["a"])(n,t);var e=Object(m["a"])(n);function n(t){var a;return Object(h["a"])(this,n),a=e.call(this),a.drawables=t,a.drawablesBackup=Object(r["a"])(t),a}return Object(d["a"])(n,[{key:"undo",value:function(){var t;(t=this.drawables).push.apply(t,Object(r["a"])(this.drawablesBackup))}},{key:"execute",value:function(){this.drawables.splice(0,this.drawables.length)}}]),n}(g),w={name:"DrawCanvas",props:{},data:function(){return{activeTool:"brush",activeColor:[0,0,0,255],activeBrush:13,colors:[[[255,255,255,255],[193,193,193,255],[239,19,11,255],[255,113,0,255],[255,228,0,255],[0,204,0,255],[0,178,255,255],[35,31,211,255],[163,0,186,255],[211,124,170,255],[160,82,45]],[[0,0,0,255],[76,76,76,255],[116,11,7,255],[194,56,0,255],[232,162,0,255],[0,85,16,255],[0,86,158,255],[14,8,101,255],[85,0,105,255],[167,85,116,255],[99,48,13,255]]],brushSizes:[7,13,25,50],fingers:{},context:null,drawables:[],animationId:-1,canvasWidth:10,canvasHeight:10,commands:[],commandIndex:0}},mounted:function(){var t=this.$refs.canvas;this.context=t.getContext("2d"),this.canvasResize(),window.addEventListener("resize",this.canvasResize,!1),this.animationId=requestAnimationFrame(this.render),console.log(f),document.addEventListener("keypress",this.handleKey,!1),document.addEventListener("mousemove",this.move,!1),document.addEventListener("touchmove",this.moveTouch,!1),document.addEventListener("mouseup",this.endMove,!1),document.addEventListener("touchend",this.endTouch,!1)},beforeDestroy:function(){console.log("Destroying"),window.removeEventListener("resize",this.canvasResize),document.removeEventListener("keypress",this.handleKey),document.removeEventListener("mousemove",this.move),document.removeEventListener("touchmove",this.moveTouch),document.removeEventListener("mouseup",this.endMove),document.removeEventListener("touchend",this.endTouch),cancelAnimationFrame(this.animationId),f.reset()},methods:{render:function(){var t;this.context.clearRect(0,0,this.canvasWidth,this.canvasHeight),this.context.lineCap="round",this.context.lineJoin="round";var e,n=Object(u["a"])(this.drawables);try{for(n.s();!(e=n.n()).done;){var a=e.value;switch(a.type){case"line":this.context.beginPath(),this.context.strokeStyle=a.color,this.context.lineWidth=a.brush;var s,i=Object(u["a"])(a.line);try{for(i.s();!(s=i.n()).done;){var o=Object(l["a"])(s.value,2),c=o[0],h=o[1];this.context.lineTo(c,h)}}catch(d){i.e(d)}finally{i.f()}this.context.stroke();break;case"square":this.context.fillStyle=a.color,(t=this.context).fillRect.apply(t,Object(r["a"])(a.position).concat(Object(r["a"])(a.shape)));break;case"fill":this.context.drawImage(a.canvas,0,0);break;default:console.warn("No case set");break}}}catch(d){n.e(d)}finally{n.f()}this.animationId=requestAnimationFrame(this.render)},startTool:function(t,e,n){if("brush"===this.activeTool){var a=[[t,e]],s={type:"line",brush:this.activeBrush,color:this.activeRgb,line:a};n.drawable=s,this.drawables.push(s)}else if("eraser"===this.activeTool){var i=[[t,e]],o={type:"line",brush:this.activeBrush,color:"rgb(255,255,255)",line:i};n.drawable=o,this.drawables.push(o)}else"fill"===this.activeTool&&console.log("fill start")},moveTool:function(t,e,n){"brush"===this.activeTool||"eraser"===this.activeTool?n.drawable.line.push([t,e]):"fill"===this.activeTool&&console.log("fill move")},endTool:function(t,e,n){"brush"===this.activeTool||"eraser"===this.activeTool?(n.drawable.line.push([t,e]),f.addCommand(new p(this.drawables,n.drawable)),delete n.drawable):"fill"===this.activeTool&&(this.fill(t,e,this.activeColor),console.log("fill done"))},getNeighbours:function(t,e,n,a){return[[n+1,a+0],[n-1,a+0],[n+0,a+1],[n+0,a-1]].filter((function(s){var i=Object(l["a"])(s,2),o=i[0],c=i[1];return!(o===n&&c===a)&&o>=0&&o<t&&c>=0&&c<e}))},colorEquals:function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},colorDistance:function(t,e){return Math.abs(t[0]-e[0])+Math.abs(t[1]-e[1])+Math.abs(t[2]-e[2])+Math.abs(t[3]-e[3])},fill:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.activeColor,a=this.context.getImageData(0,0,this.canvasWidth,this.canvasHeight),s=[[t,e]],i={},o=4*(e*this.canvasWidth+t),c=a.data.slice(o,o+4);console.log(c,n),i[t]={},i[t][e]=!0;var r=document.createElement("canvas");r.width=this.canvasWidth,r.height=this.canvasHeight;var h=r.getContext("2d"),d=h.getImageData(0,0,this.canvasWidth,this.canvasHeight);while(s.length>0){var v,b=[],m=Object(u["a"])(s);try{for(m.s();!(v=m.n()).done;){var g,y=Object(l["a"])(v.value,2),w=y[0],k=y[1],C=this.getNeighbours(this.canvasWidth,this.canvasHeight,w,k),O=Object(u["a"])(C);try{for(O.s();!(g=O.n()).done;){var j=Object(l["a"])(g.value,2),x=j[0],T=j[1],E=4*(T*this.canvasWidth+x),M=a.data.slice(E,E+4),P=d.data.slice(E,E+4);this.colorEquals(M,c)&&!this.colorEquals(P,n)&&(d.data[E]=n[0],d.data[E+1]=n[1],d.data[E+2]=n[2],d.data[E+3]=n[3],b.push([x,T]))}}catch(_){O.e(_)}finally{O.f()}}}catch(_){m.e(_)}finally{m.f()}s=b}h.putImageData(d,0,0);var R={type:"fill",canvas:r};f.executeCommand(new p(this.drawables,R)),console.log(r)},clearCanvas:function(){f.executeCommand(new y(this.drawables))},selectColor:function(t,e,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:255;this.activeColor=[t,e,n,a]},selectTool:function(t){this.activeTool=t},selectBrush:function(t){this.activeBrush=t},handleKey:function(t){t.preventDefault(),"KeyZ"===t.code&&t.ctrlKey&&t.shiftKey?f.redo():"KeyZ"===t.code&&t.ctrlKey&&f.undo()},startMove:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.fingers[e]||(this.fingers[e]={});var n=this.fingers[e];n.down=!0;var a=this.$refs.canvas.getBoundingClientRect(),s=a.top,i=a.left,o=t.pageX-i,c=t.pageY-s;this.startTool(o,c,n)},move:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(this.fingers[e]&&this.fingers[e].down){var n=this.$refs.canvas.getBoundingClientRect(),a=n.top,s=n.left,i=t.pageX-s,o=t.pageY-a;this.moveTool(i,o,this.fingers[e])}},endMove:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(this.fingers[e]){if(this.fingers[e].down){var n=this.$refs.canvas.getBoundingClientRect(),a=n.top,s=n.left,i=t.pageX-s,o=t.pageY-a;this.endTool(i,o,this.fingers[e])}this.fingers[e].down=!1}},startTouch:function(t){var e,n=Object(u["a"])(t.touches);try{for(n.s();!(e=n.n()).done;){var a=e.value;this.startMove(a,a.identifier)}}catch(s){n.e(s)}finally{n.f()}},moveTouch:function(t){var e,n=Object(u["a"])(t.touches);try{for(n.s();!(e=n.n()).done;){var a=e.value;this.startMove(a,a.identifier)}}catch(s){n.e(s)}finally{n.f()}},endTouch:function(t){var e,n=Object(u["a"])(t.touches);try{for(n.s();!(e=n.n()).done;){var a=e.value;this.startMove(a,a.identifier)}}catch(s){n.e(s)}finally{n.f()}},canvasResize:function(){console.log("resize");var t=this.$refs.canvas,e=t.getBoundingClientRect(),n=e.width,a=e.height;this.canvasWidth=n,this.canvasHeight=a}},computed:{activeRgb:function(){var t=Object(l["a"])(this.activeColor,3),e=t[0],n=t[1],a=t[2];return"rgb(".concat(e,",").concat(n,",").concat(a,")")}}},k=w,C=(n("40d8"),n("2877")),O=Object(C["a"])(k,o,c,!1,null,"21125b26",null),j=O.exports,x={name:"App",components:{DrawCanvas:j}},T=x,E=(n("034f"),Object(C["a"])(T,s,i,!1,null,null,null)),M=E.exports;a["a"].config.productionTip=!1,new a["a"]({render:function(t){return t(M)}}).$mount("#app")},"85ec":function(t,e,n){}});
//# sourceMappingURL=app.512c14c3.js.map