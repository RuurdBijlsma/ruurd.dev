(function(e){function t(t){for(var n,o,i=t[0],c=t[1],l=t[2],u=0,h=[];u<i.length;u++)o=i[u],Object.prototype.hasOwnProperty.call(a,o)&&a[o]&&h.push(a[o][0]),a[o]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(e[n]=c[n]);d&&d(t);while(h.length)h.shift()();return r.push.apply(r,l||[]),s()}function s(){for(var e,t=0;t<r.length;t++){for(var s=r[t],n=!0,o=1;o<s.length;o++){var i=s[o];0!==a[i]&&(n=!1)}n&&(r.splice(t--,1),e=c(c.s=s[0]))}return e}var n={},o={app:0},a={app:0},r=[];function i(e){return c.p+"js/"+({}[e]||e)+"."+{"chunk-84b1a03a":"1ea15722","chunk-ec512e78":"58638bed"}[e]+".js"}function c(t){if(n[t])return n[t].exports;var s=n[t]={i:t,l:!1,exports:{}};return e[t].call(s.exports,s,s.exports,c),s.l=!0,s.exports}c.e=function(e){var t=[],s={"chunk-84b1a03a":1,"chunk-ec512e78":1};o[e]?t.push(o[e]):0!==o[e]&&s[e]&&t.push(o[e]=new Promise((function(t,s){for(var n="css/"+({}[e]||e)+"."+{"chunk-84b1a03a":"ed1d898f","chunk-ec512e78":"dd54f61f"}[e]+".css",a=c.p+n,r=document.getElementsByTagName("link"),i=0;i<r.length;i++){var l=r[i],u=l.getAttribute("data-href")||l.getAttribute("href");if("stylesheet"===l.rel&&(u===n||u===a))return t()}var h=document.getElementsByTagName("style");for(i=0;i<h.length;i++){l=h[i],u=l.getAttribute("data-href");if(u===n||u===a)return t()}var d=document.createElement("link");d.rel="stylesheet",d.type="text/css",d.onload=t,d.onerror=function(t){var n=t&&t.target&&t.target.src||a,r=new Error("Loading CSS chunk "+e+" failed.\n("+n+")");r.code="CSS_CHUNK_LOAD_FAILED",r.request=n,delete o[e],d.parentNode.removeChild(d),s(r)},d.href=a;var v=document.getElementsByTagName("head")[0];v.appendChild(d)})).then((function(){o[e]=0})));var n=a[e];if(0!==n)if(n)t.push(n[2]);else{var r=new Promise((function(t,s){n=a[e]=[t,s]}));t.push(n[2]=r);var l,u=document.createElement("script");u.charset="utf-8",u.timeout=120,c.nc&&u.setAttribute("nonce",c.nc),u.src=i(e);var h=new Error;l=function(t){u.onerror=u.onload=null,clearTimeout(d);var s=a[e];if(0!==s){if(s){var n=t&&("load"===t.type?"missing":t.type),o=t&&t.target&&t.target.src;h.message="Loading chunk "+e+" failed.\n("+n+": "+o+")",h.name="ChunkLoadError",h.type=n,h.request=o,s[1](h)}a[e]=void 0}};var d=setTimeout((function(){l({type:"timeout",target:u})}),12e4);u.onerror=u.onload=l,document.head.appendChild(u)}return Promise.all(t)},c.m=e,c.c=n,c.d=function(e,t,s){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(c.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)c.d(s,n,function(t){return e[t]}.bind(null,n));return s},c.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="/scribble/",c.oe=function(e){throw console.error(e),e};var l=window["webpackJsonp"]=window["webpackJsonp"]||[],u=l.push.bind(l);l.push=t,l=l.slice();for(var h=0;h<l.length;h++)t(l[h]);var d=u;r.push([0,"chunk-vendors"]),s()})({0:function(e,t,s){e.exports=s("56d7")},"021c":function(e,t,s){"use strict";s("3b14")},"034f":function(e,t,s){"use strict";s("85ec")},"03e4":function(e,t,s){},1:function(e,t){},"11d1":function(e,t,s){},"1f05":function(e,t,s){"use strict";s("bc83")},2:function(e,t){},"21ca":function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var n=s("d4ec"),o=(s("b0c0"),function e(t){var s=t.id,o=void 0===s?"":s,a=t.name,r=void 0===a?"":a,i=t.stream,c=void 0===i?null:i,l=t.host,u=void 0!==l&&l,h=t.me,d=void 0!==h&&h,v=t.avatar,f=void 0===v?"":v;Object(n["a"])(this,e),this.id=o,this.name=r,this.stream=c,this.host=u,this.me=d,this.avatar=f,this.rounds=[]})},3:function(e,t){},"34a5":function(e,t,s){"use strict";s("03e4")},3556:function(e,t,s){"use strict";var n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"simple-draw"},[s("div",{staticClass:"canvas-container",style:"height: calc(100% - "+(e.showControls?80:0)+"px)",on:{keypress:e.handleKey}},[s("canvas",{ref:"canvas",staticClass:"canvas",on:{touchstart:e.startTouch,mousedown:e.startMove,resize:e.canvasResize,contextmenu:e.preventContext}},[e._v(" Canvas is not supported ")])]),e.showControls?s("div",{staticClass:"controls",style:"pointer-events: "+(e.readOnly?"none":"all")},[s("div",{staticClass:"colors"},[s("v-color-picker",{directives:[{name:"show",rawName:"v-show",value:e.showColorPicker,expression:"showColorPicker"}],staticClass:"color-picker",model:{value:e.pickedColor,callback:function(t){e.pickedColor=t},expression:"pickedColor"}}),s("div",{staticClass:"selected-color",style:"background-color: "+e.activeRgb,on:{click:e.toggleColorPicker}}),s("div",{staticClass:"color-grid"},e._l(e.colors,(function(t,n){return s("div",{key:n,staticClass:"color-row"},e._l(t,(function(t){var n=t[0],o=t[1],a=t[2],r=t[3];return s("div",{key:n+o+a+r,staticClass:"single-color",style:"background-color: rgb("+n+","+o+","+a+")",on:{click:function(t){return e.selectColor(n,o,a,r)}}})})),0)})),0)],1),s("div",{staticClass:"tools"},[s("div",{staticClass:"brush",attrs:{active:"brush"===this.activeTool},on:{click:function(t){return e.selectTool("brush")}}}),s("div",{staticClass:"fill",attrs:{active:"fill"===this.activeTool},on:{click:function(t){return e.selectTool("fill")}}}),s("div",{staticClass:"erase",attrs:{active:"eraser"===this.activeTool},on:{click:function(t){return e.selectTool("eraser")}}})]),s("div",{staticClass:"brush-sizes"},e._l(e.brushSizes,(function(t){return s("div",{key:t,style:"\n                    height: "+t+"px;\n                    width: "+t+"px;\n                    background-color: "+e.activeRgb+";\n                    margin-top: "+(30-t/2)+"px;\n                ",attrs:{active:e.activeBrush===t},on:{click:function(s){return e.selectBrush(t)}}})})),0),s("div",{staticClass:"clear-canvas",on:{click:e.clearCanvas}})]):e._e()])},o=[],a=s("b85c"),r=s("1da1"),i=s("2909"),c=s("3835"),l=(s("96cf"),s("a9e3"),s("99af"),s("d3b7"),s("c740"),s("4de4"),s("fb6a"),s("cb29"),s("d4ec")),u=s("bee2"),h=(s("a434"),function(){function e(){Object(l["a"])(this,e),this.reset()}return Object(u["a"])(e,[{key:"initializeIfNeeded",value:function(){0===this.states.length&&this.saveState()}},{key:"setCanvas",value:function(e){this.canvas=e,this.context=e.getContext("2d")}},{key:"saveState",value:function(){0!==this.canvas.width&&0!==this.canvas.height&&(this.states.splice(this.stackPosition+2,this.states.length),this.states.push(this.context.getImageData(0,0,this.canvas.width,this.canvas.height)),this.stackPosition=this.states.length-2)}},{key:"undo",value:function(){this.states.length>0&&this.stackPosition>=0?this.context.putImageData(this.states[this.stackPosition--],0,0):console.log("Cant undo")}},{key:"redo",value:function(){this.stackPosition+2<this.states.length?this.context.putImageData(this.states[1+ ++this.stackPosition],0,0):console.log("Cant redo")}},{key:"reset",value:function(e){this.states=[],this.stackPosition=-1,void 0!==e&&this.setCanvas(e)}}]),e}()),d=new h,v={name:"SimpleDraw",props:{readOnly:{type:Boolean,default:!1},updateCanvas:{type:Boolean,default:!1},showControls:{type:Boolean,default:!0},brushSize:{type:Number,default:13}},data:function(){return{activeTool:"brush",activeColor:[0,0,0,255],activeBrush:13,showColorPicker:!1,colors:[[[255,255,255,255],[193,193,193,255],[239,19,11,255],[255,113,0,255],[255,228,0,255],[0,204,0,255],[0,178,255,255],[35,31,211,255],[163,0,186,255],[211,124,170,255],[160,82,45,255]],[[0,0,0,255],[76,76,76,255],[116,11,7,255],[194,56,0,255],[232,162,0,255],[0,85,16,255],[0,86,158,255],[14,8,101,255],[85,0,105,255],[167,85,116,255],[99,48,13,255]]],brushSizes:[7,13,25,50],fingers:{},context:null,canvas:null,animationId:-1,canvasWidth:10,canvasHeight:10,canvasUpdateInterval:-1,commands:[],commandIndex:0,shouldPreventContext:!1,pickedColor:{r:0,g:0,b:0,a:1},remoteFingers:{}}},mounted:function(){var e=this;console.log(d),this.activeBrush=this.brushSize,this.canvas=this.$refs.canvas,this.context=this.getContext(),window.addEventListener("resize",this.canvasResize,!1),document.addEventListener("keyup",this.handleKey,!1),document.addEventListener("mousemove",this.move,!1),document.addEventListener("touchmove",this.moveTouch,!1),document.addEventListener("mouseup",this.endMove,!1),document.addEventListener("touchend",this.endTouch,!1),document.addEventListener("wheel",this.handleWheel,!1),document.addEventListener("contextmenu",this.preventContext,!1),this.updateCursor(this.activeBrush,this.activeColor,this.activeTool),d.setCanvas(this.canvas),this.canvasResize(),this.canvasUpdateInterval=setInterval((function(){if(e.canvas.width>0&&e.canvas.height>0){var t=e.context.getImageData(0,0,1,1);e.context.putImageData(t,0,0)}}),100)},beforeDestroy:function(){window.removeEventListener("resize",this.canvasResize),document.removeEventListener("keyup",this.handleKey),document.removeEventListener("mousemove",this.move),document.removeEventListener("touchmove",this.moveTouch),document.removeEventListener("mouseup",this.endMove),document.removeEventListener("touchend",this.endTouch),document.removeEventListener("wheel",this.handleWheel),d.reset(),clearInterval(this.canvasUpdateInterval)},methods:{applyToolUse:function(e){if(void 0===e.tool){var t=e,s=Object(c["a"])(t,3),n=s[0],o=s[1],a=s[2],r=this.remoteFingers[a].tool,l=e.brushSize;e={x:n,y:o,id:a,state:"move",tool:r,brushSize:l}}switch(e.tool){case"clear":this.clearCanvas(!1);break;case"brush":case"eraser":case"fill":this.remoteFingers.hasOwnProperty(e.id)||(this.remoteFingers[e.id]={down:!0});var u=this.remoteFingers[e.id];switch(u.tool=e.tool,u.brushSize=e.brushSize,e.state){case"start":this.startTool(e.x,e.y,u,e.tool,e.brushSize,!1),"fill"===e.tool&&delete this.remoteFingers[e.id];break;case"move":this.moveTool(e.x,e.y,u,e.tool,!1);break;case"end":this.endTool(e.x,e.y,u,e.tool,!1),delete this.remoteFingers[e.id];break}break;case"color":this.selectColor.apply(this,Object(i["a"])(e.color).concat([!0,!1]));break;case"brushSize":this.selectBrush(e.brush,!1);break;case"undo":d.undo();break;case"redo":d.redo();break;default:console.log("No case set for toolUse:",e);break}},getContext:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.brushSize,s=void 0===t?this.activeBrush:t,n=e.color,o=void 0===n?this.activeColor:n,a=this.canvas.getContext("2d");return a.lineCap="round",a.lineJoin="round",a.strokeStyle=this.toRgb.apply(this,Object(i["a"])(o)),a.lineWidth=s,a},handleWheel:function(e){if(e.altKey){var t=this.activeBrush-e.deltaY/50;t=Math.max(Math.min(107,t),1),this.selectBrush(t)}},pickColorToColor:function(e){var t=e.r,s=e.g,n=e.b,o=e.a;return[t,s,n,Math.floor(255*o)]},colorToPickColor:function(e){var t=Object(c["a"])(e,4),s=t[0],n=t[1],o=t[2],a=t[3];return{r:s,g:n,b:o,a:a/255}},toggleColorPicker:function(){this.showColorPicker=!this.showColorPicker},drawImage:function(e,t,s){var n=this;return Object(r["a"])(regeneratorRuntime.mark((function o(){return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return o.abrupt("return",new Promise((function(o){var a=new Image;a.src=e,a.onload=function(){n.context.drawImage(a,t,s)}})));case 1:case"end":return o.stop()}}),o)})))()},skipColor:function(e){var t=this,s=[].concat(Object(i["a"])(this.colors[0]),Object(i["a"])(this.colors[1])),n=s.findIndex((function(e){return t.colorEquals(e,t.activeColor)})),o=(n+e)%s.length;o<0&&(o+=s.length),this.selectColor.apply(this,Object(i["a"])(s[o])),console.log("Skip",e,this.activeColor,o)},getStream:function(){return this.$refs.canvas.captureStream()},preventContext:function(e){if(this.shouldPreventContext)return e.preventDefault(),!1},startTool:function(e,t,s){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.activeTool,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.activeBrush,a=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];if(a&&(s.id=Math.floor(99999*Math.random()),this.$emit("toolUse",{tool:n,x:Math.floor(e),y:Math.floor(t),brushSize:o,state:"start",id:s.id})),this.showColorPicker=!1,"brush"===n||"eraser"===n){var r="eraser"===n?[255,255,255,255]:this.activeColor,i=this.getContext({color:r});i.beginPath(),i.moveTo(e,t),i.lineTo(e,t),i.stroke(),s.line=[[e,t]],s.context=i}else"fill"===n&&(this.fill3(e,t,this.activeColor),d.saveState())},moveTool:function(e,t,s){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.activeTool,o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];"brush"!==n&&"eraser"!==n||(o&&this.$emit("toolUse",[Math.floor(e),Math.floor(t),s.id]),s.line.push([e,t]),s.context.lineTo(e,t),s.context.stroke())},endTool:function(e,t,s){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.activeTool,o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];"brush"!==n&&"eraser"!==n||(o&&this.$emit("toolUse",{tool:n,x:Math.floor(e),y:Math.floor(t),state:"end",id:s.id}),s.line.push([e,t]),s.context.lineTo(e,t),s.context.stroke(),d.saveState())},getNeighbours:function(e,t,s,n){var o,a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1;return o=a?[[s-r,n+0],[s+r,n+0],[s+0,n-r],[s+0,n+r],[s-r,n+r],[s+r,n+r],[s+r,n-r],[s-r,n-r]]:[[s-r,n+0],[s+r,n+0],[s+0,n-r],[s+0,n+r]],o.filter((function(o){var a=Object(c["a"])(o,2),r=a[0],i=a[1];return!(r===s&&i===n)&&r>=0&&r<e&&i>=0&&i<t}))},colorEquals:function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]},colorDistance:function(e,t){return Math.abs(e[0]-t[0])+Math.abs(e[1]-t[1])+Math.abs(e[2]-t[2])+Math.abs(e[3]-t[3])},fill3:function(e,t){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.activeColor;console.log("FILL THAT CANVAS",e,t,s),e=Math.floor(e),t=Math.floor(t);var n=this.context.canvas.width,o=this.context.canvas.height,r=this.context.getImageData(0,0,n,o),i=this.context.getImageData(0,0,n,o),l=4*(t*n+e),u=r.data.slice(l,l+4);if(!this.colorEquals(u,s)){var h=function(e){return r.data[e+0]===u[0]&&r.data[e+1]===u[1]&&r.data[e+2]===u[2]&&r.data[e+3]===u[3]},d=4*n,v=function(e){var t,n=[e,e+d,e-d,e+4,e-4,e+d+4,e-d+4,e+d-4,e-d-4].filter((function(e){return e<r.data.length&&e>=0})),o=Object(a["a"])(n);try{for(o.s();!(t=o.n()).done;){var c=t.value;i.data[c+0]=s[0],i.data[c+1]=s[1],i.data[c+2]=s[2],i.data[c+3]=s[3]}}catch(l){o.e(l)}finally{o.f()}r.data[e+0]=s[0],r.data[e+1]=s[1],r.data[e+2]=s[2],r.data[e+3]=s[3]},f=[[e,t]];while(f.length>0){var m=void 0,g=void 0,p=f.pop(),b=Object(c["a"])(p,2),C=b[0],y=b[1];l=4*(y*n+C);while(h(l))y--,l=4*(y*n+C);m=!1,g=!1;while(1){if(y++,l=4*(y*n+C),!(y<o&&h(l)))break;v(l),C>0&&(h(l-4)?m||(f.push([C-1,y]),m=!0):m&&(m=!1)),C<n-1&&(h(l+4)?g||(f.push([C+1,y]),g=!0):g&&(g=!1)),l+=d}}this.context.putImageData(i,0,0)}},clearCanvas:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];e&&this.$emit("toolUse",{tool:"clear"}),this.context.fillStyle="rgb(255,255,255)",this.context.fillRect(0,0,this.canvasWidth,this.canvasHeight),d.saveState(),this.showColorPicker=!1,console.log("Clear canvas",this.canvas.width,this.canvas.height)},resetCanvas:function(){this.context.fillStyle="white",console.log("Reset canvas",this.canvas.width,this.canvas.height),this.context.fillRect(0,0,this.canvas.width,this.canvas.height),this.showColorPicker=!1,this.selectColor.apply(this,Object(i["a"])(this.colors[1][0])),this.selectBrush(13,!1),this.selectTool("brush"),d.reset(this.canvas),d.initializeIfNeeded()},selectColor:function(e,t,s){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:255,o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],a=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];console.log("Select color",[e,t,s,n],o,a),this.activeColor=[e,t,s,n],a&&this.$emit("toolUse",{tool:"color",color:this.activeColor}),o&&(this.pickedColor=this.colorToPickColor(this.activeColor),this.showColorPicker=!1),this.updateCursor(this.activeBrush,this.activeColor,this.activeTool)},selectTool:function(e){this.activeTool=e,this.showColorPicker=!1,this.updateCursor(this.activeBrush,this.activeColor,this.activeTool)},selectBrush:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.activeBrush=e,this.showColorPicker=!1,this.updateCursor(this.activeBrush,this.activeColor,this.activeTool),t&&this.$emit("toolUse",{tool:"brushSize",brush:this.activeBrush})},updateCursor:function(e,t,s){if(this.readOnly)this.$refs.canvas.style.cursor="auto";else{"eraser"===s&&(t=[255,255,255,255]),"fill"===s&&(e=2);var n=document.createElement("canvas"),o=n.getContext("2d"),a=10;n.width=e+2*a,n.height=e+2*a,o.fillStyle=this.toRgb.apply(this,Object(i["a"])(t)),o.lineWidth=a,o.arc(n.width/2,n.height/2,e/2,0,2*Math.PI),o.strokeStyle="rgba(128,128,128,0.5)",o.stroke(),o.fill();var r=n.toDataURL("image/png");this.$refs.canvas.style.cursor="url(".concat(r,") ").concat(Math.floor(n.width/2)," ").concat(Math.floor(n.height/2),", auto")}},pickColor:function(e,t){e=Math.floor(e),t=Math.floor(t);var s=this.context.getImageData(e,t,1,1);return s.data},handleKey:function(e){!this.readOnly&&this.showControls&&("KeyZ"===e.code&&e.ctrlKey&&e.shiftKey?(d.redo(),this.$emit("toolUse",{tool:"redo"})):"KeyZ"===e.code&&e.ctrlKey&&(d.undo(),this.$emit("toolUse",{tool:"undo"})))},startMove:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!this.readOnly&&!e.altKey){this.shouldPreventContext=!0,this.fingers[t]||(this.fingers[t]={});var s=this.fingers[t];s.down=!0;var n=this.$refs.canvas.getBoundingClientRect(),o=n.top,a=n.left,r=e.clientX-a,i=e.clientY-o,c=2===e.button?"eraser":this.activeTool;this.startTool(r,i,s,c,2===e.button?3*this.activeBrush:this.activeBrush)}},move:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!this.readOnly&&!e.altKey&&this.fingers[t]&&this.fingers[t].down){var s=this.$refs.canvas.getBoundingClientRect(),n=s.top,o=s.left,a=e.clientX-o,r=e.clientY-n,i=2===e.button?"eraser":this.activeTool;this.moveTool(a,r,this.fingers[t],i)}},endMove:function(e){var t=this,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!this.readOnly)if(setTimeout((function(){t.shouldPreventContext=!1}),50),e.altKey){var n=this.$refs.canvas.getBoundingClientRect(),o=n.top,a=n.left,r=e.clientX-a,c=e.clientY-o;this.selectColor.apply(this,Object(i["a"])(this.pickColor(r,c)))}else if(this.fingers[s]){if(this.fingers[s].down){var l=this.$refs.canvas.getBoundingClientRect(),u=l.top,h=l.left,d=e.clientX-h,v=e.clientY-u,f=2===e.button?"eraser":this.activeTool;this.endTool(d,v,this.fingers[s],f)}this.fingers[s].down=!1}},startTouch:function(e){if(!this.readOnly){var t,s=Object(a["a"])(e.touches);try{for(s.s();!(t=s.n()).done;){var n=t.value;this.startMove(n,n.identifier)}}catch(o){s.e(o)}finally{s.f()}}},moveTouch:function(e){if(!this.readOnly){var t,s=Object(a["a"])(e.touches);try{for(s.s();!(t=s.n()).done;){var n=t.value;this.move(n,n.identifier)}}catch(o){s.e(o)}finally{s.f()}}},endTouch:function(e){if(!this.readOnly){var t,s=Object(a["a"])(e.changedTouches);try{for(s.s();!(t=s.n()).done;){var n=t.value;this.endMove(n,n.identifier)}}catch(o){s.e(o)}finally{s.f()}}},canvasResize:function(){var e,t=this.$refs.canvas,s=t.width>0&&t.height>0;s&&(e=this.context.getImageData(0,0,t.width,t.height));var n=t.getBoundingClientRect(),o=n.width,a=n.height;t.width=o,t.height=a,console.log("Clear canvas",this.canvas.width,this.canvas.height),this.canvasWidth=o,this.canvasHeight=a,s&&this.context.putImageData(e,0,0),s||this.resetCanvas()},toRgb:function(e,t,s,n){return"rgba(".concat(e,",").concat(t,",").concat(s,",").concat(n/255,")")}},watch:{readOnly:function(){this.updateCursor(this.activeBrush,this.activeColor,this.activeTool)},updateCanvas:function(){this.canvasResize()},brushSize:function(){this.activeBrush=this.brushSize},activeColor:function(e,t){this.colorEquals(e,t)||this.$emit("colorChange",this.activeColor)},pickedColor:function(){var e=Object(i["a"])(this.pickColorToColor(this.pickedColor));(isNaN(e[3])||0===e[3])&&(e[3]=255),this.colorEquals(this.activeColor,e)||this.selectColor.apply(this,Object(i["a"])(e).concat([!1]))}},computed:{activeRgb:function(){return this.toRgb.apply(this,Object(i["a"])(this.activeColor))}}},f=v,m=(s("34a5"),s("2877")),g=s("6544"),p=s.n(g),b=s("03a4"),C=Object(m["a"])(f,n,o,!1,null,"7df10f6e",null);t["a"]=C.exports;p()(C,{VColorPicker:b["a"]})},"3b14":function(e,t,s){},"417e":function(e,t,s){"use strict";s.r(t);var n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"lobby"},[s("v-card",[s("v-card-title",{staticClass:"headline"},[e.isPublic?s("v-chip",{staticClass:"public-chip",attrs:{outlined:""}},[e._v("Public")]):s("v-chip",{staticClass:"public-chip",attrs:{outlined:""}},[e._v("Private")]),e._v(" Game lobby - "+e._s(e.$route.query.game)+" ")],1),s("v-card-subtitle",[e._v("Share the link with others to invite them.")]),s("div",{staticClass:"settings"},[s("lobby-settings",{ref:"settings",attrs:{"read-only":!e.me.host,updateSettings:e.settings},on:{change:e.updateSettings}}),s("create-user",{ref:"createUser",attrs:{"read-only":!e.me.host},on:{userChange:e.updateUserName}}),s("lobby-users",{ref:"lobbyUsers",staticClass:"lobby-users",attrs:{users:e.users,me:e.me},on:{kick:e.kick}})],1),s("v-card-actions",[e.me.host?s("v-btn",{attrs:{color:"primary"},on:{click:e.createLobby}},[e._v("Create lobby")]):e._e()],1)],1)],1)},o=[],a=s("4f96"),r=s("1da1"),i=(s("96cf"),s("4d90"),s("d3b7"),s("25f0"),s("ac1f"),s("5319"),s("7db0"),s("a434"),s("fb6a"),s("b0c0"),s("a15b"),s("c740"),s("4de4"),s("3556")),c=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"create-user"},[s("p",{staticClass:"caption"},[e._v("Draw your avatar (right click to erase):")]),s("div",{staticClass:"draw-container"},[s("v-btn",{attrs:{icon:""},on:{click:function(t){return e.$refs.draw.skipColor(-1)}}},[s("v-icon",[e._v("mdi-arrow-left")])],1),s("simple-draw",{ref:"draw",staticClass:"draw-avatar",style:"box-shadow: 0 0 0px 5px "+e.color+", 0 0 30px 0 rgba(0,0,0,0.3)",attrs:{"show-controls":!1,"brush-size":7},on:{colorChange:e.highlightColor}}),s("v-btn",{attrs:{icon:""},on:{click:function(t){return e.$refs.draw.skipColor(1)}}},[s("v-icon",[e._v("mdi-arrow-right")])],1)],1),s("v-text-field",{attrs:{rules:e.rules,label:"Username",outlined:"",name:"username"},model:{value:e.userName,callback:function(t){e.userName=t},expression:"userName"}})],1)},l=[],u=s("2909"),h=s("fdc6"),d=s.n(h),v={name:"CreateUser",components:{SimpleDraw:i["a"]},props:{readOnly:{type:Boolean,default:!1}},data:function(){return{color:"black",userName:d.a.generate(),rules:[function(e){return e.length<=25||"Max 25 characters"}],saveInterval:-1}},mounted:function(){var e=this;console.warn("MOUNTED"),null!==localStorage.getItem("lastUserName")&&(this.userName=localStorage.lastUserName),console.log(this.$refs.draw.$refs.canvas.width),this.$refs.draw.resetCanvas(),this.$refs.draw.drawImage(localStorage.lastAvatar,0,0),this.saveInterval=setInterval((function(){localStorage.lastAvatar=e.$refs.draw.$refs.canvas.toDataURL()}),1e3),this.$emit("userChange",this.userName),this.$refs.draw.skipColor(Math.floor(20*Math.random()))},methods:{highlightColor:function(e){var t;this.color=(t=this.$refs.draw).toRgb.apply(t,Object(u["a"])(e))},getStream:function(){return this.$refs.draw.getStream()},getUser:function(){var e=this.$refs.draw.$refs.canvas.toDataURL();return{name:this.userName,avatar:e}}},watch:{userName:function(e,t){localStorage.lastUserName=this.userName,console.log("user emit"),this.userName=e.substr(0,25),this.$emit("userChange",this.userName)}},beforeDestroy:function(){console.warn("Clearing interval"),clearInterval(this.saveInterval)}},f=v,m=(s("73d3"),s("2877")),g=s("6544"),p=s.n(g),b=s("8336"),C=s("132d"),y=s("8654"),w=Object(m["a"])(f,c,l,!1,null,"0f9a2762",null),k=w.exports;p()(w,{VBtn:b["a"],VIcon:C["a"],VTextField:y["a"]});var x=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"lobby-settings"},[s("p",{staticClass:"caption"},[e._v("Game settings:")]),s("v-form",[s("v-select",{attrs:{readonly:e.readOnly,label:"Rounds",items:e.roundOptions},model:{value:e.settings.rounds,callback:function(t){e.$set(e.settings,"rounds",t)},expression:"settings.rounds"}}),s("v-select",{attrs:{readonly:e.readOnly,label:"Time limit",items:e.timeOptions},model:{value:e.settings.time,callback:function(t){e.$set(e.settings,"time",t)},expression:"settings.time"}}),s("v-select",{attrs:{readonly:e.readOnly,label:"Language",items:e.languageOptions},model:{value:e.settings.language,callback:function(t){e.$set(e.settings,"language",t)},expression:"settings.language"}})],1)],1)},O=[],S={name:"LobbySettings",props:{readOnly:{type:Boolean,default:!1},updateSettings:{type:Object,default:null}},data:function(){return{roundOptions:[1,2,3,4,5,6,7,8,9,10],timeOptions:[{text:"10 seconds",value:10},{text:"30 seconds",value:30},{text:"50 seconds",value:50},{text:"70 seconds",value:70},{text:"90 seconds",value:90},{text:"100 seconds",value:100},{text:"120 seconds",value:120},{text:"140 seconds",value:140},{text:"160 seconds",value:160},{text:"180 seconds",value:180},{text:"200 seconds",value:200}],languageOptions:["English","Dutch"],settings:{rounds:5,time:100,language:"English"}}},methods:{getSettings:function(){var e=this.settings,t=e.rounds,s=e.time,n=e.language;return{rounds:t,time:s,language:n}}},watch:{updateSettings:function(){null!==this.updateSettings&&(this.settings=this.updateSettings)},settings:{deep:!0,handler:function(){this.$emit("change",this.settings)}}}},T=S,$=(s("021c"),s("4bd4")),I=s("b974"),_=Object(m["a"])(T,x,O,!1,null,"f4220242",null),P=_.exports;p()(_,{VForm:$["a"],VSelect:I["a"]});var j=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"users"},[s("p",{staticClass:"caption"},[e._v("Users in lobby:")]),e._l(e.users,(function(t){return s("div",{key:t.id,staticClass:"user"},[s("video",{ref:"videos",refInFor:!0,staticClass:"video",attrs:{autoplay:""},domProps:{srcObject:t.stream},on:{canplay:function(t){return e.playVideo(t)}}}),t.name?s("p",[e._v(e._s(t.name))]):s("p",[s("i",[e._v("Unnamed")])]),e.me.host&&e.me!==t?s("v-btn",{attrs:{color:"error"},on:{click:function(s){return e.$emit("kick",t)}}},[e._v("Kick")]):e.me.host?s("v-btn",{attrs:{text:"",disabled:""}},[e._v("Me")]):e._e()],1)}))],2)},E=[],N={name:"LobbyUsers",props:{me:{type:Object,default:null},users:{type:Array,default:[]}},data:function(){return{}},mounted:function(){},methods:{playVideo:function(e){return Object(r["a"])(regeneratorRuntime.mark((function t(){var s,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return s=e.target,t.prev=1,t.next=4,s.play();case 4:t.next=9;break;case 6:t.prev=6,t.t0=t["catch"](1),n=setInterval(Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,s.play();case 3:clearInterval(n),console.log("Video is playing"),e.next=9;break;case 7:e.prev=7,e.t0=e["catch"](0);case 9:case"end":return e.stop()}}),e,null,[[0,7]])}))),300);case 9:case"end":return t.stop()}}),t,null,[[1,6]])})))()},getUsers:function(){for(var e=this.users,t=0;t<e.length;t++){var s=this.$refs.videos[t],n=document.createElement("canvas"),o=n.getContext("2d");n.width=s.videoWidth,n.height=s.videoHeight,console.log({video:s}),o.drawImage(s,0,0),e[t].avatar=n.toDataURL(),e[t].me=!1}return this.me.me=!0,e}},watch:{}},L=N,M=(s("1f05"),Object(m["a"])(L,j,E,!1,null,"9c9f94b4",null)),U=M.exports;p()(M,{VBtn:b["a"]});var B=s("21ca"),R={name:"Lobby",components:{LobbyUsers:U,LobbySettings:P,CreateUser:k,SimpleDraw:i["a"]},data:function(){return{users:[],me:new B["a"]({me:!0}),settings:null,mesh:null,hostInterval:-1,isPublic:!1}},mounted:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){var s,n,o,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.mesh=e.$store.state.mesh,console.log("MESH",e.mesh),t.next=4,e.mesh.connect("https://api.ruurd.dev");case 4:if(e.me.id=e.mesh.signal.socket.id,e.me.stream=e.$refs.createUser.getStream(),e.users.push(e.me),e.isPublic="true"===e.$route.query.public,e.$route.query.hasOwnProperty("game")){t.next=15;break}return console.log("HOST"),e.me.host=!0,s=Math.floor(1679616*Math.random()).toString(36).padStart(4,"0").toUpperCase(),n={game:s,public:e.isPublic},t.next=15,e.$router.replace({query:n});case 15:if(o=e.$route.query.game,r={},e.mesh.on("connect",(function(t){r[t]||(r[t]=new B["a"]({id:t}),e.users.push(r[t])),console.log("userinfo",t,"connect"),e.mesh.send(t,["user",e.me]);var s=e.$refs.settings.getSettings();e.mesh.send(t,["settings",s])})),e.mesh.on("full-connect",(function(){console.log("FUlly connected"),e.hostInterval=setInterval((function(){e.chooseNewHost()}),1e3)})),e.mesh.on("disconnect",(function(t){delete r[t];var s=e.users.find((function(e){return e.id===t}));e.users.splice(e.users.indexOf(s),1),console.log("Disconnect trigger"),e.chooseNewHost()})),e.mesh.on("stream",(function(t,s){r[t]||(r[t]=new B["a"]({id:t}),e.users.push(r[t])),r[t].stream=s,console.log("userinfo",t,"stream",s)})),e.mesh.on("data",(function(t,s){r[t]||(r[t]=new B["a"]({id:t}),e.users.push(r[t]));var n=JSON.parse(s),o=Object(a["a"])(n),i=o[0],c=o.slice(1);console.log("userinfo",t,"data",i,c),"user"===i?(r[t].name=c[0].name,r[t].host=c[0].host):"settings"===i?e.me.host||(e.settings=c[0]):"kicked"===i?(e.mesh.destroy(),e.$router.push("/kicked?msg="+c[0])):"start"===i&&(r[t].host=!0,e.createLobby()),console.log("userinfo",t,"data",i,c)})),!e.me.host){t.next=26;break}e.mesh.create(o,"",!e.isPublic),t.next=28;break;case 26:return t.next=28,e.mesh.join(o);case 28:console.log("Joined room",o),e.mesh.broadcastStream(e.me.stream);case 30:case"end":return t.stop()}}),t)})))()},methods:{chooseNewHost:function(){if(-1===this.users.findIndex((function(e){return e.host}))&&this.mesh.isFullyConnected()){console.log(this.users,JSON.stringify(this.users));var e=this.users.sort((function(e,t){return e.id>t.id?1:-1}))[0];e.host=!0,console.log("Host disconnected, migrating host",e)}},kick:function(e){if(e!==this.me){var t=this.users.indexOf(e);t>-1&&this.mesh.send(e.id,["kicked","lmao get fukt"])}},updateSettings:function(e){this.me.host&&this.mesh.broadcast(["settings",e])},updateUserName:function(e){this.me.name=e,this.mesh.broadcast(["user",this.me])},createLobby:function(){var e=this.$refs.settings.getSettings(),t=this.$refs.lobbyUsers.getUsers(),s=this.$refs.createUser.getUser(),n=s.avatar;this.me.avatar=n,this.$store.commit("game",{me:this.me,others:t.filter((function(e){return!1===e.me})),settings:e}),this.mesh.broadcastRemoveStream(this.me.stream),this.mesh.removeAllListeners(),this.$router.push("/game")}},watch:{me:function(e,t){console.log("ME CHANGED from old to new",t,e)}},beforeDestroy:function(){clearInterval(this.hostInterval)}},V=R,D=(s("9eca"),s("b0af")),z=s("99d9"),A=s("cc20"),F=Object(m["a"])(V,n,o,!1,null,"4c2bef46",null);t["default"]=F.exports;p()(F,{VBtn:b["a"],VCard:D["a"],VCardActions:z["a"],VCardSubtitle:z["b"],VCardTitle:z["d"],VChip:A["a"]})},"4c21":function(e,t,s){},"56d7":function(e,t,s){"use strict";s.r(t);s("e260"),s("e6cf"),s("cca6"),s("a79d");var n=s("2b0e"),o=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-app",{staticClass:"app"},[s("div",{staticClass:"background"}),s("v-content",{staticClass:"app-content"},[s("router-view")],1)],1)},a=[],r={name:"App",components:{},data:function(){return{}}},i=r,c=(s("034f"),s("2877")),l=s("6544"),u=s.n(l),h=s("7496"),d=s("a75b"),v=Object(c["a"])(i,o,a,!1,null,null,null),f=v.exports;u()(v,{VApp:h["a"],VContent:d["a"]});var m=s("9483");Object(m["a"])("".concat("/scribble/","service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered:function(){console.log("Service worker has been registered.")},cached:function(){console.log("Content has been cached for offline use.")},updatefound:function(){console.log("New content is downloading.")},updated:function(){console.log("New content is available; please refresh.")},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(e){console.error("Error during service worker registration:",e)}});var g=s("2f62"),p=s("97b0");n["a"].use(g["a"]);var b=new g["a"].Store({state:{game:{},mesh:new p["a"]("scribble")},mutations:{game:function(e,t){console.log("game",t),e.game=t}},actions:{},modules:{}}),C=(s("d3b7"),s("3ca3"),s("ddb0"),s("8c4f")),y=(s("417e"),function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"home"},[s("v-card",[s("v-card-title",{staticClass:"headline"},[e._v("Server Browser")]),0===e.servers.length?s("v-card-text",[e._v("No servers active")]):s("v-list",[s("v-list-item-group",{attrs:{color:"primary"}},e._l(e.servers,(function(t,n){return s("v-list-item",{key:n,attrs:{to:"lobby?game="+t.id}},[s("v-list-item-icon",[s("v-icon",[e._v("mdi-earth")])],1),s("v-list-item-content",[s("v-list-item-title",[e._v(e._s(t.id))]),s("v-list-item-subtitle",[e._v("Users in lobby: "+e._s(t.userCount))])],1)],1)})),1)],1)],1),s("v-card",[s("v-form",{on:{submit:e.start}},[s("v-card-title",{staticClass:"headline"},[e._v("Start match")]),s("v-card-subtitle",[e._v("Create a private or public lobby. ")]),s("v-card-text",[s("v-switch",{attrs:{label:"Public lobby"},model:{value:e.isPublic,callback:function(t){e.isPublic=t},expression:"isPublic"}}),e.isPublic?s("v-text-field",{attrs:{name:"server name",label:"Server name",placeholder:"Leave empty for random name"},model:{value:e.serverName,callback:function(t){e.serverName=t},expression:"serverName"}}):e._e()],1),s("v-card-actions",[s("v-btn",{attrs:{text:"",to:e.url,type:"submit"}},[e._v("Create lobby")])],1)],1)],1)],1)}),w=[],k=s("1da1"),x=(s("96cf"),s("4de4"),{name:"Home",components:{},data:function(){return{serverName:"",servers:[],server:null,isPublic:!1}},mounted:function(){var e=this;return Object(k["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,fetch("https://api.ruurd.dev/rooms");case 2:return t.next=4,t.sent.json();case 4:e.servers=t.sent.filter((function(e){return"scribble"===e.appName}));case 5:case"end":return t.stop()}}),t)})))()},methods:{start:function(e){e.preventDefault(),this.$router.push(this.url)}},computed:{url:function(){return"lobby?public="+this.isPublic+(""===this.serverName?"":"&game="+this.serverName)}}}),O=x,S=(s("db01"),s("8336")),T=s("b0af"),$=s("99d9"),I=s("4bd4"),_=s("132d"),P=s("8860"),j=s("da13"),E=s("5d23"),N=s("1baa"),L=s("34c3"),M=s("b73d"),U=s("8654"),B=Object(c["a"])(O,y,w,!1,null,"1021a258",null),R=B.exports;u()(B,{VBtn:S["a"],VCard:T["a"],VCardActions:$["a"],VCardSubtitle:$["b"],VCardText:$["c"],VCardTitle:$["d"],VForm:I["a"],VIcon:_["a"],VList:P["a"],VListItem:j["a"],VListItemContent:E["a"],VListItemGroup:N["a"],VListItemIcon:L["a"],VListItemSubtitle:E["b"],VListItemTitle:E["c"],VSwitch:M["a"],VTextField:U["a"]}),n["a"].use(C["a"]);var V=[{path:"/",name:"Home",component:R},{path:"/lobby",name:"Lobby",component:function(){return Promise.resolve().then(s.bind(null,"417e"))}},{path:"/game",name:"Game",component:function(){return s.e("chunk-ec512e78").then(s.bind(null,"7d36"))}},{path:"/kicked",name:"Kicked",component:function(){return s.e("chunk-84b1a03a").then(s.bind(null,"a5b4"))}}],D=new C["a"]({routes:V}),z=D,A=s("f309");n["a"].use(A["a"]);var F=new A["a"]({theme:{dark:!1,themes:{dark:{primary:"#5d45dc",secondary:"#13f31a"}}}});console.log("%cZIE IK EEN ZIELIGE BITCH CHEATER IN MN CONSOLE?","background: orange; color: black; font-size: x-large"),window.console.log=function(){return{}},window.console.warn=function(){return{}},n["a"].config.productionTip=!1,new n["a"]({router:z,store:b,vuetify:F,render:function(e){return e(f)}}).$mount("#app")},"73d3":function(e,t,s){"use strict";s("4c21")},"85ec":function(e,t,s){},"9eca":function(e,t,s){"use strict";s("11d1")},ac02:function(e,t,s){},bc83:function(e,t,s){},db01:function(e,t,s){"use strict";s("ac02")}});
//# sourceMappingURL=app.20baf4ce.js.map